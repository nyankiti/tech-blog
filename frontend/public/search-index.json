[{"slug":"2025-02-26-next-flexsearch","title":"flexsearchã‚’ç”¨ã„ã¦Next.jsã§ã‚µã‚¤ãƒˆå†…æ¤œç´¢ã‚’å®Ÿè£…ã™ã‚‹","tags":["tech","poem"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n\næœ¬ãƒ–ãƒ­ã‚°ã¯Next.jsã§Markdwonã‚’ã‚½ãƒ¼ã‚¹ã¨ã—ãŸãƒ–ãƒ­ã‚°ãªã®ã§ã™ãŒã€ã‚µã‚¤ãƒˆå†…æ¤œç´¢ãŒæ¬²ã—ããªã£ãŸã®ã§è¿½åŠ ã—ã¾ã—ãŸã€‚\n\nNextraãŒæä¾›ã—ã¦ã„ã‚‹ã‚µã‚¤ãƒˆå†…æ¤œç´¢ãŒflexsearchã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã¨ã®ã“ã¨ãªã®ã§ã€nextraã®å®Ÿè£…ã‚’å‚è€ƒã«ã—ãªãŒã‚‰è‡ªåˆ†ã®ãƒ–ãƒ­ã‚°ã«ã‚‚å®Ÿè£…ã—ã¦ã¿ã¾ã™ã€‚\nhttps://nextra.site/docs/guide/search\n\nhttps://github.com/shuding/nextra\n\n\nãƒ“ãƒ«ãƒ‰ã®éš›ã«Markdwonã‹ã‚‰ç°¡æ˜“çš„ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§å®Œçµã™ã‚‹ã‚µã‚¤ãƒˆå†…æ¤œç´¢ãŒã§ãã‚Œã°è‰¯ã„ãªã¨æ€ã„è‰²ã€…é ‘å¼µã£ãŸã®ã§ã€ãã®è¨˜éŒ²ã‚’æ®‹ã—ã¾ã™ã€‚\n\n<Bookmark href=\"https://tenderfeel.xsrv.jp/javascript/5711/\" />\n\n\n# Flexsearchã¨ã¯\nhttps://github.com/nextapps-de/flexsearch\n\njavascriptã§å‹•ä½œã™ã‚‹é«˜é€Ÿã®å…¨æ–‡æ¤œç´¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚Node.jsã«åŠ ãˆã¦ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚å‹•ä½œã™ã‚‹ã®ã§ã€ãƒ“ãƒ«ãƒ‰ã®éš›ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§å®Œçµã™ã‚‹ã‚µã‚¤ãƒˆå†…æ¤œç´¢ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚\n\n## Flexsearchã®ç‰¹å¾´\n","date":"2025-02-26T10:34:20.000Z"},{"slug":"2025-02-26-next-mdx-bundler-blog","title":"Next.jsã¨markdownã®ãƒ–ãƒ­ã‚°ã§contentlayerã‹ã‚‰mdx-bundlerã«ç§»è¡Œã—ãŸè©±","tags":["tech","next","contentlayer","mdx","markdown"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n\n## ã¯ã˜ã‚ã«\n\næœ¬ãƒ–ãƒ­ã‚°ã§åˆ©ç”¨ã—ã¦ã„ãŸ[contentlayer](https://github.com/contentlayerdev/contentlayer)ãŒãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚’åœæ­¢ã—ãŸã®ã§ã€[mdx-bundler](https://github.com/kentcdodds/mdx-bundler)ã¸ç§»è¡Œã—ã¾ã—ãŸã€‚\n\nç¾çŠ¶ã®è¨˜äº‹ç®¡ç†ã§ã¯mdxã‚’ä½¿ã£ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ã®ã§ã™ãŒã€ã“ã‚Œã‚’æ©Ÿã«è¡¨ç¾ã®å¹…ã‚’åºƒã’ã‚‰ã‚ŒãŸã‚‰å¬‰ã—ã„ãªã¨æ€ã„ mdx-bundler ã‚’é¸å®šã—ã¾ã—ãŸã€‚\n\nappãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã§ã¯ãªã„å ´æ‰€ã§markdownãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç®¡ç†ã—ã¦ã„ã‚‹ãŸã‚ã€[Next.jså…¬å¼ã«ã‚ã‚‹mdxã®åˆ©ç”¨æ–¹æ³•](https://nextjs.org/docs/pages/building-your-application/configuring/mdx)ã¯ã‚ã¾ã‚Šå‚è€ƒã«ãªã‚‰ãšã€è‡ªå‰ã§ã‚´ãƒªã‚´ãƒªå®Ÿè£…ã™ã‚‹ç¾½ç›®ã«ãªã‚Šã¾ã—ãŸãŒãªã‚“ã¨ã‹å®Ÿç¾ã§ããŸã®ã§ãã®è¨˜éŒ²ã‚’æ®‹ã—ã¾ã™ã€‚\n\n[contentlayerã‹ã‚‰ç§»è¡Œã®éš›ã®æ³¨æ„ç‚¹](#contentlayerã‹ã‚‰ç§»è¡Œã®éš›ã®æ³¨æ„ç‚¹) ã«ã‚ã‚‹ã‚ˆã†ã«ã€contentlayerã£ã½ã„ä½œã‚Šã‚’ãã®ã¾ã¾åˆ©ç”¨ã™ã‚‹ã“ã¨ã¯ã§ããªã„ã¨ã„ã®ã§ã“ã‚Œã‹ã‚‰å®Ÿæ–½ã™ã‚‹äººã¯æ³¨æ„ã—ã¦ãã ã•ã„ã€‚\n\n\n## å®Ÿè£…ç´¹ä»‹\n### è¨˜äº‹ä¸€è¦§å–å¾—éƒ¨åˆ†\nè¨˜äº‹ä¸€è¦§ã¯markdownã®frontmatterã®æƒ…å ±ã®ã¿ãŒå¿…è¦ãªãŸã‚ã€mdx-bundlerã¯åˆ©ç”¨ã›ãšã€[gray-matter](https://github.com/jonschlinkert/gray-matter)ã‚’ç”¨ã„ã¦è¨˜äº‹ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã—ãŸã€‚\n\n```tsx\nexport const baseDir = process.env.BASE_DIR || process.cwd();\n\nexport const getPostDirPath = () =>\n  path.join(baseDir, \"../blog-contents/contents/tech-blog\");\n\nexport async function getFrontMatter(\n  slug: string\n): Promise<FrontMatter | null> {\n  try {\n    const fileContent = await readFileFromMdorMds(slug);\n    if (!fileContent) return null;\n    const { data } = matter(fileContent);\n\n    // å‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã§ FrontMatter å‹ã‚’é©ç”¨\n    return data as FrontMatter;\n  } catch (error) {\n    console.error(\"Error reading Markdown file:\", error);\n    return null;\n  }\n}\n\nexport const getAllPosts = async (): Promise<FrontMatter[]> => {\n  const postDirPath = getPostDirPath();\n  const postFiles = await readdir(postDirPath);\n  const slugs = postFiles.map((file) =>\n    path.basename(file, path.extname(file))\n  );\n\n  const frontMattersPromises = slugs.map((slug) => getFrontMatter(slug));\n  const frontMatters = (await Promise.all(frontMattersPromises)).filter(\n    (post): post is FrontMatter => post !== null\n  );\n\n  return frontMatters;\n};\n```\n\n### bundleMDXã®è¨­å®š\nmarkdownå†…ã§ç”»åƒã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€remarkMdxImagesã®é©ç”¨ã¨ã€esbuildOptionsã«ã¦ã€Next.jsã®publicãƒ•ã‚©ãƒ«ãƒ€ã«ç”»åƒã‚’é…ç½®ã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã—ãŸã€‚\n```tsx\nimport { bundleMDX } from \"mdx-bundler\";\n\nexport const loadMDX = async (fileContent: string) => {\n  return bundleMDX<FrontMatter>({\n    source: fileContent,\n    cwd: getPostDirPath(),\n    mdxOptions(options) {\n      options.remarkPlugins = [\n        ...(options.remarkPlugins ?? []),\n        remarkGfm,\n        remarkMdxImages,\n      ];\n      options.rehypePlugins = [\n        ...(options.rehypePlugins ?? []),\n        rehypeSlug,\n      ];\n      return { ...options, providerImportSource: \"@mdx-js/react\" };\n    },\n    esbuildOptions(options) {\n      options.outdir = path.join(baseDir, \"public/images/blog/\");\n      options.loader = {\n        ...options.loader,\n        \".gif\": \"file\",\n        \".jpeg\": \"file\",\n        \".jpg\": \"file\",\n        \".png\": \"file\",\n        \".svg\": \"file\",\n        \".webp\": \"file\",\n      };\n      options.publicPath = \"/images/blog/\";\n      options.write = true;\n      return options;\n    },\n  });\n};\n\n```\n\n### è¨˜äº‹è©³ç´°ãƒšãƒ¼ã‚¸\napp/blog/[slug]/page.tsx\n```tsx\nexport const dynamic = \"error\";\nexport const dynamicParams = false;\n\nexport async function generateStaticParams() {\n  const slugs = await getSlugs();\n  return slugs.map((slug) => {\n    return { slug };\n  });\n}\n\ntype Props = {\n  params: Promise<{ slug: string }>;\n};\n\nexport default async function Page({ params }: Props) {\n  const { slug } = await params;\n  const fileContent = await readFileFromMdorMds(slug);\n  if (!fileContent) return notFound();\n\nconst mdx = await loadMDX(fileContent);\nconst { frontmatter, code } = mdx;\n\nreturn (\n    <article>\n        {/* è¨˜äº‹ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãªã©, frontmatterã®æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n    \n        <MDXComponent code={code}/>\n    </article>\n);\n```\n\napp/blog/[slug]/MDXComponent.tsx\n```tsx\n\"use client\";\nimport { useMemo } from \"react\";\nimport { getMDXComponent } from \"mdx-bundler/client\";\nimport { MDXProvider, useMDXComponents } from \"@mdx-js/react\";\nimport { Prism as SyntaxHighlighter } from \"react-syntax-highlighter\";\nimport { oneDark } from \"react-syntax-highlighter/dist/cjs/styles/prism\";\n\nconst GLOBAL_CONFIG = {\n  MdxJsReact: {\n    useMDXComponents,\n  }\n};\n\nexport function MDXComponent({ code }: { code: string }) {\n  const Component = useMemo(() => getMDXComponent(code, MDX_GLOBAL_CONFIG),[code]);\n\n  return (\n    <MDXProvider\n      components={{\n        code: ({ ...props }) => {\n          const { className, children } = props;\n          const match = /language-(\\w+)/.exec(className || \"\");\n          return match ? (\n            <SyntaxHighlighter\n              language={match[1]}\n              PreTag=\"div\"\n              {...props}\n              style={oneDark}\n            >\n              {String(children).replace(/\\n$/, \"\")}\n            </SyntaxHighlighter>\n          ) : (\n            <code className={className} {...props}>\n              {children}\n            </code>\n          );\n        },\n      }}\n    >\n      <Component />\n    </MDXProvider>\n  );\n}\n```\n[ã“ã¡ã‚‰](https://github.com/kentcdodds/mdx-bundler?tab=readme-ov-file#custom-components-in-downstream-files)ã‚’å‚è€ƒã«ã€codeã®ãƒã‚¤ãƒ©ã‚¤ãƒˆç­‰ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã®custom componentsã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ãªè¨­å®šã‚’å®Ÿæ–½ã—ã¦ã„ã¾ã™ã€‚\n\n\n## contentlayerã‹ã‚‰ç§»è¡Œã®éš›ã®æ³¨æ„ç‚¹\ncontentlayerã®å ´åˆã¯ã€`.contentlayer`é…ä¸‹ã«markdownãƒ•ã‚¡ã‚¤ãƒ«ã®æƒ…å ±ã‚’ã¾ã¨ã‚ãŸjsonã‚’ä½œæˆã—ã€ãƒ“ãƒ«ãƒ‰ç”Ÿæˆç‰©ã¨ã—ã¦ãƒãƒ³ãƒ‰ãƒ«ã—ã¦ã—ã¾ã†ã®ã§ã€SSRã®éš›ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸ã‚¢ã‚¯ã‚»ã‚¹ã›ãšã¨ã‚‚è¨˜äº‹æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã“ã¨ã§æ¥ã¦ã„ã¾ã—ãŸã€‚\n\nmdx-bundlerã®ã¿ã§åŒã˜ã‚ˆã†ãªæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€SSRã®éš›ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã®ã§ã€SSGã®ã¿ã«ã—ã¦ãŠãã‹ã€ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚\n\nè‡ªåˆ†ã®å ´åˆã€mdãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€å¿…è¦ãŒã‚ã‚‹ `/blog/[slug]/page.tsx` ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®è¨­å®šã‚’é©ç”¨ã—ã€SSGã®ã¿ã«ã™ã‚‹å¯¾å¿œã¨ã—ã¾ã—ãŸã€‚\n\n```\nexport const dynamic = \"error\";\nexport const dynamicParams = false;\n```\nhttps://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config\n\nâš ï¸ fetchã§revalidateã‚’ç”¨ã„ã¦ã„ã‚‹ISRã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚file systemå‚ç…§ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã¨æ€ã†ã®ã§å‰Šé™¤ã—ã¦ãã ã•ã„ã€‚è‡ªåˆ†ã¯fetchã®revalidateã—ã¦ã„ã‚‹éƒ¨åˆ†ãŒã‚ã‚‹ã“ã¨ã«å¿˜ã‚Œã¦1æ—¥ã»ã©ãƒãƒã‚Šã¾ã—ãŸã€‚ã€‚ã€‚\n\n\n\n\n## `@next/mdx`ã‚’åˆ©ç”¨ã—ãªã‹ã£ãŸç†ç”±\nãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’åˆ¥ã®markdownã®ã¿ã®ãƒªãƒã‚¸ãƒˆãƒªã§ç®¡ç†ã—ã¦ã„ãŸã‹ã‚‰ã§ã™ã€‚\n`@next/mdx`ã®å ´åˆã€Next.jsã®ãŠä½œæ³•ã«å¾“ã£ã¦ mdxãƒ•ã‚¡ã‚¤ãƒ«ã‚’appãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹ã«é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ãƒ–ãƒ­ã‚°è¨˜äº‹ç®¡ç†ã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å®Ÿè£…ãŒç–çµåˆã«ãªã‚‹ã®ãŒæ°—ã«å…¥ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\n\nå‚è€ƒ: https://nextjs.org/docs/pages/building-your-application/configuring/mdx\n\n## `next-mdx-remote`ã‚’åˆ©ç”¨ã—ãªã‹ã£ãŸç†ç”±\nesbuildã‚’dependencyã«å«ã‚ã¦ã—ã¾ã£ã¦,mdxå†…ã®importã‚’è§£æ±ºã—ã¦ãã‚Œã‚‹ã®ãŒå¬‰ã—ã„ã§ã™ã€‚\nmarkdownã§è¨˜äº‹ã‚’ç®¡ç†ã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã«Componentã‚’é…ç½®ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ã€è¨˜äº‹ã®ç®¡ç†ã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å®Ÿè£…ã«ä¾å­˜ã•ã›ã‚‹ã“ã¨ãªãç®¡ç†ã§ãã¾ã™ã€‚\n\n\n## æœ€å¾Œã«\nmdx-bundlerã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚ã‹ã‚Šã‚„ã™ã„æ„Ÿã˜ã§markdownã«Bookmark(Linkcard)ã‚’é…ç½®ã™ã‚‹ã“ã¨ãŒã§ãã¦è‰¯ã„æ„Ÿã˜ã ãªã¨ğŸ‰\n```\nimport { Bookmark } from \"../../components/Bookmark\";\n\n<Bookmark href=\"https://sokes-nook.net/blog/next-web-push\" siteUrl=\"https://sokes-nook.net\" />\n```\nè¡¨ç¤ºçµæœâ†“\n<Bookmark href=\"https://sokes-nook.net/blog/next-web-push\" siteUrl=\"https://sokes-nook.net\" />\n\n\nmdxã«ç§»è¡Œã™ã‚‹ä»¥å‰ã¯ã€Bookmark(Linkcard)ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ä»¥ä¸‹ã®ã‚ˆã†ãªãªã‚“ã¡ã‚ƒã£ã¦ã®unifiedãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œã£ã¦é ‘å¼µã£ã¦ã„ã¾ã—ãŸãŒã€ã¨ã¦ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã«ãªã£ã¦ã¨ã¦ã‚‚ã»ã£ã“ã‚Šã§ã™ã€‚\n\n<Bookmark href=\"https://sokes-nook.net/blog/unified-notion-bookmark\" siteUrl=\"https://sokes-nook.net\" />\n\n\n\ncontentlayerã¨mdx-bundlerã¯åŒã˜å½¹å‰²ã§ã¯ãªã„ã®ã§ã€å³å¯†ã«ã¯ç§»è¡Œã¨ã¯è¨€ãˆãªã„ã¨æ³¨æ„ã•ã‚Œãã†ãªã®ã§è£œè¶³ã—ã¦ãŠãã¨ã€contentlayeråˆ©ç”¨æ™‚ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã«ã¯[react-markdwon](https://github.com/remarkjs/react-markdown)ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã—ãŸã€‚\n","date":"2025-02-26T10:44:36.000Z"},{"slug":"2025-03-01-my-dotfiles","title":"dotfilesã®è‚²æˆ in 2025ã€mise, sheldon, raycastãªã©ã€‘","tags":["tech","dotfiles","mise","sheldon","raycast","fzf","shell"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n\n## ã¯ã˜ã‚ã«\nPCã‚’ãƒªãƒ—ãƒ¬ã‚¤ã‚¹æ©Ÿä¼šãŒã‚ã£ãŸã®ã§dotfilesã‚’æ•´ç†ã—ã¾ã—ãŸã€‚\n\nã‚ã‚‹ç¨‹åº¦èª¿æŸ»ã‚’ã—ã¦ã€è‡ªåˆ†ãŒä½¿ã„ã“ãªã›ã‚‹ç¯„å›²ã®æœ€ä½é™æ•´ãˆã‚‹ãŸã‚ã®dotfilesã¨ã„ã£ãŸæ„Ÿã˜ã§ã™ã€‚  \nã€Œrustè£½ã®ãƒ„ãƒ¼ãƒ«ã§æƒãˆã¦ã¨ã«ã‹ãæ—©ã„ç’°å¢ƒã‚’ä½œã‚‹ã€ã¿ãŸã„ãªã„ãªã“ã ã‚ã‚Šã‚‚ç‰¹ã«ã‚ã‚Šã¾ã›ã‚“ã€‚\n\nãƒªãƒã‚¸ãƒˆãƒªã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚  \nhttps://github.com/nyankiti/dotfiles\n\n## 2023æ™‚ç‚¹ã‹ã‚‰ã®å¤‰åŒ–\n### mise\nã‚ã‚‰ã‚†ã‚‹è¨€èªã‚’ç®¡ç†ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ãŸã“ã¨ãŒãªã‹ã£ãŸã®ã§ã“ã‚Œã‚’æ©Ÿã«å…¥é–€ã—ã¾ã—ãŸã€‚\nã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ç”¨ã„ã‚‹å®Ÿè¡Œç’°å¢ƒã«ã¤ã„ã¦ã¯å…¨ã¦[mise](https://github.com/jdx/mise)ã¸é›†ç´„ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚\n\nãã‚Œãã‚Œã®è¨€èªã§å€‹åˆ¥ã§PATHã‚’é€šã—ã¦ã„ãŸã‚‚ã®ãŒä»¥ä¸‹ã§é›†ç´„ã•ã‚Œã€.zshrcãŒã¨ã¦ã‚‚ã™ã£ãã‚Šã—ã¾ã—ãŸã€‚\n```\neval \"$(mise activate zsh)\"\nexport PATH=\"$HOME/.local/share/mise/shims:$PATH\"\n```\n\n### zinit => Sheldon\nSheldon ãŒæ—©ã„ & toml ãƒ•ã‚¡ã‚¤ãƒ«ã§è¨­å®šã‚’ç®¡ç†ã§ãã‚‹ã¨å™‚ã‚’èã„ã¦ã„ãŸã®ã§ã“ã‚Œã‚’æ©Ÿã«å…¥é–€ã—ã¾ã—ãŸã€‚\n\n[zinitãŒä¸å®‰ãªã®ã§sheldonã¸ç§»è¡Œã—ãŸã‚‰zshã®èµ·å‹•ãŒ50msã¨æ›´ã«é€Ÿããªã£ãŸ](https://ktrysmt.github.io/blog/migrate-zinit-to-sheldon/) ç­‰ã‚’è¦‹ã‚‹ã¨é…å»¶èª­ã¿è¾¼ã¿ã®è¨­å®šã‚’æ›¸ã„ã¦ã„ã¾ã—ãŸã€‚èˆˆå‘³ã®ã‚ã‚‹äººã¯ã“ã¡ã‚‰ã‚‚è©¦ã™ã¨è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚\n\nè‡ªåˆ†ã¯ä¸Šè¨˜ã®é…å»¶èª­ã¿è¾¼ã¿ã‚’å…¥ã‚Œã‚‹ã¨ kube-ps1 ã®$PROMPTã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒåˆå›ã‹ã‚‰èª­ã¿è¾¼ã‚ãªã„ã¨ã„ã†å•é¡ŒãŒã‚ã£ãŸã®ã§åˆ©ç”¨ã—ã¾ã›ã‚“ã§ã—ãŸã€‚\n\n```\nshell = \"zsh\"\n\n# pure ãƒ†ãƒ¼ãƒ\n[plugins.pure]\ngithub = \"sindresorhus/pure\"\nuse = [\"async.zsh\", \"pure.zsh\"]\n\n# æ§‹æ–‡ãƒã‚¤ãƒ©ã‚¤ãƒˆ\n[plugins.zsh-syntax-highlighting]\ngithub = \"zsh-users/zsh-syntax-highlighting\"\n\n# è£œå®Œ\n[plugins.zsh-completions]\ngithub = \"zsh-users/zsh-completions\"\n\n# ã‚ªãƒ¼ãƒˆã‚µã‚¸ã‚§ã‚¹ãƒˆ\n[plugins.zsh-autosuggestions]\ngithub = \"zsh-users/zsh-autosuggestions\"\n```\n[pure](https://github.com/sindresorhus/pure)ã¯æœ€åˆã«å…¥ã‚ŒãŸzsh themeã§æ€ã„å…¥ã‚ŒãŒã‚ã‚‹ã®ã‹ãšã£ã¨åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚\n\n### alfred, clipy => raycast\nraycastã¯1å¹´ä»¥ä¸Šä½¿ã£ã¦ã„ã¾ã—ãŸãŒã€dotfilesã«è½ã¨ã—è¾¼ã‚ã¦ã„ãªã‹ã£ãŸã®ã§è¿½åŠ ã—ã¾ã—ãŸã€‚\nraycastã®è¨­å®šã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ/ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒã§ãã‚‹ã‚ˆã†ã§ã€è©³ç´°ã¯ä»¥ä¸‹ã‚’å‚ç…§ãã ã•ã„ã€‚é€šå¸¸ã®è¨­å®šã«åŠ ãˆã¦ã‚¹ãƒ‹ãƒšãƒƒãƒˆãªã©ã®æƒ…å ±ã‚‚å¼•ãç¶™ã’ã‚‹ã‚ˆã†ã§ã™ã€‚\n<Bookmark href=\"https://www.raycast.com/changelog/1-22-0\" />\n\nå€‹äººçš„ã«ã¯raycastã¯alfredã®å®Œå…¨ä¸Šä½äº’æ›ã¨æ‰ãˆã¦ãŠã‚Šã€ã¨ã¦ã‚‚é‡å®ã—ã¦ã„ã¾ã™ã€‚\n\n### peco => fzf\npecoã§ç‰¹ã«ä¸æº€ã¯ãªã‹ã£ãŸã®ã§ã™ãŒã€è‰²ã€…ã¨fzfã®æ–¹ãŒå„ªã‚Œã¦ã„ã‚‹æ°—ã¯ã—ã¦ã„ãŸã®ã§ä¹—ã‚Šæ›ãˆã¾ã—ãŸã€‚\nã¨ã„ã£ã¦ã‚‚ç¾çŠ¶ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰å±¥æ­´æ¤œç´¢ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ç¨‹åº¦ã§ã™ã€‚ã‚‚ã£ã¨è‰²ã€…ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹ã¯ãšãªã®ã§ã€ã“ã‚Œã‹ã‚‰è‰²ã€…è©¦ã—ã¦ã„ããŸã„ã§ã™ã€‚ \n```\nfunction history_search_with_fzf() {\n    local selected_command\n    selected_command=$(history -n 1 | tac | awk '!a[$0]++' | fzf --height 40% --layout=reverse --border --inline-info)\n    if [ -n \"$selected_command\" ]; then\n        BUFFER=$selected_command\n        CURSOR=$#BUFFER\n        zle reset-prompt\n    fi\n}\nzle -N history_search_with_fzf\nbindkey '^R' history_search_with_fzf\n```\n\nåˆ©ç”¨ä¾‹â†“\n![alt text](<images/2025-03-01-my-dotfiles/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ 2025-03-01 22.09.22.png>)\n\n### .gitconfig\n.gitconfigã«ã‚ˆã‚‹ä»¥ä¸‹ã®è¨­å®šã‚’dotfilesã«è¿½åŠ ã€‚`git pull`ã—ãŸæ™‚ã® merge strategyã®æŒ‡å®šãŒãªã„ãã¨è¨€ã‚ã‚Œã‚‹ã‚ã®ãƒ¯ãƒ¼ãƒ‹ãƒ³ã‚°ã¸ã®å¯¾ç­–ã§ã™\n```\n[include]\n  path = ~/dotfiles/git/user.conf\n[color]\n\tui = true\n[core]\n\tautocrlf = false\n\tignorecase = false\n\tquotepath = false\n\tsafecrlf = true\n[init]\n\tdefaultBranch = main\n[pull]\n\trebase = false\n[push]\n\tdefault = current\n    autoSetupRemote = true\n[merge]\n  ff = false\n```\n\n## GitHub Actionsã§å†ç¾æ€§ã®æ‹…ä¿\n`macos-latest`ç’°å¢ƒã«ã¦`setup.sh`ã¨`source .zshrc`ãŒæ­£å¸¸çµ‚äº†ã™ã‚‹ã“ã¨ã‚’GitHub Actionsã§æ‹…ä¿ã—ã¾ã—ãŸã€‚\n```\njobs:\n  check:\n    runs-on: macos-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n\n      - name: Setup.sh\n        run: bash setup.sh\n        shell: zsh {0}\n        env:\n          SHELL: /usr/bin/zsh\n      - name: Source .zshrc\n        run: source zsh/.zshrc\n        shell: zsh {0}\n        env:\n          SHELL: /usr/bin/zsh\n```\n\n## æœ€å¾Œã«\nmise, sheldon, fzfã¯åˆã‚ã¦è§¦ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã€çµå±€1æ—¥ãã‚‰ã„æ ¼é—˜ã—ã¦ã„ã¾ã—ãŸã€‚  \nCursor, Warpç­‰ã®ç”ŸæˆAIå‘¨ã‚Šã®ãƒ„ãƒ¼ãƒ«ã®ç’°å¢ƒæ•´å‚™ã‚‚dotfilesã«è½ã¨ã—è¾¼ã¿ãŸã‹ã£ãŸã®ã§ã™ãŒã€ä»Šå›ã¯å®šç•ªã©ã“ã‚ã‚’æŠ¼ã•ãˆã¦ã„ãã ã‘ã§æ™‚é–“ãŒã™ã”ã„ã‹ã‹ã£ãŸã®ã§ã¾ãŸåˆ¥ã®æ©Ÿä¼šã«ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n\nä»Šå›ãƒ¡ã‚¤ãƒ³ã§å‚è€ƒã«ã•ã›ã¦ã„ãŸã ã„ãŸè¨˜äº‹ã§ã™ğŸ™\n- [2024å¹´åº¦ ã‚ãŸã—ã®dotfilesã‚’ç´¹ä»‹ã—ã¾ã™](https://zenn.dev/smartcamp/articles/f20a72910bde40)\n  - https://github.com/ayuukumakuma/dotfiles\n- [Macã®ç’°å¢ƒã‚’dotfilesã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦ã¿ãŸæ”¹](https://github.com/tsukuboshi/dotfiles)\n- [dotfilesã§å†æ§‹ç¯‰å¯èƒ½ãªã‚¿ãƒ¼ãƒŸãƒŠãƒ«ç’°å¢ƒæ§‹ç¯‰ã‚’ç›®æŒ‡ã—ã¦ã¿ãŸ](https://dev.classmethod.jp/articles/dotfiles-reconstruct-termina-env/)\n\n","date":"2025-03-01T02:31:36.000Z"},{"slug":"2025-03-02-open-ai-batch-api","title":"Open AIã®Batch APIã‚’åˆ©ç”¨ã—ã¦embeddingã‚’50%å‰²å¼•ã§å®Ÿæ–½ã™ã‚‹ã€node.jsã€‘","tags":["tech","node.js","openai","prisma"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n\n## OpenAIã®Batch APIã¨ã¯\n<Bookmark href=\"https://platform.openai.com/docs/guides/batch\" />\n\nOpenAIã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’éåŒæœŸã§å‡¦ç†ã—ã€ã‚³ã‚¹ãƒˆã‚’å‰Šæ¸›ã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½ã§ã™ã€‚é€šå¸¸ã®APIã¨æ¯”è¼ƒã—ã¦50%å‰²å¼•ã¨ãªã£ã¦ãŠã‚Šã€ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«å„ªã‚Œã¦ã„ã¾ã™ã€‚\n\nè¤‡æ•°ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’JSON Linesï¼ˆ.jsonlï¼‰å½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ›¸ãå‡ºã—ã¦é€ä¿¡ã—ã€æœ€å¤§24æ™‚é–“ä»¥å†…ã«çµæœã® .jsonl ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\nå…¬å¼Docã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚\n\n- è©•ä¾¡ã®å®Ÿè¡Œ\n- å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åˆ†é¡\n- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®embedding\n\nä»Šå›ã¯RAGã‚’çµ„ã‚€éš›ã®ãƒ‡ãƒ¼ã‚¿ã®embeddingã«åˆ©ç”¨ã—ã¾ã—ãŸã€‚\nåŸºæœ¬çš„ã«ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ãŒå¿…è¦ã®ãªã„åˆ©ç”¨ã§ã‚ã‚Œã°ã©ã®ã‚ˆã†ãªç”¨é€”ã§ã‚‚åˆ©ç”¨å¯èƒ½ã ã¨æ€ã„ã¾ã™ã€‚\n\n### Batch APIã®åˆ©ç”¨æ‰‹é †ã¯ä»¥ä¸‹\n\n1. **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ**: å‡¦ç†ã—ãŸã„ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’JSON Linesï¼ˆ.jsonlï¼‰å½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ã¨ã‚ã¾ã™ã€‚\n2. **ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**: ä½œæˆã—ãŸ.jsonlãƒ•ã‚¡ã‚¤ãƒ«ã‚’OpenAIã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚\n3. **ãƒãƒƒãƒã‚¸ãƒ§ãƒ–ã®é–‹å§‹**: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦ãƒãƒƒãƒå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã‚¸ãƒ§ãƒ–ã‚’ä½œæˆã—ã¾ã™ã€‚\n4. **çµæœã®å–å¾—**: å‡¦ç†ãŒå®Œäº†ã—ãŸã‚‰ã€çµæœã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ç¢ºèªã—ã¾ã™ã€‚\n\nä»Šå›ã¯node.jsã‚’ç”¨ã„ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€çµæœã‚’å—ã‘å–ã£ã¦DBã«ä¿å­˜ã™ã‚‹ã¾ã§ã®å‡¦ç†ã‚’ç´¹ä»‹ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚\n\n## ã‚„ã£ãŸã“ã¨ã¾ã¨ã‚\n\n- ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã¾ã¨ã‚ãŸ.jsonlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ\n- openAIã®Batch APIãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«.jsonlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\n- å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§æœ€å¤§24æ™‚é–“å¾…æ©Ÿ\n- openAIã®Batch APIãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰çµæœã®.jsonlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\n- node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆã§çµæœ.jsonlãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€çµæœã‚’postgresã«æ ¼ç´\n\n### ãªãœnode.jsã‚’ç”¨ã„ãŸã‹ï¼Ÿ\n\nnode.jsã‚’åˆ©ç”¨ã—ãŸã‚¢ãƒ—ãƒªã®ä¸€ç’°ã§ä½œæˆã—ãŸãƒãƒƒãƒå‡¦ç†ã ã£ãŸãŸã‚ã§ã™ã€‚prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç”Ÿã®SQLã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã® `queryRawTyped` ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã®ã§ã€ã©ã®è¨€èªã€DBã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”¨ã„ã¦ã‚‚åŒã˜ã ã¨æ€ã„ã¾ã™ã€‚\n\nPythonã®ç’°å¢ƒãŒã‚ã‚‹å ´åˆã¯Pythonã§ã‚„ã£ã¦ã—ã¾ã£ãŸæ–¹ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚\n\n### ãªãœopenAIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®[batchs](https://github.com/openai/openai-node/blob/master/src/resources/batches.ts)ã‚’åˆ©ç”¨ã—ãªã„ã®ã‹ï¼Ÿ\n\næœ€åˆã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’è¦‹ãªãŒã‚‰åˆ©ç”¨ã—ãŸãªã¨æ„Ÿã˜ãŸã‹ã‚‰ã§ã™ã€‚ãã®ã†ã¡openAIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆ©ç”¨ã«ç§»è¡Œã™ã‚‹ã¨æ€ã„ã¾ã™ã€‚openAIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’åˆ©ç”¨ã™ã‚‹ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§ã¯batchIdã‚’ç®¡ç†ã™ã‚‹ã ã‘ã§è‰¯ããªã‚Šãã†ã§ã™ã€‚\n\n### åˆ©ç”¨ãƒ¢ãƒ‡ãƒ«\n\n2025/02/22 æ™‚ç‚¹ã§æœ€ã‚‚ã‚³ã‚¹ãƒ‘ã®è‰¯ã•ãã†ãª`text-embedding-3-small` ã‚’åˆ©ç”¨ã—ã¾ã—ãŸã€‚\n\n[https://openai.com/ja-JP/index/new-embedding-models-and-api-updates/](https://openai.com/ja-JP/index/new-embedding-models-and-api-updates/)\n\n## å®Ÿè£…ç´¹ä»‹\n\n### ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã¾ã¨ã‚ãŸ.jsonlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ\n\n```tsx\nimport fs from \"fs/promises\";\nimport path from \"path\";\n\nexport async function processInput() {\n  const dataForEmbedding = [\"aaaaaa\", \"bbbbbb\", \"cccccc\"];\n\n  const requests = dataForEmbedding.map((data, i) => {\n    // OpenAI ã¯æ”¹è¡Œã‚’ç©ºç™½ã«ç½®æ›ã™ã‚‹ã“ã¨ã‚’å¥¨åŠ±ã—ã¦ã„ã‚‹\n    const input = data.replace(/\\n/g, \" \");\n    return {\n      custom_id: i,\n      method: \"POST\",\n      url: \"/v1/embeddings\",\n      body: {\n        /** @see https://openai.com/ja-JP/index/new-embedding-models-and-api-updates/ */\n        model: \"text-embedding-3-small\",\n        input,\n      },\n    };\n  });\n\n  const filePath = path.resolve(\n    __dirname,\n    \"./openai-batch-data/input/requests_embedding_1.jsonl\"\n  );\n  // requestsã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€\n  const fileHandle = await fs.open(filePath, \"w\");\n  const stream = fileHandle.createWriteStream();\n  for (const request of requests) {\n    stream.write(JSON.stringify(request) + \"\\n\");\n  }\n  stream.end();\n  console.log(\"requests.jsonl created\");\n}\n\nprocessInput()\n```\n\nä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«\n\n```json\n{\"custom_id\":\"0\",\"method\":\"POST\",\"url\":\"/v1/embeddings\",\"body\":{\"model\":\"text-embedding-3-small\",\"input\":\"aaaaaa\"}}\n{\"custom_id\":\"1\",\"method\":\"POST\",\"url\":\"/v1/embeddings\",\"body\":{\"model\":\"text-embedding-3-small\",\"input\":\"bbbbbb\"}}\n{\"custom_id\":\"2\",\"method\":\"POST\",\"url\":\"/v1/embeddings\",\"body\":{\"model\":\"text-embedding-3-small\",\"input\":\"cccccc\"}}\n```\n\n### Batch APIãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«.jsonlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\n\n[https://platform.openai.com/batches/](https://platform.openai.com/batches/)\n\n![alt text](images/2025-03-02-open-ai-batch-api/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ_2025-02-22_15.19.26.png)\n\nembeddingã«åˆ©ç”¨ã™ã‚‹ã®ã§ Endpointã¯ /v1/embeddings ã‚’é¸æŠã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚Completion windowã¯ç¾åœ¨ 24 hours ã—ã‹é¸æŠã§ããªã„ã‚ˆã†ã§ã™ã€‚\n\nã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¾Œã€å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§æœ€å¤§24æ™‚é–“å¾…ã¡ã¾ã™ã€‚\n\nãƒ•ã‚¡ã‚¤ãƒ«ã®å¤§ãã•ã‚„ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã‚ˆã‚‹ã¨æ€ã„ã¾ã™ãŒã€è‡ªåˆ†ã¯3æ™‚é–“ã‹ã‹ã‚‹ã“ã¨ã‚‚ã‚ã‚Œã°ãŒã€15åˆ†ã§çµ‚ã‚ã‚‹ã“ã¨ã‚‚ã‚ã‚ã‚Šã¾ã—ãŸã€‚\n\n### Batch APIãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰çµæœã®.jsonlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\n\nå‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªUIã¨ãªã‚Šã€ŒDownload outputã€ã‚ˆã‚Šçµæœã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™\n\n![alt text](images/2025-03-02-open-ai-batch-api/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ_2025-02-22_15.22.02.png)\n\nãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«\n\n```json\n{\"id\": \"batch_req_67b613c5e9188190932e345eb13da6d1\", \"custom_id\": \"0\", \"response\": {\"status_code\": 200, \"request_id\": \"c83d0bac65b0fc758f0217d67426cf63\", \"body\": {\"object\": \"list\", \"data\": [{\"object\": \"embedding\", \"index\": 0, \"embedding\": [0.022931391, ... ], \"model\": \"text-embedding-3-small\", \"usage\": {\"prompt_tokens\": 930, \"total_tokens\": 930}}}, \"error\": null}\n{\"id\": \"batch_req_67b613c7247481909a98dd2762d6a38c\", \"custom_id\": \"1\", \"response\": {\"status_code\": 200, \"request_id\": \"941ebd3de9c6f6cafa5658c708d91c1d\", \"body\": {\"object\": \"list\", \"data\": [{\"object\": \"embedding\", \"index\": 0, \"embedding\": [-0.007332558, ...], \"model\": \"text-embedding-3-small\", \"usage\": {\"prompt_tokens\": 294, \"total_tokens\": 294}}}, \"error\": null}\n{\"id\": \"batch_req_67b613c734388190add5465b04db485a\", \"custom_id\": \"2\", \"response\": {\"status_code\": 200, \"request_id\": \"6ae9f597f1fa88e9b9238ac9a8a9638b\", \"body\": {\"object\": \"list\", \"data\": [{\"object\": \"embedding\", \"index\": 0, \"embedding\": [0.019804584, ...], \"model\": \"text-embedding-3-small\", \"usage\": {\"prompt_tokens\": 439, \"total_tokens\": 439}}}, \"error\": null}\n```\n\n### node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸ.jsonlãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€çµæœã‚’postgresã«æ ¼ç´\n\n```tsx\nimport { prisma } from \"@gizilog/shared/prisma\";\nimport fs from \"fs/promises\";\nimport path from \"path\";\nimport { ebeddingBulkInsert } from \"@prisma/client/sql\";\n\ntype BatchResponseJson = {\n  id: string;\n  custom_id: string;\n  response: {\n    status_code: 200;\n    request_id: string;\n    body: {\n      id: string;\n      object: \"list\";\n      model: \"text-embedding-3-small\";\n      data: [{ object: \"embedding\"; index: number; embedding: number[] }];\n    };\n  };\n  error: null;\n};\n\nexport async function output() {\n  const filePath = path.resolve(\n    __dirname,\n    \"./openai-batch-data/output/requests_embedding_1.jsonl\"\n  );\n  const content = await fs.readFile(filePath, \"utf-8\");\n\n  const updates: { id: string; embedding: number[] }[] = [];\n\n  for (const line of content.split(\"\\n\")) {\n    try {\n      const json = JSON.parse(line) as BatchResponseJson;\n      const embedding = json.response.body.data[0].embedding;\n      updates.push({ id: json.custom_id, embedding });\n    } catch (e) {\n      console.error(e);\n      console.log(\"line:\", line);\n    }\n  }\n  const batchSize = 15; // connectionæ•°ã®ä¸Šé™ã¾ã§ã¾ã¨ã‚ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹\n  for (let i = 0; i < updates.length; i += batchSize) {\n    const batch = updates.slice(i, i + batchSize);\n    // speechid ã¨ embedding ã®é…åˆ—ã‚’ Postgres ã® `UNNEST` ã«æ¸¡ã™å½¢å¼ã«å¤‰æ›\n    const speechIds = batch.map((update) => update.id);\n    const embeddings = batch.map((update) => JSON.stringify(update.embedding)); // JSON ã«å¤‰æ›ã—ã¦ PostgreSQL å´ã§ `::vector(1536)` ã«ã‚­ãƒ£ã‚¹ãƒˆ\n\n    await prisma.$queryRawTyped(\n      embeddingBulkInsert(speechIds, embeddings)\n    );\n  }\n\n  // å‡¦ç†ã—ãŸoutputãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ¤åˆ¥ã™ã‚‹ãŸã‚ `.done` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã™ã‚‹\n  const doneFilePath = filePath + \".done\";\n  await fs.writeFile(doneFilePath, \"\");\n  console.log(\"is successfully feeded\");\n}\n\n```\n\nembeddingBulkInsertã®SQLã¯ä»¥ä¸‹ã§ã™ã€‚\n\n```sql\nUPDATE sample_table\nSET embedding = embeddings.embedding::vector(1536)\nFROM (SELECT UNNEST($1::text[]) AS id, UNNEST($2::vector(1536)[]) AS embedding) AS embeddings\nWHERE sample_table.id = embeddings.id;\n```\n\nPrismaã®TypedSQLã‚’åˆ©ç”¨ã™ã‚‹éš›ã¯ä»¥ä¸‹ãŒå‚è€ƒã«ãªã‚Šã¾ã™ã€‚åˆ©ç”¨ã™ã‚‹å‰ã«`prisma generate --sql` ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\n\n<Bookmark href=\"https://zenn.dev/tockn/articles/0e6eac6220e072\" />\n","date":"2025-03-01T18:36:53.000Z"},{"slug":"apache-pulsar-catchup","title":"Apache Pulsarã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ç«‹ã¡ä¸Šã’ã€Spring for Apache Pulsarã‚’å‹•ä½œç¢ºèªã™ã‚‹ãƒ¡ãƒ¢","tags":["tech","java","pulsar"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \n# Apache Pulsarã¨ã¯  \n  \n  \nãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚’æ‰±ã†ãŸã‚ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®åˆ†æ•£ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã€‚Apache Kafkaã«æ¯”ã¹ã€æŸ”è»Ÿæ€§ã‚„æ‹¡å¼µæ€§ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«é©ã—ã¦ã„ã¾ã™ã€‚ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆã®é‹ç”¨ã‚„ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç®¡ç†ãŒå¿…è¦ãªå ´åˆã«ç‰¹ã«æœ‰åˆ©ã€‚  \n  \n  \nãƒˆãƒ”ãƒƒã‚¯åãŒéšå±¤åŒ–ã•ã‚Œã¦ãŠã‚Šãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆã—ã‚„ã™ã„ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£/ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹/ãƒ‡ã‚¹ãƒ†ã‚£ãƒãƒ¼ã‚·ãƒ§ãƒ³ ã§ãƒˆãƒ”ãƒƒã‚¯åãŒéšå±¤åŒ–ã•ã‚Œã¦ã„ã‚‹ï¼‰  \n  \n  \nã¾ãŸã€ã‚¸ã‚ªãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ãŒå‚™ã‚ã£ã¦ã„ã‚‹ã€‚  \n  \n  \nspringãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€2022å¹´ã‹ã‚‰apache pulsarã®ã‚µãƒãƒ¼ãƒˆã‚’é–‹å§‹ã—ã¦ã„ã‚‹[https://spring.io/blog/2022/08/16/introducing-experimental-spring-support-for-apache-pulsar](https://spring.io/blog/2022/08/16/introducing-experimental-spring-support-for-apache-pulsar)  \n  \n  \nå‚è€ƒ  \n  \n- å…¬å¼doc  \n    \n    <Bookmark href=\"https://pulsar.apache.org/docs/4.0.x/\" />\n  \n- Apache Pulsarã®ãƒãƒãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã‚‹[Astra Streaming](https://www.datastax.com/lp/astra-registration)ã‚’æä¾›ã™ã‚‹DataStaxè€…ã®æ–¹ã«ã‚ˆã‚‹è¨˜äº‹ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°åŠã³ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã®æ¦‚è¦³ã‹ã‚‰å§‹ã¾ã‚Šã€Apache Kafkaã¨ã®é•ã„ã‚’å–ã‚Šä¸Šã’ãªãŒã‚‰Apache Pulsarã«ã¤ã„ã¦ã‚ã‹ã‚Šã‚„ã™ãè§£èª¬ã•ã‚Œã¦ã„ã‚‹ã€‚  \n  \n    <Bookmark href=\"https://qiita.com/yoshiyuki_kono/items/839ca884eb52f6d0950e\" />\n  \n- Yahoo!ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒå…¬é–‹ã—ã¦ã„ã‚‹ä»¥ä¸‹ã®ã‚¹ãƒ©ã‚¤ãƒ‰ç¾¤  \n[https://www.docswell.com/tag/Apache Pulsar](https://www.docswell.com/tag/Apache%20Pulsar)  \n- baeldungã®è§£èª¬  \n[https://www.baeldung.com/apache-pulsar  \n](https://www.baeldung.com/apache-pulsar)[https://www.baeldung.com/spring-boot-apache-pulsar](https://www.baeldung.com/spring-boot-apache-pulsar)  \n  \n# Apache Pulsarã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ç«‹ã¡ä¸Šã’ã€**Spring for Apache Pulsarã‚’å‹•ä½œç¢ºèªã™ã‚‹**  \n  \n  \n### pulsarã‚’single nodeã§ç«‹ã¡ä¸Šã’ã‚‹  \n  \n  \nå…¬å¼ã®Apache Pulsar distributionã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦è§£å‡  \n  \n  \n```shell  \nwget https://archive.apache.org/dist/pulsar/pulsar-4.0.0/apache-pulsar-4.0.0-bin.tar.gz  \ntar xvfz apache-pulsar-4.0.0-bin.tar.gz  \n```  \n  \n  \nè§£å‡ã•ã‚ŒãŸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ç§»å‹•ã—ã€standalone pulsarã‚’startã™ã‚‹  \n  \n  \n```shell  \ncd apache-pulsar-4.0.0  \nbin/pulsar standalone  \n```  \n  \n  \nå‚è€ƒ: [https://pulsar.apache.org/docs/4.0.x/getting-started-standalone/](https://pulsar.apache.org/docs/4.0.x/getting-started-standalone/)  \n  \n  \n### ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½œæˆã™ã‚‹  \n  \n  \n```shell  \nbin/pulsar-admin topics create persistent://public/default/my-topic  \n```  \n  \n  \nâ€» pulsarã¯è‡ªå‹•çš„ã«å­˜åœ¨ã—ãªã„ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½œæˆã™ã‚‹æ©Ÿèƒ½ãŒã‚ã‚‹ãŒã€ã‚ãˆã¦æ˜ç¤ºçš„ã«å‰ã‚‚ã£ã¦ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½œæˆã—ã¦ã„ã‚‹  \n  \n  \n### spring ã® pulsar clientã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®produce/consumeã™ã‚‹  \n  \n  \n[spring initializr](https://start.spring.io/) ã‚ˆã‚Šã€Dependenciesã«**Spring for Apache Pulsar** ã‚’é¸æŠã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹  \n  \n  \n```java  \n@SpringBootApplication  \npublic class PulsarBootHelloWorld {  \n  \n    public static void main(String[] args) {  \n        SpringApplication.run(PulsarBootHelloWorld.class, args);  \n    }  \n  \n    @Bean  \n    ApplicationRunner runner(PulsarTemplate<String> pulsarTemplate) {  \n        return (args) -> pulsarTemplate.send(\"my-topic\", \"Hello Pulsar World!\");  \n    }  \n  \n    @PulsarListener(subscriptionName = \"hello-pulsar-sub\", topics = \"my-topic\")  \n    void listen(String message) {  \n        System.out.println(\"Message Received: \" + message);  \n    }  \n}  \n```  \n  \n  \nâ€» pulsarã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®localhost:6650ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹æƒ³å®šã®ãŸã‚ã€è¿½åŠ ã®è¨­å®šã¯ã—ã¦ã„ãªã„  \n  \n  \nä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ‰‹å‹•ã§produceã™ã‚‹ã“ã¨ã§å‹•ä½œç¢ºèªã§ãã‚‹  \n  \n  \n```shell  \nbin/pulsar-client produce my-topic --messages 'Hello Pulsar World from CLI'  \n```  \n  \n","date":"2024-11-30T00:00:00.000Z"},{"slug":"create-kubernetes-operator","title":"k8så…¥é–€è€…ãŒè¶…ã‚·ãƒ³ãƒ—ãƒ«ãªKubernetes Operatorã‚’ä½œã£ã¦k8sã®ç†è§£ã‚’æ·±ã‚ã‚‹","tags":["kubernetes","tech"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \n## ã¯ã˜ã‚ã«  \n\nkubernetesã®ç†è§£ãŒç”˜ã„æ°—ãŒã™ã‚‹ã¨æ¼ ç„¶ã¨ä¸Šå¸ã«ç›¸è«‡ã—ãŸã¨ã“ã‚ã€Kubernetes Operatorã®è‡ªä½œã‚’å‹§ã‚ã‚‰ã‚ŒãŸã®ã§å¥®é—˜ã—ãŸè¨˜éŒ²ã§ã™ã€‚  \n  \n  \nç¾åœ¨ã®Kubernetesã«ã¤ã„ã¦ã®ãƒ¬ãƒ™ãƒ«æ„Ÿã¨ã—ã¦ã¯ã€Œ [Kuberneteså®Œå…¨ã‚¬ã‚¤ãƒ‰](https://www.amazon.co.jp/Kubernetes%E5%AE%8C%E5%85%A8%E3%82%AC%E3%82%A4%E3%83%89-%E7%AC%AC2%E7%89%88-Top-Gear-%E9%9D%92%E5%B1%B1/dp/4295009792) ã‚’è¾æ›¸ä»£ã‚ã‚Šã«å¿…æ­»ã«èª¿ã¹ãªãŒã‚‰ãªã‚“ã¨ã‹ãªæ—¢ã«ã‚ã‚‹yamlãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã£ã½ã„ã“ã¨ãŒã§ãã‚‹ã€‚ã€ãã‚‰ã„ã§ã™ã€‚  \n  \n  \napi-serverãŒã‚ã‚Šã€etcdã¨ã„ã†æ°¸ç¶šåŒ–å±¤ãŒã‚ã‚Šã€kubectlã™ã‚‹ã¨api-serverãŒå©ã‹ã‚Œã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã¯ãªã‚“ã¨ãªãçŸ¥ã£ã¦ã„ã‚‹ãŒå®Ÿæ…‹ã¨ã—ã¦ã©ã®ã‚ˆã†ã«podãŸã¡ãŒç®¡ç†ã—ã¦ã„ã‚‹ã‹ã¯ã‚ã¾ã‚Šã‚ã‹ã£ã¦ã„ãªã„ã¨ã„ã†çŠ¶æ³ã§ã—ãŸã€‚  \n  \n  \nä»Šæ€ã†ã¨ã€æ–°å’ã«ãªã£ã¦è²·ã£ãŸæŠ€è¡“æ›¸ã®ä¸­ã§æœ€ã‚‚[Kuberneteså®Œå…¨ã‚¬ã‚¤ãƒ‰](https://www.amazon.co.jp/Kubernetes%E5%AE%8C%E5%85%A8%E3%82%AC%E3%82%A4%E3%83%89-%E7%AC%AC2%E7%89%88-Top-Gear-%E9%9D%92%E5%B1%B1/dp/4295009792) ã‚’é–‹ã„ã¦ã„ã‚‹å›æ•°ãŒå¤šã„æ°—ãŒã™ã‚‹ï¼ˆé–‹ã„ã¦ã„ã‚‹å›æ•°ã¯å¤šã„ãŒé€šèª­ã—ã¦ç†è§£ã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ğŸ¤ªï¼‰  \n  \n  \n## Kubernetes Operatorã¨ã¯   \n  \n  \nkubernetesãŒæŒã¤åˆ¶å¾¡ãƒ«ãƒ¼ãƒ—ã¨ã„ã†ä»•çµ„ã¿ã‚’ä½¿ã£ãŸæ‹¡å¼µæ©Ÿèƒ½ã€‚å…¬å¼Docã®[Operator Pattern](https://kubernetes.io/ja/docs/concepts/extend-kubernetes/operator/)ã®éƒ¨åˆ†ã«èª¬æ˜ãŒã‚ã‚‹ã€‚  \n  \n\n### åˆ¶å¾¡ãƒ«ãƒ¼ãƒ— (Control Loop, Reconcile Loopã¨ã‚‚å‘¼ã°ã‚Œã‚‹)  \n  \n  \nå¸¸ã«åˆ¶å¾¡ã®å¯¾è±¡ã¨ãªã‚‹ã‚‚ã®ã‚’ç›£è¦–ã—ã€ç†æƒ³çŠ¶æ…‹ã«è¿‘ã¥ã‘ã‚‹ä»•çµ„ã¿ã€‚  \n  \n- Kubernetes Controllerå†…ã§ä½¿ã‚ã‚Œã‚‹ä»•çµ„ã¿ã€‚ï¼ˆKubernetes Controllerã¯ãƒªã‚½ãƒ¼ã‚¹ã‚’ç›£è¦–ã—ã¦ã€ç™»éŒ²ã•ã‚ŒãŸç†æƒ³çŠ¶æ…‹ã«è¿‘ã¥ã‘ã‚‹è²¬å‹™ã‚’æŒã£ã¦ã„ã‚‹ã€‚ [https://kubernetes.io/ja/docs/concepts/architecture/controller/](https://kubernetes.io/ja/docs/concepts/architecture/controller/)ï¼‰  \n- ã€Œç›£è¦– â†’ åˆ†æ â†’ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’ç¹°ã‚Šè¿”ã—ã€ç¾å®ŸçŠ¶æ…‹ï¼ˆActual State, Current Stateï¼‰ã‚’ç†æƒ³çŠ¶æ…‹ï¼ˆDesired Stateï¼‰ã«è¿‘ã¥ã‘ã‚‹  \n- ãƒ­ãƒœãƒƒãƒˆå·¥å­¦ã‚„ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ†é‡ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹  \n  \n### Controllerã¨ã¯  \n  \n- Controllerã¯Controller Managerã®ä¸­ã«æŸã­ã‚‰ã‚Œã¦ã„ã‚‹  \n- Controllerã¯ä¸€ã¤ä»¥ä¸Šã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ç›£è¦–  \n- Controllerã¯ç†æƒ³çŠ¶æ…‹ã¨ç¾å®ŸçŠ¶æ…‹ã‚’è¿‘ã¥ã‘ã‚‹è²¬å‹™ã‚’æŒã¤  \n- ç†æƒ³çŠ¶æ…‹: API serverã‹ã‚‰å–å¾—ã—ãŸKubernetesã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®specãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰  \n- ç¾å®ŸçŠ¶æ…‹: API serverã‹ã‚‰å–å¾—ã§ãã‚‹å®Ÿéš›ã®çŠ¶æ…‹  \n  \nKubernetesã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã‘ã‚‹Controller Manager(c-m)ã®ç«‹ã¡ä½ç½®ã‚’ä»¥ä¸‹ã§å‚è€ƒã«ã§ãã¾ã™ã€‚etcdã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ç†æƒ³çŠ¶æ…‹ã«é–¢ã™ã‚‹æƒ…å ±ã‚„ã€å®Ÿéš›ã®Nodeã®æƒ…å ±ã‚’API serverã‚’é€šã˜ã¦å–å¾—ã—ã¦ã„ã‚‹ã€‚  \n  \n![alt text](images/create-kubernetes-operator/components.png)\n  \nå‡ºå±•: [https://kubernetes.io/docs/concepts/overview/components/](https://kubernetes.io/docs/concepts/overview/components/)  \n  \n\nbuild-in controller: Controller Managerã®ä¸­ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å«ã¾ã‚Œã¦ã„ã‚‹Controllerã€‚Deployment, ReplicaSet, Podãªã©ã®build-in Resourceã‚’ç®¡ç†ã—ã¦ã„ã‚‹  \n  \n  \n### kubectlã®å†…éƒ¨ã®å‹•ã  \n  \n1. kuectlã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹  \n`kubectl create deploy  test â€”image=nginx â€”replicas=1`  \n2. ã‚³ãƒãƒ³ãƒ‰ã‚’API serverã«å¯¾ã™ã‚‹POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¤‰æ›ã™ã‚‹  \n`POST apis/apps/v1/namaspaces/default/deployments`  \n3. API serverãŒdeploymentã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã€etcdã«ä¿å­˜ã™ã‚‹ï¼ˆAPI serverè‡ªä½“ã¯ä¿å­˜ã™ã‚‹ã ã‘ã§ReplicaSetã®èµ·å‹•ç­‰ã€ãã®å…ˆã®å‹•ä½œã‚’è¡Œã‚ãªã„ï¼‰  \n4. Deployment Controllerã®åˆ¶å¾¡ãƒ«ãƒ¼ãƒ—ã«ã‚ˆã‚Šã€æ–°ãŸã«deploymentã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œæˆã•ã‚ŒãŸã“ã¨ã‚’æ¤œçŸ¥ã—ã€Deployment ControllerãŒæ–°ãŸãªdeploymentã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å¯¾ã™ã‚‹ReplicaSetã‚’ä½œæˆã™ã‚‹  \n5. ReplicaSet Controllerã®åˆ¶å¾¡ãƒ«ãƒ¼ãƒ—ã«ã‚ˆã‚Šã€æ–°ãŸã«replicaSetã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œæˆã•ã‚ŒãŸã“ã¨ã‚’æ¤œçŸ¥ã—ã€ReplicaSet ControllerãŒæ–°ãŸãªreplicaSetã«å¯¾ã™ã‚‹Podã‚’ä½œæˆã™ã‚‹  \n  \n### Kubernetes Operatorã¨ã¯ï¼ˆçµè«–ï¼‰  \n  \n  \nCustom Resourceã¨Custom Controllerã‚’è‡ªåˆ†ã§ä½œæˆã—ã€Kuberneteã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã«å‰‡ã£ã¦è‡ªåˆ†ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿç¾ã™ã‚‹æ‹¡å¼µæ©Ÿèƒ½ã€‚ä»¥ä¸‹ã®2 stepã§ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚  \n  \n1. APIã®æ‹¡å¼µ: Custom Resourceã®å®šç¾©ãƒ»è¿½åŠ ï¼ˆã“ã“ã§ä½œæˆã™ã‚‹Custom Resource Definitionã¯CRDã¨ç•¥ã•ã‚Œã‚‹ï¼‰  \n2. åˆ¶å¾¡ãƒ«ãƒ¼ãƒ—ã®è¿½åŠ : Custom Controllerã®è¿½åŠ   \n  \n### Operator Hub  \n  \n  \n[https://operatorhub.io/](https://operatorhub.io/)  \n  \n  \næ§˜ã€…ãªKubernetes OperatorãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã€‚[**prometheus operator**](https://github.com/prometheus-operator/prometheus-operator/tree/main)ç­‰ã€çš†ã•ã‚“ãŒã‚ˆããŠä¸–è©±ã«ãªã£ã¦ã„ã‚‹Operatorã«ã¤ã„ã¦ãŠèª¿ã¹ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚  \n  \n  \n### Kubernetes Operatorã‚’ä½¿ã†æ‰‹é †  \n  \n  \nCDRã¨Custom Controllerã®deployã‚’ã™ã‚‹ã“ã¨ã§Kubernetes OperatorãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚  \n  \n  \nKubernetes Operatorã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹ã¯ä»¥ä¸‹ã€‚  \n  \n- CosutmResorceDefinition  \n- Deployment(Controllerã¯Deplymentã§å®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„)  \n- Controllerã¸å¿…è¦ãªæ¨©é™ã‚’ä¸ãˆã‚‹ãŸã‚ã®ãƒªã‚½ãƒ¼ã‚¹ï¼ˆRBACï¼‰ã€‚ServiceAccount, Role(Cluster Role), RoleBiding(Cluster RoleBiding)  \n  \n## ç°¡å˜ãªKubernetes Operatorã‚’ä½œã£ã¦ã¿ã‚‹  \n  \n  \n### Custom Resourceã‚’ä½œæˆã™ã‚‹  \n  \n  \nsample.crd.yaml  \n  \n  \n```yaml  \napiVersion: apiextensions.k8s.io/v1  \nkind: CustomResourceDefinition  \nmetadata:  \n  name: samples.example.com # <names.plural>.<group>  \nspec:  \n  group: example.com  \n  names:  \n    kind: Sample  \n    plural: samples  \n  scope: Namespaced  \n  versions:  \n    - name: v1alpha1  \n      served: true  \n      storage: true  \n      additionalPrinterColumns:  \n        - name: Test String  \n          jsonPath: .testString  \n          type: string  \n      schema:  \n        openAPIV3Schema:  \n          type: object  \n          properties:  \n            testString:  \n              type: string  \n  \n```  \n  \n  \nsample.yaml  \n  \n  \n```yaml  \napiVersion: example.com/v1alpha1  \nkind: Sample  \nmetadata:  \n  name: sample-resource-1  \ntestString: \"first sample resource\"  \n```  \n  \n  \n`Sample` crdã‚’ä½œæˆã—ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹  \n  \n  \n```shell  \nâ¯ kubectl apply -f sample.crd.yaml  \ncustomresourcedefinition.apiextensions.k8s.io/samples.example.com created  \n  \nâ¯ kubectl get crd                   \nNAME                  CREATED AT  \nsamples.example.com   2024-12-16T13:30:40Z  \n  \nâ¯ kubectl apply -f sample.yaml      \nsample.example.com/sample-resource-1 created  \n  \nâ¯ kubectl get samples     \nNAME                TEST STRING  \nsample-resource-1   first sample resource  \n  \nâ¯ kubectl get samples sample-resource-1 -o yaml  \napiVersion: example.com/v1alpha1  \nkind: Sample  \nmetadata:  \n  annotations:  \n    kubectl.kubernetes.io/last-applied-configuration: |  \n      {\"apiVersion\":\"example.com/v1alpha1\",\"kind\":\"Sample\",\"metadata\":{\"annotations\":{},\"name\":\"sample-resource-1\",\"namespace\":\"default\"},\"testString\":\"first sample resource\"}  \n  creationTimestamp: \"2024-12-16T13:30:49Z\"  \n  generation: 1  \n  name: sample-resource-1  \n  namespace: default  \n  resourceVersion: \"14316\"  \n  uid: a5e9cc5c-b53f-4199-8799-8f6c360b9d30  \ntestString: first sample resource  \n```  \n  \n  \n### Custom Controllerã‚’ä½œæˆã™ã‚‹  \n  \n  \nç°¡å˜ãªControllerã®ãŸã‚ã€1ç§’ã«ä¸€å›åˆ¶å¾¡ãƒ«ãƒ¼ãƒ—ã‚’å®Ÿè¡Œã—ã€custom resourceã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã ã‘ã‚’æŒã¡ã¾ã™ã€‚  \n  \n  \n```shell  \npackage main  \n  \nimport (  \n\t\"context\"  \n\t\"encoding/json\"  \n\t\"flag\"  \n\t\"fmt\"  \n\t\"path/filepath\"  \n\t\"time\"  \n  \n\tmetav1 \"k8s.io/apimachinery/pkg/apis/meta/v1\"  \n\t\"k8s.io/apimachinery/pkg/runtime/schema\"  \n\t\"k8s.io/client-go/dynamic\"  \n\t\"k8s.io/client-go/tools/clientcmd\"  \n\t\"k8s.io/client-go/util/homedir\"  \n)  \n  \nvar gvr = schema.GroupVersionResource{  \n\tGroup:    \"example.com\",  \n\tVersion:  \"v1alpha1\",  \n\tResource: \"samples\",  \n}  \n  \ntype Sample struct {  \n\tmetav1.TypeMeta   `json:\",inline\"`  \n\tmetav1.ObjectMeta `json:\"metadata,omitempty\"`  \n  \n\tTestString string `json:\"testString\"`  \n}  \n  \ntype SampleList struct {  \n\tmetav1.TypeMeta `json:\",inline\"`  \n\tmetav1.ListMeta `json:\"metadata,omitempty\"`  \n  \n\tItems []Sample `json:\"items\"`  \n}  \n  \nfunc listSamples(client dynamic.Interface, namespace string) (*SampleList, error) {  \n\tlist, err := client.Resource(gvr).Namespace(namespace).List(context.Background(), metav1.ListOptions{})  \n\tif err != nil {  \n\t\treturn nil, err  \n\t}  \n  \n\tdata, err := list.MarshalJSON()  \n\tif err != nil {  \n\t\treturn nil, err  \n\t}  \n  \n\tvar sampleList SampleList  \n\tif err := json.Unmarshal(data, &sampleList); err != nil {  \n\t\treturn nil, err  \n\t}  \n\treturn &sampleList, nil  \n}  \n  \nfunc main() {  \n\tvar defaultKubeConfigPath string  \n\tif home := homedir.HomeDir(); home != \"\" {  \n\t\t// build kubeconfig path from $HOME dir  \n\t\tdefaultKubeConfigPath = filepath.Join(home, \".kube\", \"config\")  \n\t}  \n  \n\tkubeconfig := flag.String(\"kubeconfig\", defaultKubeConfigPath, \"kubeconfig config file\")  \n\tflag.Parse()  \n  \n\tconfig, _ := clientcmd.BuildConfigFromFlags(\"\", *kubeconfig)  \n  \n\tclient, _ := dynamic.NewForConfig(config)  \n  \n\tfor {  \n\t\tsamples, _ := listSamples(client, \"\")  \n\t\tfor i, sample := range samples.Items {  \n\t\t\tnamespace := sample.GetNamespace()  \n\t\t\tname := sample.GetName()  \n\t\t\tfmt.Printf(\"%d\\t%s\\t%s\\n\", i, namespace, name)  \n\t\t}  \n\t\ttime.Sleep(1 * time.Second)  \n\t}  \n}  \n  \n  \n```  \n  \n  \n### Next Action  \n  \n  \nä»Šå›ä½œæˆã—ãŸKubernetes Operatorã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªèª²é¡ŒãŒã‚ã‚Šã¾ã™ã€‚  \n  \n- custom resoruceã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚ŒãŸå ´åˆã«å®Ÿæ–½ã™ã‚‹ã€podä½œæˆãªã©ã®ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ãŒå­˜åœ¨ã—ãªã„ã€‚  \n- Forãƒ«ãƒ¼ãƒ—ã¯API serverã¸ã®è² è·ã¨ãªã£ã¦ã—ã¾ã†  \n- CRDã¨main.goå†…ã§å®šç¾©ã—ãŸSample structã®æ•´åˆæ€§æ‹…ä¿ãŒã§ãã¦ã„ãªã„  \n- Fieldã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚„ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒãªã„  \n- Testã‚³ãƒ¼ãƒ‰ãŒãªã„  \n- Kubernetesã‚¯ãƒ©ã‚¹ã‚¿ä¸Šã§å‹•ã‹ã™ãŸã‚ã«ã¯ã€API Serverã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ç®¡ç†ï¼ˆRBACï¼‰ã®è€ƒæ…®ãŒå¿…è¦  \n- â€¦  \n  \nâ‡’ ã“ã‚Œã‚‰ã¯å…¨ã¦ã®Kubernetes Operatorã‚’ä½œã‚‹éš›ã®å…±é€šã®èª²é¡Œãªã®ã§ã€è§£æ±ºã®ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚â‡’ [**kubebuilder**](https://github.com/kubernetes-sigs/kubebuilder)**ãªã©ã‚’åˆ©ç”¨ã—ãŸæœ¬æ ¼çš„ãªKubernetes Operatorä½œæˆãŒå§‹ã¾ã‚‹ã€‚**  \n  \n  \n## ã¾ã¨ã‚  \n  \n  \nãªã‚“ã¨ãªãkubernetesã®ä¸–ç•Œè¦³ãŒã‚ã‹ã£ã¦ãã¾ã—ãŸã€‚ä»Šã®ã¨ã“ã‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæœ¬æ¥­ãªã®ã§ã“ã‚Œä»¥ä¸Šã¯ä¸€æ—¦è¸ã¿è¾¼ã‚ãªã„ãªã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚æ¥­å‹™ã§ã‚ˆãåˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹ [prometheus](https://github.com/prometheus-operator/prometheus-operator)ã‚„[argo-rollouts](https://argo-rollouts.readthedocs.io/)ãªã©ã®kubernetes operatorã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç­‰ãŒèª­ã¿ã‚„ã™ããªã£ãŸã®ãŒã¨ã¦ã‚‚è‰¯ã„ãªã¨æ€ã„ã¾ã™ã€‚  \n  \n  \n### å‚è€ƒ  \n  \n- [**ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³**](https://kubernetes.io/ja/docs/concepts/extend-kubernetes/operator/)  \n- [**Kubernetes OperatorÂ è¶…å…¥é–€/Kubernetes_Operator_Introduction**](https://speakerdeck.com/oracle4engineer/kubernetes-operator-introduction)  \n- [**OSC2020 Online Fukuoka Kubernetes OperatorÂ Intuition**](https://speakerdeck.com/nwiizo/osc2020-online-fukuoka-kubernetes-operator-intuition)  \n- ä»¥ä¸‹ã®å‹•ç”»ã¯è¶…çµ¶ãŠã™ã™ã‚ã§ã™ã€‚æœ¬è¨˜äº‹ã‚‚ã“ã¡ã‚‰ã®å‹•ç”»ã®æµã‚Œã«æ²¿ã£ãŸå†…å®¹ã¨ãªã£ã¦ã„ã¾ã™m  \n  \n\t<Bookmark href=\"https://www.udemy.com/course/kubernetes-operator-basics/\" />\n  \n  \n\trepository: [https://github.com/nakamasato/kubernetes-operator-basics/tree/main](https://github.com/nakamasato/kubernetes-operator-basics/tree/main)  \n  \n","date":"2024-12-16T00:00:00.000Z"},{"slug":"exec-py-by-uv-on-github-actions","title":"uvã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã—ã¦ã„ã‚‹Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’github actionsã§å®Ÿè¡Œã™ã‚‹","tags":["tech","python","uv","GithubActions"],"content":"\n  \nuvã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã—ã¦ã„ã‚‹Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’GitHub Actionsã§å®Ÿè¡Œã™ã‚‹ç’°å¢ƒã‚’æ•´ãˆãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚  \n  \n  \nGithub Actionsã¯ç„¡æ–™ã§ã¡ã‚‡ã£ã¨ã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®šæœŸå®Ÿè¡Œã«ã¨ã¦ã‚‚ä¾¿åˆ©ãªã®ã§é‡å®ã—ã¦ã„ã¾ã™ã€‚  \n  \n  \nä»Šå›ã¯ChatGPT apiã‚’å®šæœŸçš„ã«å©ãã‚¿ã‚¹ã‚¯ã‚’æƒ³å®šã—ã¦ã€OpenAIã®API Keyã‚’Github Secretsã«æ ¼ç´ã—ã¦å‚ç…§ã™ã‚‹ã“ã¨ã‚ã¾ã§è§£èª¬ã—ã¾ã™ã€‚  \n  \n  \n## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦  \n  \nãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€   \n  \n  \n```shell  \n~/py-batch   \nâ¯ tree -L 1 -a  \n.  \nâ”œâ”€â”€ .python-version  \nâ”œâ”€â”€ .venv  \nâ”œâ”€â”€ main.py  \nâ”œâ”€â”€ pyproject.toml  \nâ””â”€â”€ uv.lock  \n```  \n  \n  \npyproject.toml  \n  \n  \n```shell  \n[project]  \nname = \"py-batch\"  \nversion = \"0.1.0\"  \nrequires-python = \">=3.9\"  \ndependencies = [  \n    \"langchain>=0.3.14\",  \n    \"openai>=1.59.6\",  \n]  \n  \n[dependency-groups]  \ndev = [  \n    \"transformers>=4.47.1\",  \n]  \n```  \n  \n  \nmain.py  \n  \n  \n```shell  \nimport os  \n  \nAPI_KEY = os.environ.get(\"API_KEY\")  \n  \nprint(\"Hello from github actions!\")  \n```  \n  \n  \n## åˆ©ç”¨ã™ã‚‹ setup ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ  \n  \n  \nuvã®é–‹ç™ºå…ƒã§ã‚ã‚‹Astralç¤¾ãŒä»¥ä¸‹ã§github actionsç”¨ã®setupã‚’æä¾›ã—ã¦ã„ã‚‹ã®ã§ã“ã¡ã‚‰ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚  \n  \n  \n[https://github.com/astral-sh/setup-uv](https://github.com/astral-sh/setup-uv)  \n  \n  \n## ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼yamlå…¨ä½“  \n  \n  \nã‚³ãƒ¼ãƒ‰å…¨ä½“ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚  \n  \n  \n```yaml  \nname: py-batch  \non:  \n  workflow_dispatch:  \non:  \n  schedule:  \n    - cron: \"0 0 * * *\" # æ¯æ—¥ 0æ™‚ ã«å®Ÿè¡Œ  \njobs:  \n  command:  \n    name: exec python script  \n    runs-on: ubuntu-latest  \n    steps:  \n      - name: Checkout  \n        uses: actions/checkout@v4  \n      - name: Install the latest version of uv  \n        uses: astral-sh/setup-uv@v5  \n        with:  \n          version: \"latest\"  \n      - name: run python script  \n        env:  \n          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}  \n        run: uv run main.py  \n```  \n  \n  \nactions/checkout stepã§ã‚³ãƒ¼ãƒ‰ã‚’cloneã—ã€ astral-sh/setup-uv stepã‚’å…¥ã‚Œã‚‹ã“ã¨ã§ç°¡å˜ã«uvç’°å¢ƒã‚’æ•´ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  \n  \n  \nastral-sh/setup-uv ã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€GitHub Actionsä¸Šã§pythonç’°å¢ƒã‚’æ•´ãˆã‚‹éš›ã«ã‚ˆãåˆ©ç”¨ã™ã‚‹ [actions/setup-python](https://github.com/actions/setup-python) ã‚’stepã«åŠ ãˆã‚‹å¿…è¦ã¯ãªã„ã‚ˆã†ã§ã™ã€‚  \nPythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¦ãŸã„å ´åˆã¯ã€uvã‚³ãƒãƒ³ãƒ‰çµŒç”±ã§æŒ‡å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚  \n  \n  \n```yaml  \n- name: Install the latest version of uv  \n  uses: astral-sh/setup-uv@v5  \n  with:  \n    enable-cache: true  \n- name: Install Python 3.12  \n  run: uv python install 3.12  \n```  \n  \n  \nç„¡äº‹å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸ  \n\n![alt text](images/exec-py-by-uv-on-github-actions/exec-py-console.png)\n  \n### æœ€å¾Œã«  \n  \n  \né›‘è«‡ã§ã™ãŒuvã®ç’°å¢ƒã‚’æ•´ãˆã¦ã„ã¦æ€ã£ãŸã“ã¨â†“  \n  \n<TweetEmbed url=\"https://x.com/soken_nowi/status/1877913565216284972\" />  \n  \n  \nä»¥ä¸‹ã®ã‚ˆã†ã«ã‚ã‚‹ã®ã§node.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã‘ã‚‹`npm install`çš„ãªstepã‚’è¸ã¾ãªãã¦è‰¯ã„ã®ã¯ä¾¿åˆ©ã ãªã¨  \n  \n  \n> When used in a project, the project environment will be created and updated before invoking the command.  \n  \n  \n[https://docs.astral.sh/uv/reference/cli/#uv-run](https://docs.astral.sh/uv/reference/cli/#uv-run)  \n  \n","date":"2025-01-11T00:00:00.000Z"},{"slug":"ir-system-book","title":"ã€èª­æ›¸æ„Ÿæƒ³ã€‘ã€æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ  â€• å®Ÿå‹™è€…ã®ãŸã‚ã®é–‹ç™ºæ”¹å–„ã‚¬ã‚¤ãƒ‰ãƒ–ãƒƒã‚¯ã€ãƒ¡ãƒ¢ã€æ„Ÿæƒ³","tags":["bookreview","tech"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \n# ã¯ã˜ã‚ã«  \n  \n  \næ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ç¾ä»£ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒ“ã‚¹ã«ãŠã„ã¦ä¸å¯æ¬ ãªè¦ç´ ã§ã™ã€‚SNSã‚„ECã‚µã‚¤ãƒˆã‚’ã¯ã˜ã‚ã€å¤§éƒ¨åˆ†ã®webã‚µãƒ¼ãƒ“ã‚¹ã«ã¯æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ãŒå®Ÿè£…ã•ã‚Œã¦ãŠã‚Šã€åŠ¹ç‡çš„ãªæ¤œç´¢ä½“é¨“ã‚’æä¾›ã™ã‚‹ã“ã¨ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æº€è¶³åº¦ã‚„åˆ©ä¾¿æ€§ã«ç›´çµã—ã¾ã™ã€‚  \n  \n  \nä»Šå›ã¯ã€ã€æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ  â€• å®Ÿå‹™è€…ã®ãŸã‚ã®é–‹ç™ºæ”¹å–„ã‚¬ã‚¤ãƒ‰ãƒ–ãƒƒã‚¯ã€ã‚’èª­ã¿ã€ãã®å†…å®¹ã‚’ã¾ã¨ã‚ã€ç§ãŒæ„Ÿã˜ãŸã“ã¨ã‚’å…±æœ‰ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚æœ¬æ›¸ã¯å®Ÿå‹™ã«å³ã—ãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã€æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã®è¨­è¨ˆã‚„æ”¹å–„æ–¹æ³•ã«ã¤ã„ã¦è§£èª¬ã—ã¦ãŠã‚Šã€é–‹ç™ºè€…ç›®ç·šã§ã¨ã¦ã‚‚æœ‰ç›Šãªå†…å®¹ãŒè©°ã¾ã£ã¦ã„ã¾ã™ã€‚  \n\n<Bookmark href=\"https://amzn.to/4gXQrfD\" />\n  \n# èª­æ›¸æ™‚ã®ãƒ¡ãƒ¢  \n  \n  \n## ç¬¬1ç«  ã‚¤ãƒ³ãƒˆãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³  \n  \n  \nRDBã¸ã®ã‚¯ã‚¨ãƒªã‚’ãã®ã¾ã¾æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ä½¿ãŠã†ã¨ã™ã‚‹ã¨ç”Ÿã˜ã‚‹ã€Œã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®è¡¨è¨˜æºã€ã€ã€Œãƒ©ãƒ³ã‚­ãƒ³ã‚°ã€ã€ã€Œãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã€ã€ã€Œãƒ•ãƒ¬ãƒ¼ã‚ºæ¤œç´¢ã€ã«ã¤ã„ã¦è§¦ã‚Œã€å…¨æ–‡æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®å°å…¥ã¨ãªã‚‹ç« ã€‚  \n  \n  \n**æ¤œç´¢ã®æ–¹å¼**  \n  \n- é€æ¬¡æ–¹å¼: æ¤œç´¢å¯¾è±¡ã‹ã‚‰æ–‡å­—åˆ—ã®ãƒãƒƒãƒãƒ³ã‚°ã§ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æ¢ã—å‡ºã™å˜ç´”ãªæ‰‹æ³•ã€‚unixã®grepã¯é€æ¬¡æ–¹å¼ã®æ¤œç´¢ã€‚  \n- ç‰½å¼•æ–¹å¼: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹æ®µéšã§ã€Œã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã”ã¨ã«å¯¾è±¡ã¨ãªã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä¸¦ã¹ãŸå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã€ã‚’ç‰½å¼•ã¨ã—ã¦ç”¨æ„ã—ã€ï¼ˆã“ã®ç‰½å¼•ã‚’**è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**ã¨å‘¼ã¶ï¼‰è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ©ç”¨ã—ã¦é«˜é€Ÿã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¢ã™æ‰‹æ³•  \n  \n<u>è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®ä¸€ã¤ã€‚è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ ¼ç´ã—ã¦ã€ã‚¯ã‚¨ãƒªã§å•ã„åˆã‚ã›ã‚‹ã¨ã„ã†æ€§è³ªä¸Šã€æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¸€ç¨®ã¨è¨€ãˆã‚‹ã€‚</u>  \n  \n  \n**æ¤œç´¢æ©Ÿèƒ½ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨**  \n  \n- ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã«ã©ã®ã‚ˆã†ã«æ ¼ç´ã™ã‚‹ã‹ï¼ˆ**ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒªãƒ³ã‚°**ã‚„**ã‚¤ãƒ³ãƒ‡ã‚¯ã‚·ãƒ³ã‚°ï¼‰**  \n- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¤œç´¢æ©Ÿèƒ½ã‚’ã©ã®ã‚ˆã†ã«ä½¿ã£ã¦ã‚‚ã‚‰ã†ã‹ï¼ˆ**UI/UX**ã‚„**æ¤œç´¢ã‚’æ”¯æ´ã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½**ï¼‰  \n- æ¤œç´¢æ©Ÿèƒ½ã«é–¢ä¿‚ã™ã‚‹å¤šæ§˜ãªè¦ç´ ã‚’ã©ã†ã‚„ã£ã¦ç®¡ç†ã—ã¦ã„ãã‹ï¼ˆ**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ**ï¼‰  \n  \nã•ã‚‰ã«ã€æ¤œç´¢ã®æ­´å²ã¨æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã®å…¨ä½“åƒã¨æ§‹æˆè¦ç´ ã«ã¤ã„ã¦å‰è§¦ã‚ŒãŒã‚ã‚‹ã€‚  \næ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹æˆè¦ç´ ã¨ã—ã¦ä»¥ä¸‹ãŒç´¹ä»‹ã•ã‚Œã‚‹ã€‚  \n  \n- **æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³**  \n- **ã‚¤ãƒ³ãƒ‡ã‚¯ã‚µ**: æ¤œç´¢å¯¾è±¡ã®ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã€é©åˆ‡ãªå½¢å¼ã¸ã®åŠ å·¥ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¸ã®ç™»éŒ²ã‚’æ‹…ã†  \n- **ã‚¯ã‚¨ãƒªãƒ—ãƒ­ã‚»ãƒƒã‚µ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦å…¥åŠ›ã•ã‚ŒãŸã‚¯ã‚¨ãƒªã®å‰å‡¦ç†ã‚’è¡Œã†  \n- **ã‚¯ã‚¨ãƒªãƒã‚¹ãƒˆãƒ—ãƒ­ã‚»ãƒƒã‚µ**: æ¤œç´¢çµæœã®å¾ŒåŠ å·¥ã‚’è¡Œã†  \n- **ã€Œãƒ‡ãƒ¼ã‚¿æ´»ç”¨åŸºç›¤ã€ãŠã‚ˆã³ã€Œé©åˆæ€§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ï¼ˆRelevance Controllerï¼‰ã€**: ã‚ˆã‚Šè‰¯ã„æ¤œç´¢ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã€æ¤œç´¢çµæœã«å¯¾ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã€ã‚µãƒ¼ãƒ“ã‚¹æä¾›å´ã®ãƒ‹ãƒ¼ã‚ºã«åŸºã¥ã„ã¦æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã‚’æœ€é©åŒ–ã™ã‚‹ä»•çµ„ã¿  \n  \nï¼ˆå¯èƒ½ãªã‚‰ã°ã“ã“ã«å›³ã‚’ç½®ããŸã„ï¼‰  \n  \n  \n2ç« ã‹ã‚‰ç¶šãã„ãã¤ã‹ã®ç« ã¯ã€Œç¾ä»£ã®æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ãŒã©ã®ã‚ˆã†ãªèª²é¡Œã‚’æ„è­˜ã—ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹ã€ã‚’è§£èª¬ã™ã‚‹ç« ã¨ãªã‚‹ã€‚  \n  \n  \n## ç¬¬2ç«  æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®ä»•çµ„ã¿  \n  \n  \nä¸»é¡Œ: ã€Œãã‚‚ãã‚‚å…¨æ–‡æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ãŒã©ã®ã‚ˆã†ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãªã®ã‹ã€ç‰¹ã«å…¨æ–‡æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨ã—ã¦æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã¦ã„ã‚‹**è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**ã‚’åˆ©ç”¨ã—ãŸæ¤œç´¢ã®å¤§ã¾ã‹ãªãƒ•ãƒ­ãƒ¼ã‚’è§£èª¬ã€  \n  \n  \n### è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã¯  \n  \n  \nå‰æã¨ã—ã¦ã€é€æ¬¡æ¤œç´¢ã§ã¯å®Ÿç¾ã®é›£ã—ã„è¦ä»¶ã‚’æ•´ç†ã™ã‚‹  \n  \n- å¤§è¦æ¨¡ãƒ†ã‚­ã‚¹ãƒˆã‚’é«˜é€Ÿã«æ¤œç´¢ã™ã‚‹  \n- ãƒ•ãƒ¬ãƒ¼ã‚ºæ¤œç´¢ã‚’è¡Œã†ï¼ˆã‚ã‚‹å˜èªã¨ã‚ã‚‹å˜èªãŒéš£ã‚Šåˆã†ã‹ã€ã¾ãŸã¯è¿‘ãã«å‡ºç¾ã™ã‚‹ã‹ã®ã‚ˆã†ãªãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œç´¢ï¼‰  \n- æ¤œç´¢çµæœã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’ä»˜ã‘ãŸã„  \n  \nã“ã‚Œã‚‰ã‚’å®Ÿç¾ã™ã‚‹ä»•çµ„ã¿ã¨ã—ã¦è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ**inverted index**ï¼‰ãŒã‚ã‚‹ã€‚  \n  \n  \nãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç‰½å¼•èªã«åˆ†å‰²ã—ã€ç‰½å¼•èªã‚’è¡Œã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã‚’åˆ—ã¨ã—ã¦ã€ã€Œç‰½å¼•èªãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å‡ºç¾ã™ã‚Œã° 1 ã€å‡ºç¾ã—ãªã„å ´åˆã¯ 0ã€ã®ã‚ˆã†ãªè¡Œåˆ—ãŒæœ€ã‚‚ç°¡å˜ãªè»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€‚  \n  \n  \nã€ŒWebãƒšãƒ¼ã‚¸ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  PageRank ã¯ãƒ©ãƒªãƒ¼ãƒ»ãƒšã‚¤ã‚¸ã‚‰ã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚ŒãŸã€  \n  \n  \nâ†“ ç‰½å¼•èªã«åˆ†å‰²  \n  \n  \nã€ŒWeb / ãƒšãƒ¼ã‚¸ / ã® / ãƒ©ãƒ³ã‚­ãƒ³ã‚° / ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  / pagerank / ã¯ / ãƒ©ãƒªãƒ¼ / ãƒ» / ãƒšã‚¤ã‚¸/ ã‚‰ / ã«ã‚ˆã£ã¦ / é–‹ç™º / ã• / ã‚Œ / ãŸã€  \n  \n  \nï¼ˆç‰½å¼•å¾Œã®åˆ†å‰²æ–¹æ³•ã¯ç¬¬3ç« ã‚’å‚ç…§ã€‚å½¢æ…‹ç´ è§£æã‚„N-Gramãªã©ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ãŒä¸€èˆ¬çš„ã€‚ï¼‰  \n  \n  \n|        | **Doc1** | **Doc2** | **Doc3** |  \n| ------ | -------- | -------- | -------- |  \n| web    | 1        | 1        | 0        |  \n| æ¤œç´¢     | 1        | 1        | 1        |  \n| ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  | 1        | 0        | 1        |  \n| ã‚¨ãƒ³ã‚¸ãƒ³   | 1        | 1        | 1        |  \n  \n  \nã“ã®ã‚ˆã†ãªè¡Œåˆ—ã®è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ã‚‹ã¨ã€ç‰½å¼•èªã€Œwebã€ãŒå‡ºç¾ã—ã¤ã¤ã€ç‰½å¼•èªã€Œæ¤œç´¢ã€ã‚‚å‡ºç¾ã™ã‚‹ ANDæ¤œç´¢ã‚„ã€ã©ã¡ã‚‰ã‹ãŒå‡ºç¾ã™ã‚‹ ORæ¤œç´¢ã€å‡ºç¾ã—ãªã„ã“ã¨ã‚’æŒ‡å®šã™ã‚‹ NOT æ¤œç´¢ãŒå¯èƒ½ã«ãªã‚‹ï¼ˆæ¤œç´¢å‡¦ç†ã‚’é›†åˆæ¼”ç®—ã«è½ã¨ã—è¾¼ã‚ã‚‹ã¨ã„ã†ã“ã¨ã€‚ANDæ¤œç´¢ã€ORæ¤œç´¢ã€NOTæ¤œç´¢ã¯ã¾ã¨ã‚ã¦**ãƒ–ãƒ¼ãƒ«æ¤œç´¢ãƒ¢ãƒ‡ãƒ«**ã¨ã„ã†ã€‚ï¼‰  \n  \n  \nä¸Šã®ã‚ˆã†ãªã€Œç‰½å¼•èª-ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¡Œåˆ—ã€ã®è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã¯ã€å¤§è¦æ¨¡ãªãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ¼ãƒ‘ã‚¹ã§ã¯ã»ã¨ã‚“ã©ã®è¦ç´ ãŒ 0 ã«ãªã£ã¦ã—ã¾ã„ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãŒæ‚ªããªã‚‹ã€‚ãã®ãŸã‚ã€å®Ÿç”¨çš„ãªè»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦ã€**ã‚¿ãƒ¼ãƒ è¾æ›¸ï¼ˆterm dictionaryï¼‰**ã¨**ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆï¼ˆposting listï¼‰**ã‚’ç”¨ã„ãŸè»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒã‚ã‚‹ã€‚  \n  \n- **ã‚¿ãƒ¼ãƒ è¾æ›¸**: ã¯ç‰½å¼•èªã‚’keyã€ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã‚’valueã¨ã—ãŸãƒ‡ãƒ¼ã‚¿æ§‹é€ ã€‚  \n- **ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆ**: ãã®ç‰½å¼•èªãŒå‡ºç¾ã—ã¦ã„ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¨å‡ºç¾ä½ç½®ã®ãƒªã‚¹ãƒˆã€‚  \n  \n```typescript  \n{  \n \"web\" : [1:[3], 2:[1], 3:[6]],  \n \"æ¤œç´¢\" : [1:[4], 3:[1,7,10,16], 4:[14]]  \n}  \n```  \n  \n  \n### è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ãŸæ¤œç´¢  \n  \n1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¤œç´¢ã®ãŸã‚ã«å…¥åŠ›ã—ãŸæ–‡å­—åˆ—ï¼ˆæ¤œç´¢ã‚¯ã‚¨ãƒªï¼‰ã‚’ã‚¿ãƒ¼ãƒ ï¼ˆç‰½å¼•èªï¼‰ã«åˆ†å‰²ã™ã‚‹ï¼ˆ**ãƒ†ã‚­ã‚¹ãƒˆè§£æ**ï¼‰  \n2. ã‚¿ãƒ¼ãƒ è¾æ›¸ã‚’å¼•ãã€æ¤œç´¢å¯¾è±¡ã®ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã‚’è¦‹ã¤ã‘ã‚‹ï¼ˆ**è¾æ›¸å¼•ã**ï¼‰  \n3. ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã‚’å…ˆé ­ã‹ã‚‰èµ°æŸ»ã—ã¦ã¾ãƒ¼ã˜ï¼ˆ**ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆèµ°æŸ»**ï¼‰ ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆèµ°æŸ»ã®è©³ç´°ã«ã¤ã„ã¦ã¯ç¬¬4ç« ã‚’å‚ç…§  \n4. è¦‹ã¤ã‹ã£ãŸæ¤œç´¢çµæœã‚’ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã«ã—ã¦è¿”ã™ï¼ˆ**ãƒ©ãƒ³ã‚­ãƒ³ã‚°**ï¼‰  \n  \nã“ã®ä¸€é€£ã®æµã‚Œã¯ã‚¯ã‚¨ãƒªå‡¦ç†ï¼ˆquery processingï¼‰ã¨å‘¼ã¶ã€‚  \n  \n  \n### ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä»¥å¤–ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹  \n  \n  \nè»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ã¨ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å…¨æ–‡æ¤œç´¢ãŒè¡Œãˆã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ã—ã‹ã—ã€æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã§ã¯å…¨æ–‡æ¤œç´¢ã®ã¿ã§ã¯æˆã‚Šç«‹ãŸãšã€ãƒ†ã‚­ã‚¹ãƒˆä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿ã®æ¤œç´¢ã‚’çµ„ã¿åˆã‚ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  \n  \n  \ne.g.) ECã‚µã‚¤ãƒˆã®æ¤œç´¢ã§ã¯ã€å•†å“ã®ã‚«ãƒ†ã‚´ãƒªã‚„ä¾¡æ ¼ã«ã‚ˆã‚‹çµã‚Šè¾¼ã¿ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼‰ã‚„ã‚½ãƒ¼ãƒˆã€ãƒ•ã‚¡ã‚»ãƒƒãƒˆæ©Ÿèƒ½ï¼ˆ6ç« ã‚’å‚è€ƒï¼‰ã‚’çµ„ã¿åˆã‚ã›ãŸæ¤œç´¢ãŒå¿…é ˆ  \n  \n  \ne.g.) ãƒ›ãƒ†ãƒ«ã®ç©ºå®¤æ¤œç´¢ã§ã¯ã€äºˆç´„ã—ãŸã„æ—¥ä»˜ã«ã‚ˆã‚‹æ¤œç´¢ãŒå¿…é ˆ  \n  \n  \ne.g.) ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚„åº—èˆ—æ¤œç´¢ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åœ°ç†æƒ…å ±ã‚’è€ƒæ…®ã—ãŸæ¤œç´¢ã‚’å®Ÿç¾ã—ãŸã„  \n  \n  \n### ç„¡å„Ÿã§åˆ©ç”¨å¯èƒ½ãªæ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®ç´¹ä»‹  \n  \n- Apache Lucene  \nå˜ä½“ã§ã¯ã‚µãƒ¼ãƒãƒ¼ã¨ã—ã¦ã®æ©Ÿèƒ½ã‚’æŒãŸãªã„ãŸã‚ã€Apache Luceneã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸæ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã‚µãƒ¼ãƒãƒ¼ã§ã‚ã‚‹ã€Apache Solrã‚„Elasticsearch ã‚’ç”¨ã„ã‚‹ã“ã¨ãŒå¤šã„  \n- Vespa  \n- Groonga  \n  \nâ€» è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç‰¹å¾´  \n  \n- ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã§ã‚‚ãƒ‡ã‚£ã‚¹ã‚¯ãƒ™ãƒ¼ã‚¹ã§ã‚‚ã€ãã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒˆã§ã‚‚å‹•ä½œã™ã‚‹  \n- ä¸€å°ã®ãƒã‚·ãƒ¼ãƒ³ã§æ‰±ã„ãã‚Œãªã„å¤§è¦æ¨¡ãªãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†éš›ã«ã€æ°´å¹³åˆ†æ•£ã«ã‚ˆã‚Šã‚¹ã‚±ãƒ¼ãƒ«ã—ã‚„ã™ã„  \n  \n## ç¬¬3ç«  ãƒ†ã‚­ã‚¹ãƒˆè§£æ  \n  \n  \nä¸»é¡Œ:ã€Œå…¨æ–‡æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã«ãŠã„ã¦ãƒ†ã‚­ã‚¹ãƒˆãŒã©ã®ã‚ˆã†ã«æ‰±ã‚ã‚Œã‚‹ã‹ã€ã‚’æ‰±ã†  \n  \n  \nãƒ†ã‚­ã‚¹ãƒˆè§£èª¬ã¯å¤§ããªå‡¦ç†ã¨ã—ã¦è€ƒãˆã‚‹ã¨æ¬¡ã®ã‚ˆã†ãªæµã‚Œã«ãªã‚‹  \n  \n- æ–‡å­—ã®æ­£è¦åŒ–  \n- ãƒˆãƒ¼ã‚¯ãƒ³åŒ–  \n- ãƒˆãƒ¼ã‚¯ãƒ³åˆ—ã«å¯¾ã™ã‚‹å„ç¨®å‡¦ç†  \n  \nâ€» ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆç‰½å¼•èªï¼‰ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’æ§‹æˆã™ã‚‹åŸºæœ¬çš„ãªå˜èªã‚„è¨˜å·ã§ã‚ã‚Šã€ã‚¿ãƒ¼ãƒ ã¯æ¤œç´¢ã®ç›®çš„ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã•ã‚Œã‚‹ç‰¹å®šã®å˜èªã‚„ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’æŒ‡ã—ã¾ã™ã€‚  \n  \n  \nå¯¾è±¡ã¨ãªã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è¨€èªã«ã‚ˆã£ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã®æ±ºã‚æ–¹ã¯ç•°ãªã‚Šã€ãã‚Œãã‚Œã«å¯¾ã—ã¦ç‹¬è‡ªã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒç™ºå±•ã—ã¦ã„ã‚‹ã€‚  \n  \n  \n### æ—¥æœ¬èªã®ãƒ†ã‚­ã‚¹ãƒˆè§£æ  \n  \n  \næ—¥æœ¬èªã®ãƒ†ã‚­ã‚¹ãƒˆè§£æã«ã¯ä»¥ä¸‹ã®äºŒã¤ã®æ‰‹æ³•ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ãŒå¤šã„  \n  \n- **å½¢æ…‹ç´ è§£æå™¨ã‚’ç”¨ã„ãŸãƒ†ã‚­ã‚¹ãƒˆè§£æ**  \n  \næ—¥æœ¬èªã®æ–‡ç« ã‚’äººé–“ãŒèªè­˜ã§ãã‚‹å˜èªã¸ã¨åŒºåˆ‡ã‚‹æ‰‹æ³•ã€‚  \nOSS: [MeCab](https://taku910.github.io/mecab/)   \n  \n- **æ–‡å­—N-Gramã‚’ç”¨ã„ãŸãƒ†ã‚­ã‚¹ãƒˆè§£æ**  \n  \nN-Gramã§ã¯å…¥åŠ›ã•ã‚ŒãŸæ–‡ç« ã‚’Næ–‡å­—ãšã¤åˆ‡ã‚Šå‡ºã—ã¦åˆ‡ã‚Šå‡ºã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ã€‚  \n  \n  \nãã®ä»–ã€Unicodeæ­£è¦åŒ–ã€ã‚¹ãƒˆãƒƒãƒ—ãƒ¯ãƒ¼ãƒ‰ã€é¡ç¾©èªã®å±•é–‹ãªã©ã€æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®ç²¾åº¦ã‚’é«˜ã‚ã‚‹ãŸã‚ã®ãƒ†ã‚­ã‚¹ãƒˆè§£æã®å·¥å¤«ã†ãŒç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ã€‚  \n  \n  \n## ç¬¬4ç«  ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã®èµ°æŸ»ã¨ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ   \n  \n  \nä¸»é¡Œ: ã€Œè»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ã‚‰ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹éš›ã«ã©ã®ã‚ˆã†ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚„ãƒ­ã‚¸ãƒƒã‚¯ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ã€  \n  \n  \nã“ã‚Œã¾ã§ã®ç« ã§å…¨æ–‡æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®ä¸»ãªä»•çµ„ã¿ã¯ã€è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä¸Šã§ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¿ãƒ¼ãƒ ã®é›†åˆã¨ã—ã¦æ‰±ã„ã€ã‚¿ãƒ¼ãƒ é›†åˆã‹ã‚‰æ§‹ç¯‰ã—ãŸãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã‚’èµ°æŸ»ã™ã‚‹ã“ã¨ã§ç›®çš„ã®æ¤œç´¢çµæœã‚’å–å¾—ã™ã‚‹ã¨ã„ã†ã¨ã“ã‚ã¾ã§ã‚ã‹ã‚Šã¾ã—ãŸã€‚æœ¬ç« ã§ã¯ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆèµ°æŸ»ã¨ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¤ã„ã¦è§£èª¬ã•ã‚Œã¦ã„ã¾ã™ã€‚  \n  \n  \n### ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã®èµ°æŸ»  \n  \n  \nå›³ã§ã®è§£èª¬ãŒå¿…è¦ãªãŸã‚ã€ã¾ã¨ã‚ã‚‰ã‚Œãšã€‚  \n  \n  \n### ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’è€ƒæ…®ã—ãŸãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã®èµ°æŸ»  \n  \n  \nTF(term frequency)ã¨IDF(inverse document frequency)ã‚’è€ƒæ…®ã—ãªãŒã‚‰ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã‚’èµ°æŸ»ã™ã‚‹ã“ã¨ã§ã€èµ°æŸ»æ™‚ã®çµæœãŒé‡ã¿ä»˜ã‘ã•ã‚Œãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’è€ƒæ…®ã—ãŸçµæœã¨ãªã‚‹ã€‚  \n  \n  \n### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è©•ä¾¡  \n  \n  \næ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã„ã¦é‡è¦–ã•ã‚Œã‚‹ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ï¼ˆLatencyï¼‰ã¨ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆï¼ˆthroughputï¼‰  \n  \n  \nã‚¯ã‚¨ãƒªå‡¦ç†æ™‚ã¯ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã®ã¿ãŒé‡è¦è¦–ã•ã‚Œã€ã‚¤ãƒ³ãƒ‡ã‚¯ã‚·ãƒ³ã‚°æ™‚ã¯ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã¨ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã®ä¸¡æ–¹ãŒé‡è¦–ã•ã‚Œã‚‹ã€‚  \n  \n  \nã¾ãŸã€å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ãƒ‡ã‚£ã‚¹ã‚¯ I/O ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚„ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆãŒãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ä¸‹ã’ã‚‹å¤§ããªè¦å› ã«ãªã‚Šã†ã‚‹ãŸã‚ã€æ³¨æ„ãŒå¿…è¦ã€‚  \n  \n  \nã‚ˆã£ã¦ã€æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è©¦é¨“ã‚’å®Ÿæ–½ã™ã‚‹ã«å½“ãŸã£ã¦ã¯ä»¥ä¸‹é …ç›®ã‚’è¦‹ã‚‹ã®ãŒè‰¯ã„ã¨ã•ã‚Œã‚‹  \n  \n- ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·  \n- ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ  \n- CPUãŠã‚ˆã³ãƒ¡ãƒ¢ãƒªã®ä½¿ç”¨é‡  \n- ãƒ‡ã‚£ã‚¹ã‚¯ I/O ã®å›æ•°æ¸¬å®š  \n- ï¼ˆKubernetesç’°å¢ƒã§ã¯ï¼‰ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚„DNSåå‰è§£æ±ºãªã©ã®TCPé€šä¿¡  \n  \n### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®åˆ©ç”¨  \n  \n  \næ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³å†…ã«å®Ÿè£…ã•ã‚Œã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ç¨®é¡  \n  \n- æ¤œç´¢çµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥  \n- ã‚¯ã‚¨ãƒªé€”ä¸­çµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥  \nå…·ä½“çš„ã«ã¯ã€ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã®ç©é›†åˆã‚„çµã‚Šè¾¼ã¿æ¡ä»¶ã€ã‚½ãƒ¼ãƒˆæ¡ä»¶ãŒã‚­ãƒ£ãƒƒã‚·ãƒ¥å¯¾è±¡ã€‚  \n- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥  \nã‚¤ãƒ³ãƒ‡ã‚¯ã‚·ãƒ³ã‚°å…ƒã®ãƒ†ã‚­ã‚¹ãƒˆãã®ã‚‚ã®ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¿”å´ã™ã‚‹ã‚¹ãƒ‹ãƒšãƒƒãƒˆã®ç”Ÿæˆã‚’é«˜é€ŸåŒ–ã™ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥  \n- etcâ€¦  \n  \næ¤œç´¢çµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ’ãƒƒãƒˆç‡ãŒä½ã„ã“ã¨ãŒå¤šãã€ä¸è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰è¿½ã„å‡ºã™å‡¦ç†ï¼ˆevictionï¼‰ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡ã‚’ä¸Šå›ã‚‹ã“ã¨ãŒå¤šã„ã€‚**ã‚¯ã‚¨ãƒªã®ç‰¹æ€§ã«åˆã‚ã›ã¦æ…é‡ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã‚’é¸ã¶å¿…è¦ãŒã‚ã‚‹ã€‚**  \n  \n  \nã¾ãŸã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ãŒé‡è¦–ã•ã‚Œã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ããŠãã‚‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å°å…¥ã—ãªã„æ–¹ãŒè‰¯ã„å ´åˆã‚‚ã‚ã‚‹ã®ã§æ³¨æ„ã€‚  \n  \n  \nã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å°å…¥ã™ã‚‹å‰ã«**é…ã„ã‚¯ã‚¨ãƒªã‚’åˆ†æã™ã‚‹ã—ã¦ã‚¯ã‚¨ãƒªãã®ã‚‚ã®ã‚’æ”¹å–„ã§ããªã„ã‹ã‚’æ¤œè¨**ã™ã‚‹ã“ã¨ãŒé‡è¦ã€‚  \n  \n  \n### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å†—é•·åŒ–ã¨åˆ†æ•£æ¤œç´¢  \n  \n  \n1å°ã®æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã§ã¯æ‰±ã„ãã‚Œãªã„ã»ã©å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚„ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’æŒãå¿…è¦ãŒå‡ºã¦ããŸå ´åˆã€ä¸€éƒ¨ã§éšœå®³ãŒç™ºç”Ÿã—ãŸå ´åˆã§ã‚‚å‡¦ç†ã‚’ç¶™ç¶šã§ãã‚‹ã‚ˆã†ã‚·ã‚¹ãƒ†ãƒ ã¨ãƒ‡ãƒ¼ã‚¿ã‚’å†—é•·åŒ–ã—ã¦ãŠãå¿…è¦ãŒå‡ºã¦ãã¾ã™ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚·ãƒ£ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ¤œè¨ã§ãã‚‹ã€‚  \n  \n  \n## ç¬¬5ç«  æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã¸ã®ãƒ‡ãƒ¼ã‚¿ç™»éŒ²  \n  \n  \nä¸»é¡Œ: ã€Œè»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã®åˆ©ç”¨ã‚’å‰æã¨ã—ã¦ã€ãã‚‚ãã‚‚æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã«ç™»éŒ²ã™ã¹ããƒ‡ãƒ¼ã‚¿ã‚’ã©ã®ã‚ˆã†ãªæ‰‹æ®µã§æº–å‚™ã™ã‚Œã°ã„ã„ã‹ã€  \n  \n  \nECã®å ´åˆã€æ¤œç´¢çµæœã§1ä»¶ã¨ã—ã¦æ‰±ã„ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚’ã©ã®ã‚ˆã†ã«è€ƒãˆã‚‹ã‹  \n  \n- 1SKUï¼ˆStock Keeping Unitï¼‰ã§æ‰±ã†: Tã‚·ãƒ£ãƒ„ã®ã‚«ãƒ©ãƒ¼ãŒ3ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã‚µã‚¤ã‚ºãŒ3ç¨®é¡ã®åˆè¨ˆ9ç¨®é¡ã®Tã‚·ãƒ£ãƒ„ã‚’ãã‚Œãã‚Œ1ã¤ã¨ã—ã¦æ‰±ã„ã€9ä»¶ã‚’æ¤œç´¢çµæœã«ãƒ’ãƒƒãƒˆã•ã›ã‚‹  \n- ãã®Tã‚·ãƒ£ãƒ„å•†å“ã‚’1ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æ‰±ã†: æ¤œç´¢çµæœã®ä»¶æ•°ã¯SKUã®æ•°ã§ã¯ãªãã€1ä»¶ã®ã¿ã€‚ã‚µã‚¤ã‚ºã€ã‚«ãƒ©ãƒ¼ãªã©ã¯ãã®å•†å“ã®å±æ€§ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹  \n  \nä¸è¦ãªã‚‚ã®ã¯ç™»éŒ²ã—ãªã„  \n  \n- æ¤œç´¢çµæœã¨ã—ã¦ååˆ†ãªå“è³ªãŒãªã„ãƒ‡ãƒ¼ã‚¿  \n- ä½•å¹´é–“ã‚‚éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿  \n- æ¤œç´¢çµæœã«ä¸€å®šæœŸé–“è¡¨ç¤ºã•ã‚Œã¦ã„ãªã„ãƒ‡ãƒ¼ã‚¿  \n  \næ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°  \n  \n- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ : ECã‚µã‚¤ãƒˆã§åœ¨åº«ã®çŠ¶æ³ã‚’åæ˜ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯å¿…é ˆ  \n- ãƒãƒƒãƒæ›´æ–°  \n- æ‰‹å‹•æ›´æ–°  \n  \nãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã™ã‚‹åº¦ã«å†…éƒ¨ã§å°ã•ãªè»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ãŸã‚ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚ˆã‚Šãƒãƒƒãƒã®æ–¹ãŒæ¤œç´¢åŠ¹ç‡ãŒã‚ˆããªã‚‹å ´åˆãŒã‚ã‚‹ã€‚ã¾ãŸå‰Šé™¤æ“ä½œã‚‚ã€è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†…ã«åˆ©ç”¨ã•ã‚Œãªã„ãƒ‡ãƒ¼ã‚¿ãŒè“„ç©ã•ã‚Œã‚‹ãŸã‚ã€æ¤œç´¢åŠ¹ç‡ã¸ã®å½±éŸ¿ãŒå‡ºã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚  \n  \n  \nä»£è¡¨çš„ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹  \n  \n- ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ :  \n- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: SQLã‚’åˆ©ç”¨ã—ã¦åé›†ã€‚åŒæœŸçš„ or éåŒæœŸçš„ã«æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã«ãƒ‡ãƒ¼ã‚¿ã‚’åæ˜ ã•ã›ã‚‹ã‹ã®åˆ¤æ–­ãŒå¿…è¦ã€‚ã¾ãŸã€éæ­£è¦åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†å ´åˆã€ä¸€ã¤ã®ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚ŒãŸå ´åˆã«ãã‚Œã«é–¢é€£ã™ã‚‹ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã«åæ˜ ã•ã›ã‚‹éš›ã«æ³¨æ„ãŒå¿…è¦  \n- Web: ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã«ã‚ˆã‚‹åé›†ãªã©  \n  \nãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æŠ½å‡ºã«ã¯Apache TikaãŒè‰¯ã•ãã†ã€‚PDF, PowerPoint, Wordç­‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æŠ½å‡ºã—ã€Apache Solarç­‰ã®æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®è»¢ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦ç™»éŒ²ã™ã‚‹ä»•çµ„ã¿ãŒã™ã§ã«ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚  \n  \n  \n## ç¬¬6ç«  æ¤œç´¢ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨æ¤œç´¢ã‚¯ã‚¨ãƒªã®å‡¦ç†  \n  \n  \næ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å…¥åŠ›ã¯å¤§ããåˆ†ã‘ã¦ä»¥ä¸‹ã®äºŒã¤  \n  \n- æ¤œç´¢ã‚¯ã‚¨ãƒª: æ¤œç´¢ã—ãŸã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€æ¤œç´¢å¯¾è±¡ã¨ã™ã‚‹ã‚«ãƒ†ã‚´ãƒªãªã©ã®ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ã€ã‚½ãƒ¼ãƒˆæŒ‡ç¤ºãªã©  \n- ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¡Œå‹•å±¥æ­´ã€æ€§åˆ¥ã€å¹´é½¢ã€ç™»éŒ²æƒ…å ±ãªã©  \n  \næ¤œç´¢ã‚’ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ±‚ã‚ã‚‹æƒ…å ±ã‚’å¾—ã‚‹ãŸã‚ã®æ‰‹æ®µã€ã¨è€ƒãˆã‚‹ã¨ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚„ãƒ•ãƒ¬ãƒ¼ã‚ºã§ã®å…¨æ–‡æ¤œç´¢ã¯å¿…ãšã—ã‚‚æœ€é©ãªè§£æ±ºæ–¹æ³•ã§ã¯ãªã„ã€‚ECã‚µãƒ¼ãƒ“ã‚¹ã§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹éš›ã¯å…¨æ–‡æ¤œç´¢ã‚ˆã‚Šã‚‚ã‚«ãƒ†ã‚´ãƒªã«ã‚ˆã‚‹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®æ–¹ãŒæ¤œç´¢è¡Œå‹•ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹é‡è¦ãªæ©Ÿèƒ½ã§ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚  \n  \n  \n### ãƒ•ã‚¡ã‚»ãƒƒãƒˆ  \n  \n  \nãƒ•ã‚¡ã‚»ãƒƒãƒˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¤œç´¢ã‚¯ã‚¨ãƒªã‚’æ˜ç¢ºã«ã—ãŸã‚Šçµã‚Šè¾¼ã¿ã—ãŸå…¥ã§ãã‚‹ã‚ˆã†ã«ã€æ¤œç´¢çµæœã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦ã„ã‚‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆã—ã¦è¦–è¦šçš„ã«é¸æŠè‚¢ã‚’æç¤ºã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚  \n  \n  \nãƒ•ã‚¡ã‚»ãƒƒãƒˆã®å½¹å‰²ã®ä¸€ã¤ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¤œç´¢ã‚¯ã‚¨ãƒªã®ä½œæˆãŠã‚ˆã³ä¿®æ­£ã‚’ãƒŠãƒ“ã‚²ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦ãƒ•ã‚¡ã‚»ãƒƒãƒˆã§ç°¡å˜ãªçµã‚Šè¾¼ã¿ã®æ‰‹æ®µã‚’æä¾›ã™ã‚‹ã“ã¨ã§ã€å°‘æ•°ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰æ¤œç´¢ã‚’å§‹ã‚ã€å°‘ã—ãšã¤æ¤œç´¢æ¡ä»¶ã‚’çµã£ã¦ã„ãã¨ã„ã†æ¤œç´¢ä½“é¨“ã‚’æä¾›ã§ãã‚‹ã€‚  \n  \n  \nãƒ•ã‚¡ã‚»ãƒƒãƒˆã‚’å†æœ‰ã™ã‚‹å ´åˆã«ã¯ã€é¸æŠæ¸ˆã¿ã®é …ç›®ã‚’ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆã‚„ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¨ã—ã¦ãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã—ã¦ãŠãã“ã¨ã‚„ã€å„ãƒ•ã‚¡ã‚»ãƒƒãƒˆã®ãƒãƒƒãƒã™ã‚‹ä»¶æ•°ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã¨ã¦ã‚‚é‡è¦ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¬¡ã®è¡Œå‹•ã‚’åˆ¤æ–­ã™ã‚‹æŒ‡æ¨™ã¨ãªã‚‹ã€‚  \n  \n  \nãƒ•ã‚¡ã‚»ãƒƒãƒˆã§é›†è¨ˆã™ã‚‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æƒ…å ±è¦æ±‚ã‚’æ˜ç¢ºã«ã§ãã‚‹ã‚‚ã®ã€æ¤œç´¢åŠ¹ç‡ã‚’ä¸Šã’ã‚‹ã‚ˆã†ãªã‚‚ã®ã‚’æ…é‡ã«é¸ã¶å¿…è¦ãŒã‚ã‚‹ã€‚ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®é¸æŠã‚’èª¤ã‚‹ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ··ä¹±ã‚’æ‹›ãã“ã¨ã¨ãªã‚‹ã€‚  \n  \n  \nã“ã‚Œã‹ã‚‰å…ˆã¯å®Œå…¨ãƒã‚¿ãƒãƒ¬è¦ç´„ã¿ãŸã„ã«ãªã£ã¦ã—ã¾ã†ã®ã§ãƒ¡ãƒ¢ã‚‚å…¬é–‹ã—ã¾ã›ã‚“ã€‚ãœã²ä»¥ä¸‹ã§ãŠè²·ã„æ±‚ã‚ãã ã•ã„ã€‚  \n  \n\n<Bookmark href=\"https://www.lambdanote.com/products/ir-system\" />\n  \n## èªå½™  \n  \n- ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ¼ãƒ‘ã‚¹: æ¤œç´¢ã®å¯¾è±¡ã¨ãªã‚‹ãƒ†ã‚­ã‚¹ãƒˆã®é›†åˆ  \n- æ–‡ç« ã‚µãƒ­ã‚²ãƒ¼ãƒˆ: æ¤œç´¢çµæœã®ã‚¿ã‚¤ãƒˆãƒ«ã€è¦ç´„ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãªã©ã®æƒ…å ±ã®é›†åˆã€‚æ¤œç´¢çµæœãŒç›®çš„ã®æ–‡ç« ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ¤æ–­ã™ã‚‹ãŸã‚ã«ä½¿ã†æƒ…å ±ã€‚Googleæ¤œç´¢ã—ãŸã¨ãã«ã‚¿ã‚¤ãƒˆãƒ«å‘¨è¾ºã«å‡ºã‚‹æƒ…å ±ã€‚  \n- ã‚¹ãƒ©ãƒƒã‚·ãƒ³ã‚°ï¼ˆthrashingï¼‰: ã‚¹ãƒšãƒ«ãƒŸã‚¹ãªã©èª¤ã£ãŸæ¤œç´¢ã‚¯ã‚¨ãƒªã‚’è§£æ±ºã—ãªã„ã¾ã¾æ¤œç´¢ã‚’ç¹°ã‚Šè¿”ã™è¡Œå‹•ã€‚ã‚¹ãƒ©ãƒƒã‚·ãƒ³ã‚°ã®ç™ºç”Ÿã¯æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã‚ã‚Šã€ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã¯ã“ã‚Œã‚’é˜²æ­¢ã™ã‚‹é‡è¦ãªå½¹å‰²ãŒã‚ã‚‹  \n- ã‚¯ãƒªãƒƒã‚¯ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼: åŒã˜æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ãŸç•°ãªã‚‹æ¤œç´¢è€…ãŒæ¤œç´¢çµæœã‹ã‚‰é¸æŠã—ãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ•£ã‚‰ã°ã‚Šå…·åˆ  \n- ã‚¹ãƒˆãƒƒãƒ—ãƒ¯ãƒ¼ãƒ‰:  é »ç¹ã«ç¾ã‚Œã€ãƒ†ã‚­ã‚¹ãƒˆæ¤œç´¢å‡¦ç†ã«é–¢é€£ã™ã‚‹å†…å®¹ã‚’ ã‚‚ãŸãªã„ãƒ¯ãƒ¼ãƒ‰ã®ã“ã¨ã€‚è‹±èªã§ã¯ \"and\", \"or\",  \"in\" ãªã©ã§ã€æ—¥æœ¬èªã§ã¯ â€ã¦â€, â€œã«â€, â€œã‚’â€, â€œã¯â€ ãªã©ãŒã‚¹ãƒˆãƒƒãƒ—ãƒ¯ãƒ¼ãƒ‰ã«ã‚ãŸã‚‹ã€‚  \n  \n# æ„Ÿæƒ³  \n  \n  \nã€æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ  â€• å®Ÿå‹™è€…ã®ãŸã‚ã®é–‹ç™ºæ”¹å–„ã‚¬ã‚¤ãƒ‰ãƒ–ãƒƒã‚¯ã€ã¯ã€ç†è«–ã¨å®Ÿå‹™ã®ä¸¡æ–¹ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆãã‚«ãƒãƒ¼ã—ã¦ãŠã‚Šã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹éš›ã«éå¸¸ã«å½¹ç«‹ã¤å†…å®¹ãŒæº€è¼‰ã§ã—ãŸã€‚  \n  \n  \næœ¬è¨˜äº‹ã®ãƒ¡ãƒ¢ã§ã¯è¨€åŠã—ã¦ã„ã¾ã›ã‚“ãŒã€å¾ŒåŠéƒ¨åˆ†ã¯æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã‚„ã€æ¤œç´¢ã‚¯ã‚¨ãƒªã®å‡¦ç†ï¼ˆæ©Ÿæ¢°å­¦ç¿’ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚‚å«ã‚€ï¼‰ãªã©æ¤œç´¢ä½“é¨“å‘ä¸Šã®æ§˜ã€…ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚  \n  \n  \nã‚ˆã‚Šæ´—ç·´ã•ã‚ŒãŸæ¤œç´¢æ©Ÿèƒ½ã‚’æä¾›ã§ãã‚‹ã‚ˆã†ã€æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã«é–¢ã™ã‚‹ç†è§£ã‚’æ·±ã‚ãŸã„æ–¹ã«ã¯ã€ãœã²ä¸€èª­ã‚’ãŠå‹§ã‚ã—ã¾ã™ï¼  \n  \n  \nã¡ãªã¿ã«Qiitaã§100ã„ã„ã­è¿‘ãã§ãƒã‚ºã£ã¦ã„ã‚‹ä»¥ä¸‹è¨˜äº‹ã‚‚ã€~~å‡ºå…¸æ˜è¨˜ã•ã‚Œã¦ã„ã¾ã›ã‚“ãŒ~~ã€æ§‹æˆã‚„å…·ä½“ä¾‹ãŒä¸€è‡´ã—ã¦ã„ã‚‹ãŸã‚ã“ã¡ã‚‰ã®æœ¬ã®è¦ç´„ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚  \n  \n  \n<Bookmark href=\"https://qiita.com/k_yamaki/items/2bd2284a2ddee542ad4d\" />\n","date":"2024-10-06T00:00:00.000Z"},{"slug":"next-blog-summary","title":"ã»ã¼ç„¡æ–™ã§æ§‹ç¯‰ã—ãŸå€‹äººãƒ–ãƒ­ã‚°ã§1å††ç¨¼ãã“ã¨ã«æˆåŠŸã—ãŸã®ã§ã‚„ã£ãŸã“ã¨ã‚’ã¾ã¨ã‚ã‚‹","tags":["poem","tech","next"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \næœ¬ãƒ–ãƒ­ã‚°ã®ä»Šæœˆã®åç›ŠğŸ‰  \n  \n![alt text](images/next-blog-summary/estimated-blog-income.png)  \n  \nä»Šå¹´ã®7æœˆã‚ãŸã‚Šã‹ã‚‰å€‹äººãƒ–ãƒ­ã‚°ã®ä½œæˆã‚’å°‘ã—ã¥ã¤å§‹ã‚ã€Google Adsenseã®å¯©æŸ»ã«é€šã‚Šã€0â†’1 ã‚’é”æˆã™ã‚‹ã“ã¨ãŒã§ããŸã®ã§ã€ã‚„ã£ãŸã“ã¨ã‚’ã¾ã¨ã‚ã¦ã¿ã¾ã™ã€‚  \n  \n  \nâš ï¸Â ã‚¸ãƒ¥ãƒ‹ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒè‡ªåˆ†è‡ªèº«ã®æˆé•·ã®ãŸã‚ã«ä½œæˆã—ãŸãƒ–ãƒ­ã‚°ã§ãŸã¾ãŸã¾åç›ŠãŒ1å††ã«ãªã£ãŸã ã‘ã§ã™ã€‚ãƒ–ãƒ­ã‚°ã§ãŸãã•ã‚“ç¨¼ããŸã„æ–¹ã«ã¨ã£ã¦ã¯ã‚ã¾ã‚Šå‚è€ƒã«ãªã‚‹å†…å®¹ã¯ãªã„ã¨æ€ã„ã¾ã™m  \nè‡ªåˆ†è‡ªèº«ã®ç¶™ç¶šã®ãŸã‚ã«ã‚‚å¥½å¥‡å¿ƒã§ Google Adsense ã®å¯©æŸ»ã‚’å‡ºã™ã¨é€šã£ãŸã®ã§ã€å°‘ã—ã ã‘åºƒå‘Šã‚’å…¥ã‚Œã•ã›ã¦ã‚‚ã‚‰ã£ã¦ã„ã‚‹çŠ¶æ³ã§ã™ã€‚  \n  \n  \n# ã¾ã¨ã‚  \n  \n- Next.jsã§ãƒ–ãƒ­ã‚°ã‚’æ§‹ç¯‰ã—ãŸ  \n\t- notionã§è¨˜äº‹ã‚’æ›¸ãã€github actionã®å®šæœŸå®Ÿè¡Œã‹ã‚‰ notion apiçµŒç”±ã§mdãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹ã“ã¨ã§è¨˜äº‹ã‚’ç®¡ç†ã—ã¦ã„ã‚‹  \n\t- notionã®ç”»åƒãƒ‡ãƒ¼ã‚¿ã®URLã¯ã€notionã®ä»•æ§˜ã«ã‚ˆã‚‹ã‚‚ã®ãªã®ã‹ãŒã™ãã«URLãŒå¤‰ã‚ã£ã¦ãƒªãƒ³ã‚¯åˆ‡ã‚Œã—ã¦ã—ã¾ã†ãŸã‚ã€ç”»åƒãƒ‡ãƒ¼ã‚¿ã¯base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦mdãƒ•ã‚¡ã‚¤ãƒ«å†…ã«å«ã‚ãŸ  \n\t- ãã®ä»–ã€TOCã®è‡ªå‹•ç”Ÿæˆã€ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã€rssãƒ•ã‚£ãƒ¼ãƒ‰ãªã©æ™®é€šã®ãƒ–ãƒ­ã‚°ã«ã‚ã‚Šãã†ãªæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ãŸ  \n- ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°å…ˆã¯Netlifyã®ç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼ˆVercelã®ç„¡æ–™ãƒ—ãƒ©ãƒ³ã ã¨åºƒå‘Šã‚’è¼‰ã›ã‚‰ã‚Œãªã„ï¼‰  \n- CMSã«notion, ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã«Netlifyã¨ã„ã†æ§‹æˆãªã®ã§ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å–å¾—æ–™ä»¥å¤–ã¯ç„¡æ–™  \n  \n# å€‹äººãƒ–ãƒ­ã‚°ã‚’ä½œã‚ã†ã¨æ€ã£ãŸèƒŒæ™¯  \n  \n- å‹‰å¼·ã—ãŸã“ã¨ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’å½¢ã¨ã—ã¦æ®‹ã—ã¦ãŠããŸã„  \n\t- ãƒ–ãƒ­ã‚°ã‚’å§‹ã‚ã‚‹ã¨ã€ãƒã‚¿ä½œã‚Šã®ãŸã‚ã«ã‚‚å‹‰å¼·æ„æ¬²ã«ãªã‚‹  \n\t- ã„ã¤ã‹è»¢è·ã‚’æ¤œè¨ã™ã‚‹éš›ã«å½¹ç«‹ã¤ã‹ã‚‚  \n- ã¤ã‚ˆã¤ã‚ˆã§å½±éŸ¿åŠ›ã®ã‚ã‚‹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¯å€‹äººãƒ–ãƒ­ã‚°ã‚’æŒã£ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„  \n- ä»•æ§˜æ›¸ã‚„æŠ€è¡“çš„ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã®æ–‡ç« åŠ›ã‚’é›ãˆãŸã„ï¼ˆã‹ã£ã“ã‚ˆãè¨€ãˆã°ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°ï¼‰  \n- Next.jsã§ä½•ã‹ä½œã‚ŠãŸã„  \n  \n# ã‚„ã£ãŸã“ã¨  \n  \n  \n## Next.jsã§ãƒ–ãƒ­ã‚°ã®ãƒ™ãƒ¼ã‚¹æ©Ÿèƒ½ã®ä½œæˆ  \n  \n  \n### contentlayerã«ã‚ˆã‚‹mdãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ç®¡ç†  \n  \n  \nå…¬å¼doc: [https://contentlayer.dev/docs](https://contentlayer.dev/docs)  \n  \n  \nå‚è€ƒè¨˜äº‹:  \n  \n\n<Bookmark href=\"https://zenn.dev/you_5805/articles/contentlayer\" />\n  \nè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ä»¥ä¸‹  \n  \n  \n```typescript  \n// contentlayer.config.ts  \nimport { defineDocumentType, makeSource } from \"contentlayer/source-files\";  \nimport { remark } from \"remark\";  \nimport strip from \"strip-markdown\";  \nexport const Post = defineDocumentType(() => ({  \n  name: \"Post\",  \n  filePathPattern: `*.md`,  \n  fields: {  \n    title: { type: \"string\", required: true },  \n    date: { type: \"string\", required: true },  \n    updatedAt: { type: \"string\", required: false },  \n    tags: { type: \"list\", of: { type: \"string\" }, required: true },  \n    isDeleted: { type: \"boolean\", required: false },  \n    isPublished: { type: \"boolean\", required: false },  \n    publishedAt: { type: \"string\", required: false },  \n    views: { type: \"number\", required: false },  \n  },  \n  computedFields: {  \n    url: {  \n      type: \"string\",  \n      resolve: (post) => `/posts/${post._raw.flattenedPath}`,  \n    },  \n    slug: {  \n      type: \"string\",  \n      resolve: (post) => post._raw.sourceFileName.replace(/\\.md$/, \"\"),  \n    }  \n  },  \n}));  \n  \nexport default makeSource({  \n  contentDirPath: \"../contents\",  \n  documentTypes: [Post],  \n});  \n```  \n  \n  \n### react-markdownã¨react-syntax-highlighterã«ã‚ˆã‚‹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°  \n  \n  \nå…¬å¼doc: [https://github.com/remarkjs/react-markdown](https://github.com/remarkjs/react-markdown)  \n  \n  \n```typescript  \nimport ReactMarkdown from \"react-markdown\";  \nimport remarkGfm from \"remark-gfm\";  \nimport rehypeSlug from \"rehype-slug\";  \nimport rehypeRaw from \"rehype-raw\";  \nimport { Prism as SyntaxHighlighter } from \"react-syntax-highlighter\";  \nimport { oneDark } from \"react-syntax-highlighter/dist/cjs/styles/prism\";  \n  \n  \n<ReactMarkdown  \n  className=\"post prose dark:prose-invert\"  \n  urlTransform={(value: string) => value} // base64å½¢å¼ã®ç”»åƒã«å¯¾å¿œ ref. https://github.com/remarkjs/react-markdown/issues/774  \n  rehypePlugins={[rehypeRaw, rehypeSlug]}  \n  remarkPlugins={[remarkGfm]}  \n  components={{  \n    p: Paragraph,  \n    code: ({ node, className, children, style, ref, ...props }) => {  \n      const match = /language-(\\w+)/.exec(className || \"\");  \n      return match ? (  \n        <SyntaxHighlighter  \n          language={match[1]}  \n          PreTag=\"div\"  \n          {...props}  \n          style={oneDark}  \n        >  \n          {String(children).replace(/\\n$/, \"\")}  \n        </SyntaxHighlighter>  \n      ) : (  \n        <code className={className} {...props}>  \n          {children}  \n        </code>  \n      );  \n    },  \n  }}  \n>  \n  {post.body.raw}  \n</ReactMarkdown>  \n```  \n  \n  \n[react-markdwon](https://github.com/remarkjs/react-markdown)ã§ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã§ã¯ base64å½¢å¼ã§ç”»åƒã‚’æŒ‡å®šã™ã‚‹ `data:`Â protocolÂ ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è¦³ç‚¹ã‹ã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚µãƒãƒ¼ãƒˆå¯¾è±¡ã®ãŸã‚ã€ä»¥ä¸‹ã®ã‚ˆã†ã«urlTransformã‚’ä¸Šæ›¸ãã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™  \n  \n  \nref: [https://github.com/remarkjs/react-markdown/issues/774](https://github.com/remarkjs/react-markdown/issues/774)  \n  \n  \n```typescript  \n<ReactMarkdown  \n  className=\"post prose dark:prose-invert\"  \n  urlTransform={(value: string) => value} // base64å½¢å¼ã®ç”»åƒã«å¯¾å¿œ  \n/>       \n```  \n  \n  \n### TOCã®è¿½åŠ   \n  \n  \nå…¬å¼doc: [https://tscanlin.github.io/tocbot/](https://tscanlin.github.io/tocbot/)  \n  \n  \nå‚è€ƒè¨˜äº‹:   \n  \n  \n<Bookmark href=\"https://zenn.dev/yyykms123/articles/2023-12-03-adding-toc-to-nextjs-blog-using-tocbot\" />\n\n  \nå®Ÿè£…ã¯ä»¥ä¸‹  \n  \n  \n```typescript  \n\"use client\";  \n  \nimport { useEffect } from \"react\";  \nimport tocbot from \"tocbot\";  \n  \nexport const PcToc: React.FC = () => {  \n  useEffect(() => {  \n    tocbot.init({  \n      tocSelector: \".toc\",  \n      contentSelector: \".post\", // ç›®æ¬¡ã‚’æŠ½å‡ºã—ãŸã„è¦ç´ ã®ã‚¯ãƒ©ã‚¹å  \n      headingSelector: \"h1, h2, h3\",  \n      scrollSmoothOffset: -60,  \n      headingsOffset: 60,  \n      scrollSmoothDuration: 300,  \n    });  \n  \n    return () => tocbot.destroy();  \n  }, []);  \n  \n  return (  \n    <div className=\"sticky top-0\">  \n      <h2 className=\"text-xl border-l-4 pl-1\">ç›®æ¬¡</h2>  \n      <div className=\"toc px-0 pb-8 text-base\"></div>  \n    </div>  \n  );  \n};  \n```  \n  \n  \n### next/ogã«ã‚ˆã‚‹OGPã®ç”»åƒã®è‡ªå‹•ç”Ÿæˆ  \n  \n  \nå…¬å¼doc: [https://github.com/vercel/next.js](https://github.com/vercel/next.js)  \n  \n  \nå‚è€ƒ:   \n  \n  \n<Bookmark href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata/opengraph-image\" />\n  \n  \nå®Ÿè£…ï¼ˆstyleéƒ¨åˆ†ã¯é•·ããªã‚‹ãŸã‚çœç•¥ï¼‰  \n  \n  \n```typescript  \nimport path from \"path\";  \nimport { ImageResponse } from \"next/og\";  \n  \nconst assetsDirectory = process.cwd() + \"/assets\";  \n  \nexport const size = {  \n  width: 1200,  \n  height: 630,  \n};  \n  \nexport const contentType = \"image/png\";  \n  \nexport default async function Image({ params }: { params: { slug: string } }) {  \n  const post = getPost(params.slug);  \n  \n  if (!post) return new Response(\"Not Found\", { status: 404 });  \n  \n  const fontInter = await fs.readFile(  \n    path.join(assetsDirectory, \"Inter-Bold.ttf\")  \n  );  \n  const fontNotSansJP = await fs.readFile(  \n    path.join(assetsDirectory, \"NotoSansJP-Bold.ttf\")  \n  );  \n  \n  return new ImageResponse(  \n    (  \n      <div lang=\"ja-JP\">  \n        <div>{post.title}</div>  \n        <div>{SITE_TITLE}</div>  \n      </div>  \n    ),  \n    {  \n      width: 1200,  \n      height: 630,  \n      fonts: [  \n        {  \n          name: \"Inter\",  \n          data: fontInter,  \n          style: \"normal\",  \n          weight: 700,  \n        },  \n        {  \n          name: \"NotoSansJP\",  \n          data: fontNotSansJP,  \n          style: \"normal\",  \n          weight: 700,  \n        },  \n      ],  \n    }  \n  );  \n}  \n  \n```  \n  \n  \n## notionã¨github actionå®šæœŸå®Ÿè¡Œã§CMSæ©Ÿèƒ½ã®ä½œæˆ  \n  \n  \n### ãã‚‚ãã‚‚ãªãœnotionãªã®ã‹ï¼Ÿ  \n  \n  \nnotionãªã‚‰ã‚¹ãƒãƒ›ã‹ã‚‰ã§ã‚‚æ°—è»½ã«æ›¸ãã“ã¨ãŒã§ãã€è¨˜äº‹ã®æ›´æ–°ã‚’ç¶™ç¶šã§ããã†ã¨æ€ã£ãŸã‹ã‚‰ã€‚  \n  \n  \nä»–ã®CMSã§ãƒ–ãƒ­ã‚°æ§‹ç¯‰ã‚’è©¦ã¿ãŸçµŒé¨“ãŒã‚ã‚Šã¾ã™ãŒã€ãƒ–ãƒ­ã‚°ã®ãŸã‚ã ã‘ã«CMSã‚’é–‹ãã®ãŒå„„åŠ«ã§æ›´æ–°ã§ããªããªã‚Šã¾ã—ãŸã€‚æ™®æ®µä½¿ã„ã—ã¦ã„ã‚‹notionã‚’ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã™ã‚‹ã¨ãƒ–ãƒ­ã‚°ã®æ›´æ–°ãŒç¶™ç¶šã§ãã‚‹ã‹ã‚‚ã¨æ€ã„ã€ç„¡ç†ã‚„ã‚Šnotionã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚  \n  \n  \n### å®Ÿç¾æ–¹æ³•  \n  \n  \nnotion apiã¯ã™ãã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆé‡åˆ¶é™ã«é”ã™ã‚‹ã®ã§ã€éƒ½åº¦å–å¾—ã§ãã¾ã›ã‚“ã€‚å®šæœŸå®Ÿè¡Œï¼ˆ1æ—¥ã«2å›ï¼‰ã§mdãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã—ãŸã‚‚ã®ã‚’ãƒªãƒã‚¸ãƒˆãƒªã«ä¿å­˜ã—ã¦ãŠãã€buildæ™‚ã«ãƒªãƒã‚¸ãƒˆãƒªã«ã‚ã‚‹mdãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ãƒ–ãƒ­ã‚°ã‚’æ§‹ç¯‰ã—ã¦ã„ã¾ã™ã€‚  \n  \n  \næœ€çµ‚çš„ãªãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã¯ãƒªãƒã‚¸ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã‚‹mdãƒ•ã‚¡ã‚¤ãƒ«ã¨ãªã‚‹ã®ã§ã€ç´°ã‹ã„ä¿®æ­£ãªã©ã¯ç›´æ¥mdãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã„ã˜ã£ãŸã‚Šã‚‚ã—ã¦ã„ã¾ã™ã€‚  \n  \n  \ngithub actionsã®è¨­å®šyaml  \n  \n  \n```typescript  \nname: update-contents  \non:  \n  push:  \n    branches: [main]  \n  schedule:  \n    - cron: \"0 4,14 * * *\" # æ¯æ—¥ 4æ™‚ã€14æ™‚ ã«å®Ÿè¡Œ  \n# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«æ›¸ãè¾¼ã¿æ¨©é™ã‚’ä¸ãˆã‚‹ ref:https://docs.github.com/en/actions/using-jobs/assigning-permissions-to-jobs  \npermissions:  \n  contents: write  \njobs:  \n  command:  \n    name: Use Linux commands  \n    runs-on: ubuntu-latest  \n    steps:  \n      - name: Checkout  \n        uses: actions/checkout@v4  \n      - name: Use Node.js  \n        uses: actions/setup-node@v4  \n        with:  \n          node-version: 20  \n          cache: \"npm\"  \n      - name: build application  \n        working-directory: packages/gha-worker  \n        run: npm ci && npm run build  \n      - name: run notion fetch  \n        working-directory: packages/gha-worker  \n        env:  \n          NOTION_API_KEY: ${{ secrets.NOTION_API_KEY }}  \n          NOTION_DATABASE_ID: ${{ secrets.NOTION_DATABASE_ID }}  \n          GITHUB_WORKSPACE: $GITHUB_WORKSPACE  \n        run: node dist/notion-fetch/index.js  \n      - name: diff # run notion fetch ã‚¿ã‚¹ã‚¯ã§ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’git diffã§ç¢ºèªã—ã€commitã¨pushã‚’è¡Œã†  \n        id: diff  \n        run: |  \n          git add -N .  \n          git diff --name-only --exit-code  \n        continue-on-error: true  \n      - name: update contents_last_updated.tag  \n        working-directory: packages/gha-worker  \n        run: node dist/update-tag/index.js  \n        if: steps.diff.outcome == 'failure'  \n      - name: commit and push  \n        env:  \n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  \n        run: |  \n          set -x  \n          git config --local user.email \"github-actions[bot]@users.noreply.github.com\"  \n          git config --local user.name \"github-actions[bot]\"  \n          DATETIME=$(date +\"%Y-%m-%d %H:%M:%S\")  \n          git add .  \n          git commit -m \"[$DATETIME] update notion blog content by bot\"  \n          git push origin main  \n        if: steps.diff.outcome == 'failure'  \n  \n```  \n  \n  \nrun notion fetch ã‚¿ã‚¹ã‚¯ã®å‡¦ç†ã®æ¦‚è¦  \n  \n  \n```typescript  \n  \nimport * as core from '@actions/core'  \nimport { writeFile } from 'fs/promises'  \n  \n  \nexport async function run() {  \n  try {  \n    const notionApiKey = process.env.NOTION_API_KEY ?? 'undefined'  \n    const databaseId = process.env.NOTION_DATABASE_ID ?? 'undefined'  \n    const notionClient = new NotionClient(notionApiKey)  \n  \n    // è¨˜äº‹ä¸€è¦§ã‚’å–å¾—ã™ã‚‹  \n    const posts = await notionClient.getUpdatedDatabase(databaseId)  \n  \n    // notion api ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™ã‚’é¿ã‘ã‚‹ãŸã‚ã€5ç§’ã‚¹ãƒªãƒ¼ãƒ—ã™ã‚‹  \n    await new Promise(resolve => setTimeout(resolve, 5000))  \n  \n    const feedItems: Post[] = posts.map(postFromNotionResponse)  \n  \n    const filterdFeedItems = feedItems.filter(  \n      item => isWithin6Hours(item.lastEditedDate) && item.slug // slugãŒå­˜åœ¨ã—ãªã„å ´åˆã‚‚filterã™ã‚‹  \n    )  \n  \n    const contentsPath = process.env.GITHUB_WORKSPACE + '/contents'  \n  \n    for (const feedItem of filterdFeedItems) {  \n      // è¨˜äº‹ã‚’markdownå½¢å¼ã§å–å¾—ã™ã‚‹  \n      const mdString = await notionClient.getMdString(feedItem.id)  \n      const mdContents = attachMdMetadata(feedItem, mdString)  \n        \n      // ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ãè¾¼ã‚€  \n      await writeFile(`${contentsPath}/${feedItem.slug}.md`, mdContents, 'utf8')  \n  \n      core.info(`  \n        Successfully updated below md files  \n        title: ${feedItem.title}  \n        slug: ${feedItem.slug}  \n        id: ${feedItem.id}  \n      `)  \n  \n      // notion api ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™ã‚’é¿ã‘ã‚‹ãŸã‚ã€5ç§’ã‚¹ãƒªãƒ¼ãƒ—ã™ã‚‹  \n      await new Promise(resolve => setTimeout(resolve, 5000))  \n    }  \n  } catch (err) {  \n    console.log(err)  \n  }  \n}  \n```  \n  \n  \n### notionã®ç”»åƒã‚’mdãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã™ã‚‹éš›ã®æ³¨æ„ç‚¹  \n  \n  \nnotionã®ç”»åƒãƒ‡ãƒ¼ã‚¿ã®URLã¯ã€notionã®ä»•æ§˜ã«ã‚ˆã‚‹ã‚‚ã®ãªã®ã‹ãŒã™ãã«URLãŒå¤‰ã‚ã£ã¦ãƒªãƒ³ã‚¯åˆ‡ã‚Œã—ã¦ã—ã¾ã†  \n  \n  \nâ‡’ [notion-to-md](https://github.com/souvikinator/notion-to-md)ã§mdå¤‰æ›ã™ã‚‹éš›ã«ç”»åƒã‚’base64å¤‰æ›ã™ã‚‹ã“ã¨ã§å¯¾å¿œ ref: [https://github.com/souvikinator/notion-to-md/pull/81/files](https://github.com/souvikinator/notion-to-md/pull/81/files)  \n  \n  \n```typescript  \nimport { Client } from '@notionhq/client'  \nimport { NotionToMarkdown } from 'notion-to-md'  \n  \n  \nconst n2m = new NotionToMarkdown({  \n  notionClient: new Client({  \n      auth: notionToken,  \n      timeoutMs: 1000  \n  }),  \n  config: {  \n    convertImagesToBase64: true  \n  }  \n})  \n```  \n  \n  \n## æœ€å¾Œã«  \n  \n  \nã‚ã–ã‚ã–notion apiã‚’åˆ©ç”¨ã›ãšã«ã€mdãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥ã„ã˜ã‚‹é‹ç”¨ã§ã‚‚è‰¯ã„æ°—ãŒã—ã¦ã„ã‚‹ã€‚  \n  \n  \nä»¥ä¸‹ã®æ©Ÿèƒ½ãŒVS Codeã«è¿½åŠ ã•ã‚Œã¦ã‹ã‚‰ã¯ç”»åƒã®æ‰±ã„ã‚‚ã‹ãªã‚Šæ¥½ã«ãªã£ãŸã®ã§ã€ãã®ã†ã¡notion apiåˆ©ç”¨ã¯çµ‚ã‚ã‚Šãã†ã€‚  \n  \n  \n<Bookmark href=\"https://zenn.dev/roboin/articles/1fa72705ff2e03\" />\n  \n  \nã¾ãŸã€ï¼ˆ1å††ã¨ã¨ã¦ã‚‚å°‘ãªã„ãŒï¼‰åç›Šã‚’ãƒ–ãƒ­ã‚°ã‹ã‚‰å¾—ã‚‹ã«ã‚ãŸã£ã¦ã€æ¥­å‹™ã§å¾—ãŸçŸ¥è­˜ã¨ã®æ£²ã¿åˆ†ã‘ãŒé›£ã—ã„ãªã¨æ„Ÿã˜ã‚‹ã€‚æ¥­å‹™ã§å¾—ãŸçŸ¥è­˜ã¯ä¼šç¤¾ã«å¸°å±ã™ã‚‹èªè­˜ã§ãƒ–ãƒ­ã‚°ã§åˆ©ç”¨ã™ã‚‹ã¤ã‚‚ã‚Šã¯ãªã„ãŒã€æ¥­å‹™ãã£ã‹ã‘ã¦èˆˆå‘³ã‚’æŒã¡ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®æ™‚é–“ã«æ·±æ˜ã£ãŸæŠ€è¡“ã‚’ã©ã“ã¾ã§ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã™ã¹ããªã®ã‹ãŒé›£ã—ã„ã¨ã“ã‚ã€‚ã€‚ã€‚  \n  \n  \nã€Œæ¥­å‹™ã¨æ¥­å‹™æ™‚é–“å¤–ã®å‹‰å¼·ã®å¢ƒç›®ãŒæ›–æ˜§ã€ = ã€Œä¼šç¤¾ã®è³‡ç”£ã¨è‡ªåˆ†ã®è³‡ç”£ãŒæ›–æ˜§ã€ãªçŠ¶æ…‹ãªã®ã§åŒæ¥­ã®æ–¹ã¯ã©ã®ã‚ˆã†ã«æ‰ãˆã¦ã„ã‚‹ã®ã‹ã¨ã¦ã‚‚æ°—ã«ãªã‚‹  \n  \n","date":"2024-12-03T00:00:00.000Z"},{"slug":"next-web-push","title":"Next.jsã§ãƒ–ãƒ©ã‚¦ã‚¶é€šçŸ¥ã‚’è©¦ã—ã¦ã¿ã‚‹","tags":["tech","next","PWA"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \n# ã¯ã˜ã‚ã«  \n\n  \nNext.js (app router) ã«ã¦Pushé€šçŸ¥ã‚’å®Ÿç¾ã—ã¦ã¿ãŸè¨˜éŒ²ã‚’ã¾ã¨ã‚ã¾ã™ã€‚  \n  \n  \nPushé€šçŸ¥ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã®æŠ€è¡“ã§ã‚ã‚‹ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã¨ãã®å¿œç”¨ã®PWAã«ã¤ã„ã¦ã‚‚æ°—ã«ãªã£ãŸã®ã§å°‘ã—è¨€åŠã—ã¦ã„ã¾ã™ã€‚  \n  \n  \nå®Ÿè£…ã®å¤§éƒ¨åˆ†ã¯ä»¥ä¸‹ã®Next.jsã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚  \n  \n<Bookmark href=\"https://nextjs.org/docs/app/building-your-application/configuring/progressive-web-apps\" />\n  \n# ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã¨ã¯  \n  \n  \né€šçŸ¥ã‚’å—ã‘å–ã‚Šãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨ã®ã“ã¨ã€‚  \n  \n  \nä»¥ä¸‹ã®è¨˜äº‹ãŒã¨ã¦ã‚‚å‚è€ƒã«ãªã‚‹ã€‚  \n  \n<Bookmark href=\"https://zenn.dev/s_takashi/articles/b01980461f3b21\" />\n  \n  \nä»¥ä¸‹ã¯æ˜ç¤ºçš„ã«ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒ€ã‚¦ãƒ­ãƒ¼ãƒ‰ã•ã›ã‚‹ä¾‹ã€‚  \n  \n  \n```javascript  \nconst registration = await navigator.serviceWorker.register('/sw.js', {  \n\tscope: '/',  \n})  \n```  \n\nãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã€é€šçŸ¥ã‚’ã‚­ãƒ£ãƒƒãƒã—ã¦ã•ã°ãã¨ã„ã†ä»•çµ„ã¿ã€‚  \n  \nä¸€åº¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚å®Ÿè¡Œå¯èƒ½ã€‚ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚å‹•ãã“ã®ã‚ˆã†ãªä»•çµ„ã¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãªã©ã«åˆ©ç”¨ã™ã‚‹ã®ãŒPWAã‚‰ã—ã„ã€‚  \n  \nã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã®å®Ÿè¡Œç’°å¢ƒã¨ç•°ãªã‚Šã€ä»¥ä¸‹ã®apiãŒåˆ©ç”¨ã§ãã‚‹ã‚‰ã—ã„ã€‚ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å‰ã‹ã‚‰å‹•ã„ã¦ãã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã®ã§å½“ç„¶ã ãŒã€DOMã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã‹ã£ãŸã‚Šã€windowã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã©ã¯åˆ©ç”¨ã§ããªã„ã®ã§æ³¨æ„ãŒå¿…è¦ã€‚  \n  \n  \n<Bookmark href=\"https://developer.mozilla.org/ja/docs/Web/API/Service_Worker_API\" />\n  \nä»¥ä¸‹ã®chromeã®service workerè¨­å®šç”»é¢ï¼ˆ**chrome://serviceworker-internals/**ï¼‰ã‹ã‚‰ç¢ºèªã€unregisterã™ã‚‹ã“ã¨ãŒã§ãã‚‹  \n  \n![alt text](images/next-web-push/serviceworker-internals.png)\n  \nã¾ãŸã€æ¤œè¨¼ç”»é¢ã‹ã‚‰Unregisterã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ç”»åƒã®ã€ŒUpdate on reloadã€ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ãŠãã¨ã€ãƒªãƒ­ãƒ¼ãƒ‰ã®åº¦ã«ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒæ›´æ–°ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã€ãƒ‡ãƒãƒƒã‚°ãŒæ—ã£ãŸã®ã§ãŠã™ã™ã‚ã§ã™ã€‚  \n  \n![alt text](images/next-web-push/developer-tool.png)\n  \n# Next.jsã§ãƒ–ãƒ©ã‚¦ã‚¶é€šçŸ¥ã‚’å®Ÿè£…ã™ã‚‹  \n  \n  \n## é€šçŸ¥ã‚’å—ã‘å–ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’ä½œæˆã™ã‚‹  \n  \n  \npublic/sw.js  \n  \n  \n```javascript  \nself.addEventListener(\"push\", function (event) {  \n  if (event.data) {  \n    const data = event.data.json();  \n    const options = {  \n      body: data.body,  \n      icon: data.icon || \"/favicon.png\",  \n      badge: \"/favicon.png\",  \n      vibrate: [100, 50, 100],  \n      data: {  \n        dateOfArrival: Date.now(),  \n        primaryKey: \"2\",  \n      },  \n    };  \n    event.waitUntil(self.registration.showNotification(data.title, options));  \n  }  \n});  \n```  \n  \n  \npushã‚¤ãƒ™ãƒ³ãƒˆã‚’event listenerã‚’ä½œæˆã—ã€é€šçŸ¥ã‚’ä½œæˆã™ã‚‹ [showNotification](https://developer.mozilla.org/ja/docs/Web/API/ServiceWorkerRegistration/showNotification) ãƒ¡ã‚½ãƒƒãƒ‰ã§ç«¯æœ«ã«é€šçŸ¥ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚  \n  \n  \n## ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’ç™»éŒ²ã—ã€é€šçŸ¥ç®¡ç†ã®subscriptionã‚’ã‚¹ãƒ†ãƒ¼ãƒˆã«æ ¼ç´ã™ã‚‹  \n  \n  \n```javascript  \n  async function registerServiceWorker() {  \n    const registration = await navigator.serviceWorker.register(\"/sw.js\", {  \n      scope: \"/\",  \n      updateViaCache: \"none\",  \n    });  \n    const sub = await registration.pushManager.getSubscription();  \n    setSubscription(sub);  \n  }  \n```  \n  \n  \nregisterãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”ã‚Šå€¤ã¯ä»¥ä¸‹ã®ServiceWorkerRegistrationã‚’è¿”ã™ã€‚  \n  \n  \n<Bookmark href=\"https://developer.mozilla.org/ja/docs/Web/API/ServiceWorkerRegistration\" />\n  \n  \nã“ã¡ã‚‰ã®ServiceWorkerRegistrationã‹ã‚‰ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã®è¨±å¯çŠ¶æ³ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãªã©ã€ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã®è³¼èª­ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®Â [`PushManager`](https://developer.mozilla.org/ja/docs/Web/API/PushManager)Â ã¸ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã“ã¡ã‚‰ã® PushManagerã‹ã‚‰å–å¾—ã§ãã‚‹ [`PushSubscription`](https://developer.mozilla.org/ja/docs/Web/API/PushSubscription) ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã‚’é€ã‚‹éš›ã«åˆ©ç”¨ã™ã‚‹ã®ã§stateã«æ ¼ç´ã—ã¦ãŠãã€‚  \n  \n  \nã¡ãªã¿ã«ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’ç™»éŒ²ã™ã‚‹éš›ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã®é€šçŸ¥æ¨©é™ã‚’æ±‚ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã€è‡ªåˆ†ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚  \n  \n  \n```typescript  \n  useEffect(() => {  \n    requestPermission().then((permission) => {  \n      // é€šçŸ¥ã®æ¨©é™ãŒã‚ã‚‹å ´åˆã®ã¿å…ˆã»ã©ã®registerServiceWokerã‚’å®ŸåŠ¹ã™ã‚‹  \n      if (permission) registerServiceWorker();  \n    });  \n  }, []);  \n  \n  async function requestPermission() {  \n    if (  \n      \"serviceWorker\" in navigator &&  \n      \"PushManager\" in window &&  \n      \"Notification\" in window  \n    ) {  \n      // ç¾åœ¨ã®é€šçŸ¥æ¨©é™ã®çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯  \n      if (Notification.permission === \"granted\") {  \n        return true;  \n      } else if (Notification.permission === \"default\") {  \n        // é€šçŸ¥æ¨©é™ãŒã¾ã è¨±å¯ã•ã‚Œã¦ã„ãªã„å ´åˆã€è¨±å¯ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ  \n        Notification.requestPermission().then((permission) => {  \n          if (permission === \"granted\") return true;  \n        });  \n      } else {  \n        // Notification.permission === \"denied\" ã®å ´åˆã€æ‰‹å‹•ã§æ¨©é™ã‚’è¨±å¯ã—ã¦ã‚‚ã‚‰ã†å¿…è¦ãŒã‚ã‚‹  \n        setAlert(  \n          \"é€šçŸ¥æ¨©é™ãŒæ‹’å¦ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‚ˆã‚Šæ‰‹å‹•ã§é€šçŸ¥ã‚’è¨±å¯ã—ã¦ãã ã•ã„\"  \n        );  \n      }  \n    } else {  \n      setAlert(\"ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯é€šçŸ¥ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚\");  \n    }  \n    return false;  \n  }  \n```  \n  \n  \né€šçŸ¥æ¨©é™ã®çŠ¶æ…‹ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã‚’ã®å…¬å¼Docã‚’å‚è€ƒã«å®Ÿè£…ã—ã¾ã—ãŸã€‚  \n  \n  \n<Bookmark href=\"https://developer.mozilla.org/ja/docs/Web/API/Notification/requestPermission_static\" />\n  \n  \nã¾ãŸã€å‚è€ƒã¾ã§ã« ãƒ¼ã‚«ãƒ«ã§ã§å‹•ä½œç¢ºèªã™ã‚‹å ´åˆã¯httpsã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ `next dev --experimental-https` ã‚’åˆ©ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã¾ã™ã€‚  \n  \n  \n## é€šçŸ¥ã‚’é€ã‚‹ï¼ˆserver actionï¼‰  \n  \n  \næœ€å¾Œã«ã€å–å¾—ã—ãŸsubscriptionã®æƒ…å ±ã‚’ç”¨ã„ã¦é€šçŸ¥ã‚’å®Ÿè£…ã«é€ä¿¡ã™ã‚‹éƒ¨åˆ†ã‚’ä½œæˆã—ã¾ã—ãŸã€‚é€šçŸ¥é€ä¿¡éƒ¨åˆ†ã¯[server action](https://react.dev/reference/rsc/server-actions)ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚  \n  \n  \nweb-push é€ä¿¡éƒ¨åˆ†ã®è©³ç´°ã¯ä»¥ä¸‹ã®README.meãªã©ã‚’å‚ç…§ãã ã•ã„ã€‚Â [VAPID](https://vapidkeys.com/) ãªã©ã‚’äº‹å‰ã«ç™»éŒ²ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  \n  \n  \n<Bookmark href=\"https://www.npmjs.com/package/web-push\" />\n  \n  \n```javascript  \n\"use server\";  \n  \nimport webpush, { PushSubscription } from \"web-push\";  \n  \nwebpush.setVapidDetails(  \n  \"mailto:example@gmail.com\",  \n  process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY!,  \n  process.env.VAPID_PRIVATE_KEY!  \n);  \n  \n  \nexport async function sendNotification(message: string) {  \n  if (!subscription) {  \n    throw new Error(\"No subscription available\");  \n  }  \n  \n  try {  \n    await webpush.sendNotification(  \n      subscription,  \n      JSON.stringify({  \n        title: \"Test Notification\",  \n        body: message,  \n        icon: \"/favicon.png\",  \n      })  \n    );  \n    return { success: true };  \n  } catch (error) {  \n    console.error(\"Error sending push notification:\", error);  \n    return { success: false, error: \"Failed to send notification\" };  \n  }  \n}  \n```  \n  \n  \næœ¬ã‚µã‚¤ãƒˆã®ä»¥ä¸‹labsã«ã¦å‹•ä½œã—ã¦ã„ã‚‹éƒ¨åˆ†ã‚’ç¢ºèªã§ãã¾ã™ã€‚  \n  \n  \n[https://sokes-nook.net/blog/next-web-push](https://sokes-nook.net/blog/next-web-push)  \n  \n  \nchromeã®å ´åˆã€é€ä¿¡ã—ãŸé€šçŸ¥ã®å±¥æ­´ç­‰ã¯ä»¥ä¸‹ã‹ã‚‰ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚  \n  \n  \nchrome://gcm-internals/  \n  \n  \n## PWAã®ç¾çŠ¶ã«ã¤ã„ã¦  \n  \n  \nPWA(Progressive Web Applications) ã¯ã€ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒªãƒ¼ãƒã¨ã‚¢ã‚¯ã‚»ã‚¹æ€§ã‚’æŒã¡ãªãŒã‚‰ã€ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã®æ©Ÿèƒ½ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’çµ„ã¿åˆã‚ã›ãŸã‚‚ã®ã§ã™ã€‚  \n  \n- ã‚¢ãƒ—ãƒªã‚¹ãƒˆã‚¢ã®æ‰¿èªã‚’å¾…ãŸãšã«ã€ã™ãã«æ›´æ–°ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã‚‹  \n- å˜ä¸€ã®ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã§ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã§ãã‚‹  \n- ãƒ›ãƒ¼ãƒ ç”»é¢ã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚„ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ãªã©ã€ãƒã‚¤ãƒ†ã‚£ãƒ–ã®ã‚ˆã†ãªæ©Ÿèƒ½ã‚’æä¾›ã§ãã‚‹  \n  \nNext.js ã«ãŠã„ã¦ã¯ã€[manifest](https://nextjs.org/docs/app/api-reference/file-conventions/metadata/manifest)ã‚’é©åˆ‡ã«ä½œæˆã—ã¦ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’é…ç½®ã™ã‚‹ã¨PWAã¨ã—ã¦å‹•ã‹ã™ã“ã¨ãŒã§ãã¾ã™ã€‚  \n  \n  \næœ¬ã‚µã‚¤ãƒˆã‚‚é€šçŸ¥æ¨©é™ã‚’ä»˜ä¸ã—ã¦ã‹ã¤ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ›ãƒ¼ãƒ ã«è¿½åŠ ã„ãŸã ãã¨PWAã¨ã—ã¦å‹•ãã‚ˆã†ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚  \n  \n  \nã—ã‹ã—ã€å®Ÿæ…‹ã¨ã—ã¦ãƒ–ãƒ©ã‚¦ã‚¶é€šçŸ¥ã‚„ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ã¯ä»¥ä¸‹ã§å ±å‘Šã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«è©æ¬ºãªã©ã«åˆ©ç”¨ã•ã‚Œã‚‹ã‚±ãƒ¼ã‚¹ãŒå¤šãã‚ã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å´ãŒç©æ¥µçš„ã«è¨±å¯ã™ã‚‹çŠ¶æ³ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è‚Œæ„Ÿè¦šçš„ã«ã¯ã€ã€Œä½•ã‹è¬ã®é€šçŸ¥ãŒè¦æ±‚ã•ã‚ŒãŸãŒã€ã‚ˆãã‚ã‹ã‚‰ãªã„ã®ã§ã¨ã‚Šã‚ãˆãšæ‹’å¦ã€‚ã€ã¨ã„ã†ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¤šã„ã¨æ„Ÿã˜ã¦ãŠã‚Šã€ã‚¢ãƒ—ãƒªã»ã©ãƒªãƒ¼ãƒã¨ã‚¢ã‚¯ã‚»ã‚¹æ€§ã‚’å®Ÿç¾ã§ããªã„ã¨æ€ã„ã¾ã™ã€‚  \n  \n  \nå®Ÿéš›ã«ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã«å°å…¥ã—ã¦ãƒªã‚¿ãƒ¼ãƒ³ãŒè¦‹è¾¼ã‚ã‚‹ã‹ã¯ã—ã£ã‹ã‚Šæ¤œè¨ãŒå¿…è¦ãªæ®µéšã¨ã„ã†ã“ã¨ã§ã™ã€‚  \n  \n  \n<Bookmark href=\"https://www.ipa.go.jp/security/anshin/attention/2021/mgdayori20210309.html\" />\n  \n  \nã—ã‹ã—ã€æŠ€è¡“ã¨ã—ã¦ã¯ã¨ã¦ã‚‚ç´ æ•µã ãªã¨æ€ã„ã¾ã™ã—ã€æ—¥ã€…é€²åŒ–ã—ã¦ã„ã‚‹ã¨å®Ÿæ„Ÿã—ã¦ã„ã¾ã™ã€‚æœ€å¾Œã«PWAã‚’å°å…¥ã™ã‚‹éš›ã«å‚è€ƒã«ãªã‚Šãã†ãªã‚µã‚¤ãƒˆã‚’ç½®ã„ã¦ãŠãã¾ã™ã€‚  \n  \n- ç¾åœ¨PWAãŒã§ãã‚‹ã“ã¨ã¯ä»¥ä¸‹ã‚µã‚¤ãƒˆã«ã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã‚‹  \n  \n  <Bookmark href=\"https://whatpwacando.today/\" />\n  \n- Next.jsã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¦è¨€åŠã•ã‚Œã¦ã„ã‚‹ [serwist](https://github.com/serwist/serwist) ã‚’åˆ©ç”¨ã—ãŸPWAã‚’ä½œæˆã—ã¦ã„ã‚‹ãƒ–ãƒ­ã‚°  \n  \n  <Bookmark href=\"https://javascript.plainenglish.io/building-a-progressive-web-app-pwa-in-next-js-with-serwist-next-pwa-successor-94e05cb418d7\" />\n  \n- serwistã®ãƒ•ã‚©ãƒ¼ã‚¯å…ƒã§ã‚ã‚‹workboxã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ä»¥ä¸‹ã®ä¸€ä¼‘.comã®äº‹ä¾‹  \n  \n  <Bookmark href=\"https://user-first.ikyu.co.jp/entry/2019/12/02/080000\" />\n  \n","date":"2024-09-25T00:00:00.000Z"},{"slug":"nextauth-yahoojapanid","title":"NextAuthã§Yahoo!JapanIDã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ãŸã‚ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ä½œæˆã™ã‚‹","tags":["tech","auth","OIDC"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \n## ã¯ã˜ã‚ã«  \n  \n  \nNext.jsã‚’ç”¨ã„ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹éš›ã€[NextAuth](https://next-auth.js.org/)ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒå¤šã„ã¨æ€ã„ã¾ã™ã€‚ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ãƒ­ã‚°ã‚¤ãƒ³ã ã£ãŸã‚Šã€Googleã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ãŸãã•ã‚“ã®å®Ÿè£…ä¾‹ã‚„è¨˜äº‹ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚å‚è€ƒã«ãªã‚Šãã†ãªå®Ÿè£…ä¾‹ã‚’ä»¥ä¸‹ã«ç½®ã„ã¦ãŠãã¾ã™ã€‚  \n  \n- å…¬å¼ã®å®Ÿè£…ä¾‹: [https://github.com/nextauthjs/next-auth-example](https://github.com/nextauthjs/next-auth-example)  \n- è¨˜äº‹: [https://zenn.dev/tfutada/articles/5557b780050574](https://zenn.dev/tfutada/articles/5557b780050574)  \n  \næœ¬è¨˜äº‹ã§ã¯ Yahoo!JAPAN IDã‚’ç”¨ã„ãŸãƒ­ã‚°ã‚¤ãƒ³ã‚’NextAuthã§å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚  \n  \n  \n## Yahoo! JAPAN IDã§ãƒ­ã‚°ã‚¤ãƒ³ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®å‰æº–å‚™  \n  \n  \nå‰æã¨ã—ã¦Yahoo! JAPAN IDã§ãƒ­ã‚°ã‚¤ãƒ³ã‚’æä¾›ã™ã‚‹ãŸã‚ã®ID é€£æºã®ä»•çµ„ã¿ãªã©ã¯ä»¥ä¸‹ã§èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã®ã§äº‹å‰ã«ç¢ºèªã—ã¦ãŠãã¨å®Ÿè£…ãŒã‚ã‹ã‚Šã‚„ã™ããªã‚‹ã¨æ€ã„ã¾ã™ã€‚  \n  \n  \n<Bookmark href=\"https://developer.yahoo.co.jp/yconnect/v2/introduction.html\" />\n  \n  \nåˆ©ç”¨ç”¨é€”ã«å¿œã˜ã¦ã“ã¡ã‚‰ã®[ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](https://developer.yahoo.co.jp/yconnect/v2/guideline.html)ã‚‚å‚ç…§ã—ã¦ãŠãã¨ã•ã‚‰ã«å®‰å¿ƒã‹ã¨æ€ã„ã¾ã™ã€‚[ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](https://developer.yahoo.co.jp/yconnect/loginbuttons.html)ã‚‚ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚  \n  \n  \nã¾ãŸã€ä»¥ä¸‹ã®Yahoo!ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰ã€å…ˆã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€OAuth2.0 ãŠã‚ˆã³ OpenID Connectç”¨ã®Clinet IDã‚’ç™ºè¡Œã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  \n  \n  \n<Bookmark href=\"https://developer.yahoo.co.jp/yconnect/v2/\" />\n  \n  \nã“ã¡ã‚‰ã§ç™ºè¡Œã—ãŸClinet ID, ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¯å®Ÿè£…ã§åˆ©ç”¨ã™ã‚‹ã®ã§ãƒ¡ãƒ¢ã£ã¦ãŠã„ã¦ãã ã•ã„ã€‚  \n  \n  \nredirect_uriã«æŒ‡å®šã™ã‚‹å€¤ã‚’äº‹å‰ã«ç™»éŒ²ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ä»¥ä¸‹å€¤ã‚’ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯URLã«ç™»éŒ²ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  \n  \n  \n`https://ã‚µã‚¤ãƒˆã®ãƒ‰ãƒ¡ã‚¤ãƒ³/api/auth/callback/yahoo`  \n  \n  \næ³¨æ„ç‚¹ã¨ã—ã¦ã€Yahoo!JAPAN IDã‚’ãƒ­ã‚°ã‚¤ãƒ³ã«åˆ©ç”¨ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åå‰ã‚„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã—ãŸã„å ´åˆã¯ä»¥ä¸‹ã§æ¡ˆå†…ã•ã‚Œã¦ã„ã‚‹ç”³ã—è¾¼ã¿ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å¯©æŸ»ãŒå¿…è¦ã¨ãªã‚Šã¾ã™ã€‚Googleã®å ´åˆã¯å¯©æŸ»ãªã—ã§è¡¨ç¤ºåã‚„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ãŒã€Yahoo!JAPANã¯å€‹äººæƒ…å ±ã®æ‰±ã„ã‚’ä¸å¯§ã«è¡Œãªã£ã¦ã„ã‚‹ã“ã¨ãŒä¼ºãˆã¾ã™ã­ã€‚  \n  \n  \n[https://developer.yahoo.co.jp/yconnect/v2/userinfo.html](https://developer.yahoo.co.jp/yconnect/v2/userinfo.html)  \n  \n  \n## å®Ÿè£…  \n  \n  \nåŸºæœ¬çš„ã«ã¯å…ˆã»ã©ç´¹ä»‹ã—ãŸ[ã“ã¡ã‚‰ã®è¨˜äº‹](https://zenn.dev/tfutada/articles/5557b780050574)ã®Googleã§ãƒ­ã‚°ã‚¤ãƒ³ã®éƒ¨åˆ†ã®å®Ÿè£…ã¨åŒã˜ã§ã™ã€‚  \n  \n  \nYahoo!JAPAN IDã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ãŸã‚ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ä½œæˆã—ã€é©ç”¨ã™ã‚‹éƒ¨åˆ†ã ã‘ã‚’åˆ‡ã‚Šå‡ºã—ã¦ã¿ã¾ã—ãŸã€‚  \n  \n  \nyahoo-japan-id-provider.ts  \n  \n  \n```typescript  \nimport { OAuthConfig } from \"next-auth/providers/oauth\";  \n  \nexport const YahooJapanIdProvider: OAuthConfig<any> = {  \n  id: \"yahoo\",  \n  name: \"yahoo\",  \n  issuer: \"https://auth.login.yahoo.co.jp/yconnect/v2\",  \n  wellKnown:  \n    \"https://auth.login.yahoo.co.jp/yconnect/v2/.well-known/openid-configuration\",  \n  version: \"2.0\",  \n  type: \"oauth\",  \n  authorization: {  \n    url: \"https://auth.login.yahoo.co.jp/yconnect/v2/authorization\",  \n    params: { scope: \"openid\" }, // å±æ€§æƒ…å ±å–å¾—ã®å¯©æŸ»ãŒé€šã£ãŸå ´åˆã«ã‚¹ã‚³ãƒ¼ãƒ—ã‚’è¿½åŠ ã™ã‚‹  \n  },  \n  token: \"https://auth.login.yahoo.co.jp/yconnect/v2/token\",  \n  userinfo: \"https://userinfo.yahooapis.jp/yconnect/v2/attribute\",  \n  idToken: true,  \n  clientId: process.env.YAHOO_CLIENT_ID,  \n  clientSecret: process.env.YAHOO_CLIENT_SECRET,  \n  checks: [\"state\"],  \n  profile: (profile: any) => {  \n    /*  \n    yahooã®id tokenã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã‚‹ â€» userã®æƒ…å ±ã¯ã‚¹ã‚³ãƒ¼ãƒ—ãŒæŒ‡å®šã§ããªã„ãŸã‚å…¥ã£ã¦ã„ãªã„  \n    profile {  \n        aud: string[];  \n        exp: number;  \n        iss: 'https://auth.login.yahoo.co.jp/yconnect/v2';  \n        iat: number;  \n        sub: string;  \n        amr: string[];  \n        at_hash: string;  \n        }  \n    ref: https://developer.yahoo.co.jp/yconnect/v2/id_token.html  \n  \n    ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ç­‰ã‚’å–å¾—ã—ãŸã„å ´åˆï¼ˆuserInfoã‚’å©ããŸã„å ´åˆï¼‰ã¯å¯©æŸ»ã‚’çµŒãŸä¸Šã§ã‚¹ã‚³ãƒ¼ãƒ—ã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚  \n    ref: https://developer.yahoo.co.jp/yconnect/v2/userinfo.html  \n    */  \n    return {  \n      id: profile.sub,  \n    };  \n  },  \n};  \n```  \n  \n  \nå…ˆã»ã©å–å¾—ã—ãŸclinet id, ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¯ä»¥ä¸‹ã®éƒ¨åˆ†ã§åˆ©ç”¨ã—ã¦ãŠã‚Šã€ç’°å¢ƒå¤‰æ•°ã«æŒ‡å®šã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  \n  \n  \n> process.env.YAHOO_CLIENT_ID,    \n> process.env.YAHOO_CLIENT_SECRET,  \n  \n  \nnext-auth-options.ts  \n  \n  \n```typescript  \n  \nimport type { NextAuthOptions } from \"next-auth\";  \nimport { YahooJapanIdProvider } from \"./yahoo-japan-id-provider\";  \n  \nexport const nextAuthOptions: NextAuthOptions = {  \n  debug: process.env.NODE_ENV !== \"production\",  \n  session: { strategy: \"jwt\" },  \n  providers: [  \n    YahooJapanIdProvider,  \n  ],  \n  callbacks: {  \n    jwt: async ({ token, user, account, profile }) => {  \n      return token;  \n    },  \n    session: ({ session, token }) => {  \n      return {  \n        ...session,  \n        user: {  \n          ...session.user, // å±æ€§æƒ…å ±å–å¾—ãŒå¯èƒ½ãªå ´åˆã¯ã“ã¡ã‚‰ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒå…¥ã‚‹ã‹ï¼Ÿï¼Ÿ  \n          id: token.sub,  \n        },  \n      };  \n    },  \n  },  \n};  \n  \n```  \n  \n  \nãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ  \n  \n  \n```typescript  \n\"use client\";  \n  \nimport { signIn } from \"next-auth/react\";  \n  \nconst LoginButton = () => {  \n  const handleLogin = (provider: string) => async (event: React.MouseEvent) => {  \n    event.preventDefault();  \n    const result = await signIn(provider);  \n  };  \n  \n  return (  \n      <form className=\"w-full mt-6 max-w-xs space-y-6 rounded bg-white p-8 shadow-md\">  \n        <button  \n          onClick={handleLogin(\"yahoo\")}  \n          type=\"button\"  \n          className=\"w-full bg-red-500 text-white rounded-lg px-4 py-2\"  \n        >  \n          Yahoo!JapanIDã§ãƒ­ã‚°ã‚¤ãƒ³  \n        </button>  \n      </form>  \n     )  \n```  \n  \n  \napp/api/auth/[â€¦nextauth]/route.ts  \n  \n  \n```typescript  \nimport NextAuth from \"next-auth\";  \n  \nimport { nextAuthOptions } from \"../../next-auth-options\";  \n  \nconst handler = NextAuth(nextAuthOptions);  \n  \nexport { handler as GET, handler as POST };  \n```  \n  \n","date":"2024-09-29T00:00:00.000Z"},{"slug":"npm-workspace-shared","title":"npm workspaceã‚’ç”¨ã„ã¦å…±é€šå‡¦ç†ã‚’packageã¨ã—ã¦åˆ‡ã‚Šå‡ºã™","tags":["tech","next","npm"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \nä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹æˆã§ãƒ¢ãƒãƒ¬ãƒã§ã¯ã‚ã‚‹ã‚‚ã®ã®ã€ãã‚Œãã‚Œç‹¬ç«‹ã—ãŸnodeãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§é‹ç”¨ã—ã¦ã„ãŸçŠ¶æ…‹ã‹ã‚‰ã€npm workspaceã‚’ç”¨ã„ã¦å…±é€šå‡¦ç†ç½®ãå ´(sharedãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ)ã‚’ä½œæˆã—ãŸã®ã§ãã®æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚  \n  \n  \n```text\n.  \nâ”œâ”€â”€ backend  \nâ”‚   â”œâ”€â”€ package.json  \nâ”‚   â””â”€â”€ package-lock.json  \nâ”œâ”€â”€ frontend  \nâ”‚   â”œâ”€â”€ next.config.ts  \nâ”‚   â”œâ”€â”€ package.json  \nâ”‚   â””â”€â”€ package-lock.json  \nâ””â”€â”€ supabase  \n    â”œâ”€â”€ migrations  \n    â””â”€â”€ schema.sql  \n```  \n  \n  \n**workspaceç§»è¡Œå¾Œã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ**   \n  \n  \n```text\n.  \nâ”œâ”€â”€ backend  \nâ”‚   â””â”€â”€ package.json  \nâ”œâ”€â”€ frontend  \nâ”‚   â”œâ”€â”€ next.config.ts  \nâ”‚   â””â”€â”€ package.json  \nâ”œâ”€â”€ node_modules  \nâ”œâ”€â”€ package-lock.json  \nâ”œâ”€â”€ package.json  \nâ”œâ”€â”€ shared  \nâ”‚   â””â”€â”€ package.json  \nâ””â”€â”€ supabase  \n    â”œâ”€â”€ migrations  \n    â””â”€â”€ schema.sql  \n```  \n  \n  \nãã‚‚ãã‚‚npm workspaceã¨ã¯ã¨ã„ã†æ–¹ã¯ä»¥ä¸‹ã®è¨˜äº‹ãŒã™ã”ãã‚ã‹ã‚Šã‚„ã™ã‹ã£ãŸã®ã§ãŠã™ã™ã‚ã§ã™ã€‚  \n  \n  \n<Bookmark href=\"https://zenn.dev/suin/scraps/20896e54419069\" />\n  \n  \n## ã‚„ã£ãŸã“ã¨   \n  \n  \n### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«workspaceç”¨ã®package.jsonä½œæˆ   \n  \n  \n```json  \n{  \n  \"name\": \"your-app\",  \n  \"private\": true,  \n  \"workspaces\": [  \n    \"frontend\",  \n    \"backend\",  \n    \"shared\"  \n  ],  \n  \"scripts\": {  \n    \"build\": \"npm run build --workspaces\"  \n  },  \n  \"devDependencies\": {  \n    \"@types/node\": \"^22.13.1\",  \n    \"typescript\": \"^5.7.3\"  \n  }  \n}  \n```  \n  \n  \nå…¨ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§åˆ©ç”¨ã™ã‚‹ã‚ˆã†ãªdependenciesã¯ãƒ«ãƒ¼ãƒˆã«æŒ‡å®šã—ã¦ãŠãã“ã¨ãŒã§ãã¾ã™ã€‚  \n  \n  \nnodeã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è§£æ±ºã§ã¯ãƒ›ã‚¤ã‚¹ãƒ†ã‚£ãƒ³ã‚°ï¼ˆhoisting, å·»ãä¸Šã’ï¼‰ã¨ã„ã†æ©Ÿèƒ½ãŒã‚ã‚Šã€è‡ªåˆ†ã®node_modulesã«è©²å½“ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒãªã„å ´åˆã¯è¦ªã®node_modulesã«è©²å½“ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¢ã—ã«è¡Œãã¨ã„ã†æ©Ÿèƒ½ã«ã‚ˆã‚‹æ©æµã§ã™ã€‚  \n  \n  \n### sharedãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ  \n  \n  \nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ  \n  \n  \n```json  \n.  \nâ”œâ”€â”€ dist  \nâ”œâ”€â”€ package.json  \nâ”œâ”€â”€ src  \nâ”‚   â”œâ”€â”€ date.ts  \nâ”‚   â””â”€â”€ index.ts  \nâ””â”€â”€ tsconfig.json  \n```  \n  \n  \nshared/package.json  \n  \n  \n```json  \n{  \n    \"name\": \"@your-app/shared\",  \n    \"private\": true,  \n    \"version\": \"1.0.0\",  \n    \"main\": \"dist/index.js\",  \n    \"types\": \"dist/index.d.ts\",  \n    \"scripts\": {  \n      \"build\": \"tsc\",  \n      \"watch\": \"tsc -w\"  \n    }  \n  }  \n```  \n  \n  \nshared/tsconfig.json  \n  \n  \n```json  \n{  \n  \"compilerOptions\": {  \n    \"target\": \"es2018\",  \n    \"module\": \"commonjs\",  \n    \"declaration\": true,  \n    \"outDir\": \"./dist\",  \n    \"strict\": true,  \n    \"esModuleInterop\": true,  \n    \"skipLibCheck\": true,  \n    \"forceConsistentCasingInFileNames\": true  \n  },  \n  \"include\": [\"src\"],  \n  \"exclude\": [\"node_modules\", \"dist\", \"**/*.test.ts\"]  \n}  \n  \n```  \n  \n  \nshared/index.ts  \n  \n  \n```json  \nexport * from \"./date\";  \n```  \n  \n  \nshared/date.ts  \n  \n  \n```typescript  \nexport const getDateStringBeforeN = (n: number) => {  \n  const today = new Date();  \n  const targetDate = new Date(today);  \n  targetDate.setDate(today.getDate() - n);  \n  \n  const year = targetDate.getFullYear();  \n  const month = String(targetDate.getMonth() + 1).padStart(2, \"0\");  \n  const day = String(targetDate.getDate()).padStart(2, \"0\");  \n  return `${year}-${month}-${day}`;  \n};  \n```  \n  \n  \nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’buildã—ã¦ãŠã  \n  \n  \n```shell  \nnpm run build -w shared  \n```  \n  \n  \n### frontendå´ã®ä¿®æ­£  \n  \n  \nsharedã‚’frontendå´ã®ä¾å­˜ã«è¿½åŠ ã™ã‚‹  \n  \n  \n```shell  \nnpm i @your-app/shared -w @you-app/frontend  \n```  \n  \n  \nsharedã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹  \n  \n  \n```typescript  \nimport { getDateStringBeforeN } from \"@your-app/shared\";  \n```  \n  \n  \n**æ³¨æ„ç‚¹**  \n  \n  \nå…ƒã€…å­˜åœ¨ã—ã¦ã„ãŸnode_moduleã¨package-lock.jsonã‚’æ‰‹å‹•ã§å‰Šé™¤ã—ã¦ã‹ã‚‰ãƒ«ãƒ¼ãƒˆã«ã¦ `npm install` ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’å®Ÿæ–½ã—ãªã„ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ã§å…±é€šå‡¦ç†ã‚’æ­£ã—ãimportã§ããªã„ã¨æ€ã„ã¾ã™ã€‚  \n  \n  \n```text\nModule not found: Can't resolve '@your-app/shared'  \n```  \n  \n  \næœ€å¾Œã«buildã‚³ãƒãƒ³ãƒ‰ã§sharedãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¸€ç·’ã«buildã•ã‚Œã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚  \n  \n  \n```typescript  \n  \"scripts\": {  \n    \"build\": \"npm --workspace=@you-app/shared run build && next build\"  \n  },  \n```  \n  \n  \n## æœ€å¾Œã«  \n  \n  \nå…¨ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒshared/index.tsã«ã¾ã¨ã¾ã£ã¦ä¸€æ‹¬ã§importã™ã‚‹æ§‹æˆã¯ãªã‚“ã‹å¾®å¦™ãªæ°—ãŒã™ã‚‹å ´åˆã¯exportã‚’åˆ©ç”¨ã™ã‚‹æ‰‹ã‚‚ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚  \n  \n  \n<Bookmark href=\"https://zenn.dev/makotot/articles/5edb504ef7d2e6\" />\n  \n","date":"2025-02-08T00:00:00.000Z"},{"slug":"pageviews-by-gadataapi","title":"Google Analytics Data APIã‚’åˆ©ç”¨ã—ã¦PVæ•°ã¨äººæ°—è¨˜äº‹ã‚’å–å¾—ã™ã‚‹","tags":["tech","GCP"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \n## ã¯ã˜ã‚ã«  \n  \n  \nå€‹äººãƒ–ãƒ­ã‚°ã®è¨˜äº‹ã«PVæ•°ã‚’ã¤ã‘ã‚‹éš›ã®æœ€ã«Google Analytics Data APIã‚’åˆ©ç”¨ã—ãŸãŸã‚ã€ãã®æ–¹æ³•ã‚’å‚™å¿˜éŒ²çš„ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚  \n  \n  \nGoogle AnalyticsãŒã™ã§ã«ã‚µã‚¤ãƒˆã«å°å…¥ã•ã‚Œã¦ã„ã¦ã€ã‚ã‚‹ç¨‹åº¦ã®ãƒ‡ãƒ¼ã‚¿ãŒGoogleAnalyticsä¸Šã«ã‚ã‚‹ã“ã¨ãŒå‰æã®è¨˜äº‹ã«ãªã‚Šã¾ã™ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚  \n  \n  \n## äº‹å‰æº–å‚™: APIã®æœ‰åŠ¹åŒ–  \n  \n  \nGoogle Analytics Reporting API ã‚’æœ‰åŠ¹åŒ–ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  \n  \n  \nGCPã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠã—ã€ä»¥ä¸‹APIã‚’æœ‰åŠ¹åŒ–ã—ã¦ãã ã•ã„ã€‚  \n  \n  \n[https://console.cloud.google.com/apis/api/analyticsdata.googleapis.com/metrics](https://console.cloud.google.com/apis/api/analyticsdata.googleapis.com/metrics)   \n  \n  \nå‚è€ƒã¾ã§ã«å…¬å¼ã®quick startã®ãƒªãƒ³ã‚¯ã‚‚è²¼ã£ã¦ãŠãã¾ã™  \n[https://developers.google.com/analytics/devguides/reporting/data/v1/quickstart-client-libraries?hl=ja](https://developers.google.com/analytics/devguides/reporting/data/v1/quickstart-client-libraries?hl=ja)  \n  \n  \n## Google Analytics Data APIã‚’å©ã  \n  \n  \n`pagePath`ã®dimensionsã§ã€`screenPageViews`ã®metricsã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãƒšãƒ¼ã‚¸ã”ã¨ã®viewæ•°ã‚’å–å¾—ã§ãã‚‹ã€‚  \n  \n  \nslugã«å¯¾ã™ã‚‹PVæ•°ã‚’ã‚‚ã¤è¾æ›¸å‹ã‚’è¿”ã™ã‚ˆã†ã«å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚  \n  \n  \n```typescript  \nimport { BetaAnalyticsDataClient } from '@google-analytics/data'  \n  \nexport class GaApiClient {  \n  private propertyId: string | undefined  \n  \n  private analyticsDataClient: BetaAnalyticsDataClient  \n  \n  constructor() {  \n    this.propertyId = process.env.GA_PROPERTY_ID  \n    this.analyticsDataClient = new BetaAnalyticsDataClient({  \n      credentials: {  \n        type: 'service_account',  \n        project_id: process.env.GCP_SA_PROJECT_ID,  \n        private_key_id: process.env.GCP_SA_PRIVATE_KEY_ID,  \n        private_key: process.env.GCP_SA_PRIVATE_KEY!!.replace(/\\\\n/g, '\\n'), // ç’°å¢ƒå¤‰æ•°ãŒã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦ã—ã¾ã†ãŸã‚ã€å…ƒã«æˆ»ã™  \n        client_email: process.env.GCP_SA_CLIENT_EMAIL,  \n        client_id: process.env.GCP_SA_CLIENT_ID,  \n        universe_domain: 'googleapis.com'  \n      }  \n    })  \n  }  \n  \n  async getPv(): Promise<{ [slug: string]: string }> {  \n    const [response] = await this.analyticsDataClient.runReport({  \n      property: `properties/${this.propertyId}`,  \n      dateRanges: [  \n        {  \n          startDate: '2024-08-25', // ãƒ–ãƒ­ã‚°å…¬é–‹æ—¥ãªã©  \n          endDate: 'today'  \n        }  \n      ],  \n      dimensions: [{ name: 'pagePath' }],  \n      dimensionFilter: {  \n        filter: {  \n          fieldName: 'pagePath',  \n          stringFilter: {  \n            matchType: 'FULL_REGEXP',  \n            value: '/blog/([^/]+)' /* ãƒ–ãƒ­ã‚°ãƒšãƒ¼ã‚¸ã«ã®ã¿ã«çµã‚‹ */  \n          }  \n        }  \n      },  \n      metrics: [{ name: 'screenPageViews' }]  \n    })  \n  \n    const result: { [slug: string]: string } = {}  \n    response.rows?.forEach(row => {  \n      if (row && row.dimensionValues && row.metricValues) {  \n        const path = row.dimensionValues[0].value  \n        const segments =  \n          path?.split('/').filter(segment => segment !== '') ?? [] // ãƒ‘ã‚¹ã‚’ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§åˆ†å‰²  \n  \n        // \"/blog/{slug}\" ã®ãƒ‘ã‚¹ã‚’é©åˆ‡ã«åˆ†å‰²ã§ãã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯  \n        if (segments.length === 2 && segments[0] === 'blog') {  \n          const slug = segments[1]  \n          const views = row.metricValues[0].value!  \n          result[slug] = views  \n        }  \n      }  \n    })  \n    return result  \n  }  \n  \n  async getPopularPostData() {  \n    const [response] = await this.analyticsDataClient.runReport({  \n      property: `properties/${this.propertyId}`,  \n      dateRanges: [  \n        {  \n          startDate: '30daysAgo', // éå»30æ—¥ã®äººæ°—è¨˜äº‹ã‚’å–å¾—  \n          endDate: 'today'  \n        }  \n      ],  \n      dimensions: [  \n        {  \n          name: 'pagePath'  \n        }  \n      ],  \n      dimensionFilter: {  \n        filter: {  \n          fieldName: 'pagePath',  \n          stringFilter: {  \n            matchType: 'FULL_REGEXP',  \n            value: '/blog/([^/]+)' /* ãƒ–ãƒ­ã‚°ãƒšãƒ¼ã‚¸ã«ã®ã¿ã«çµã‚‹ */  \n          }  \n        }  \n      },  \n      metrics: [  \n        {  \n          name: 'screenPageViews'  \n        }  \n      ],  \n      orderBys: [  \n        {  \n          desc: true,  \n          metric: {  \n            metricName: 'screenPageViews'  \n          }  \n        }  \n      ],  \n      limit: 10 // 10è¨˜äº‹ã¾ã§ã®ãƒ‘ã‚¹ã‚’å–å¾—  \n    })  \n    console.log('popular Report result:')  \n    response.rows?.forEach(row => {  \n      console.log(  \n        row.dimensionValues && row.dimensionValues[0],  \n        row.metricValues && row.metricValues[0]  \n      )  \n    })  \n  }  \n}  \n```  \n  \n  \nãã®ä»–ã€dimensions, metrics ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´ã™ã‚‹ã¨ãã‚Œãã‚Œã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«åˆã‚ã›ãŸãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´ã™ã‚‹éš›ã«å‚è€ƒã«ãªã‚Šãã†ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¾¤ã‚’ç½®ã„ã¦ãŠãã¾ã™  \n  \n- å…¬å¼Doc: [https://developers.google.com/analytics/devguides/reporting/data/v1?hl=ja](https://developers.google.com/analytics/devguides/reporting/data/v1?hl=ja)  \n- node ã® clinet ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: [https://googleapis.dev/nodejs/analytics-data/latest/index.html](https://googleapis.dev/nodejs/analytics-data/latest/index.html)  \n- ã‚¯ã‚¨ãƒªã§ä½¿ç”¨ã™ã‚‹ã€dimensions, metricsã§åˆ©ç”¨ã§ãã‚‹å€¤: [https://developers.google.com/analytics/devguides/reporting/data/v1/api-schema?hl=ja#dimensions](https://developers.google.com/analytics/devguides/reporting/data/v1/api-schema?hl=ja#dimensions)  \n  \n## ãŠã‚ã‚Šã«  \n  \n  \nâ€» Google Analytics Data APIã¯ã€æ–™é‡‘ã¯ã‹ã‹ã‚‰ãªã„ã‚ˆã†ã§ã™ãŒã€ä»¥ä¸‹ãƒšãƒ¼ã‚¸ã«ã‚ã‚‹Quotasã‚’ä¸Šå›ã‚‹ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¤±æ•—ã™ã‚‹ã¨ã„ã†åˆ¶é™ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚ã”æ³¨æ„ãã ã•ã„ã€‚  \n[https://developers.google.com/analytics/devguides/reporting/data/v1/quotas?hl=ja](https://developers.google.com/analytics/devguides/reporting/data/v1/quotas?hl=ja)  \n  \n  \nä»¥ä¸‹ã€å…¬å¼docä»¥å¤–ã§å®Ÿè£…ã®éš›ã«å‚è€ƒã«ã•ã›ã¦ã„ãŸã ã„ãŸè¨˜äº‹ã§ã™ğŸ™  \n  \n- [**Node.js (TypeScript) ã§ Google Analytics Reporting API v4 ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•**](https://fwywd.com/tech/ga-popular-node-ts)  \n- [**Google Analytics Reporting APIã§ã®ç™ºç”Ÿã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã‚’ç¢ºèªã™ã‚‹**](https://ponsuke-tarou.hatenablog.com/entry/2021/03/25/150451)  \n- [**Gatsbyã§ä½œã£ãŸã‚µã‚¤ãƒˆã«äººæ°—è¨˜äº‹ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’å®Ÿè£…ã™ã‚‹ã€å‰ç·¨ã€‘**](https://komari.co.jp/column/14935/)  \n  \n<Bookmark href=\"https://fwywd.com/tech/ga-popular-node-ts\" />\n  \n  \n<Bookmark href=\"https://ponsuke-tarou.hatenablog.com/entry/2021/03/25/150451\" />\n  \n  \n<Bookmark href=\"https://komari.co.jp/column/14935/\" />\n  \n","date":"2024-09-11T15:00:00.000Z"},{"slug":"remix-notion-blog-give-up","title":"remix ã¨ notion apiã§ãƒ–ãƒ­ã‚°ã‚’æ§‹ç¯‰ã—ã‚ˆã†ã¨ã—ãŸãŒæ–­å¿µã—ãŸè©±","tags":["tech","remix","notion"],"content":"\n  \n## æ§‹ç¯‰ã—ã‚ˆã†ã¨ã—ãŸãƒ–ãƒ­ã‚°ã®è¦ä»¶  \n  \n- remixã‚’ä½¿ã„ãŸã„  \n\t- ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚ã‚‹ã‚ã‚‹ã§ã™ãŒã€ç›®çš„ã¨æ‰‹æ®µãŒä¸€è‡´ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚remixã‚’åˆ©ç”¨ã—ãŸã„ãŒä½œã‚‹ã‚‚ã®ãŒãªã‹ã£ãŸã®ã§å€‹äººãƒ–ãƒ­ã‚°ã‚’ä½œã‚‹ã“ã¨ã«ã—ãŸæ„Ÿã˜ã§ã™ã€‚  \n- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¯notion  \n\t- ä»¥å‰contentfulã§å€‹äººãƒ–ãƒ­ã‚°ã‚’å§‹ã‚ã¾ã—ãŸãŒã€contentfulã‚’é–‹ãã“ã¨ãŒé¢å€’ã«ãªã£ã¦ã—ã¾ã„ç¶šã‹ãªã‹ã£ãŸã¨ã„ã†çµŒé¨“ãŒã‚ã‚‹ãŸã‚ã€CMSã¯åˆ©ç”¨ã›ãšã«notion apiã‚’åˆ©ç”¨ã—ãŸã„ã§ã™ã€‚  \n- ç„¡æ–™ã§é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹  \n  \nã“ã¡ã‚‰ã®3è»¸ã§ãƒ–ãƒ­ã‚°ä½œæˆã‚’çœŸé¢ç›®ã«æ¤œè¨ã—ã€ä½œæˆã—ã¾ã—ãŸãŒæ–­å¿µã—ãŸã®ã§ãã®è¨˜éŒ²ã‚’ã¾ã¨ã‚ã¾ã™ã€‚  \n  \n  \n## ç’°å¢ƒ  \n  \n- remix-run: 2.10  \n- react: 19rc  \n- ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆ: cloudflare pages  \n  \n## ã‚„ã£ãŸã“ã¨  \n  \n- remixãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ  \n- notion api å–å¾—å‡¦ç†  \n- å–å¾—ã—ãŸè¨˜äº‹ä¸€è¦§ã€è¨˜äº‹è©³ç´°ãƒšãƒ¼ã‚¸ã®è¿½åŠ   \n- EDGEç’°å¢ƒã§ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‡¦ç†å®Ÿè£…  \n- Google Analyticsè¨­å®šã€è¨˜äº‹ãƒšãƒ¼ã‚¸ã®ãƒ“ãƒ¥ãƒ¼æ•°å–å¾—  \n  \n## ã‚„ã£ã¦ã¿ãŸçµæœæ€ã£ãŸã“ã¨  \n  \n  \næ¤œè¨ã€åˆ¶ä½œã‚’é€²ã‚ã‚‹ã«ã¤ã‚Œã¦ã“ã‚Œã¾ã§ã«è¦‹ãˆã¦ã„ãªã‹ã£ãŸremixã®ç‰¹å¾´ãŒç™ºè¦šã—ã€notion apiã¨ã®ç›¸æ€§ã®æ‚ªã•ã‹ã‚‰æ–­å¿µã—ã¾ã—ãŸã€‚  \n  \n- remixã¯Edgeç’°å¢ƒã§å‹•ä½œã™ã‚‹ã“ã¨ãŒå‰æã®ãŸã‚ã€node.jsä¾å­˜ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã§ããªã„ã€‚  \ncloudflareã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ [Home - Cloudflare WorkersÂ®](https://workers.cloudflare.com/) ãŒEdgeç’°å¢ƒã«ãªã‚Šã¾ã™  \n\t- [@google-analytics/data](https://www.npmjs.com/package/@google-analytics/data) ã‚’ç”¨ã„ã¦GAã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã‚ˆã†ã¨ã—ãŸãŒã€node.jsä¾å­˜ã®ãŸã‚api ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹éƒ¨åˆ†ã‚’è‡ªåˆ†ã§å®Ÿè£…ã™ã‚‹ç¾½ç›®ã«â€¦  \n\t- node.jsã®fsãŒä½¿ãˆãªã„ãŸã‚ã€mdãƒ•ã‚¡ã‚¤ãƒ«ã‚’fsã‚’ç”¨ã„ã¦ read ã—ã¦â€¦ ã¨ã„ã£ãŸã“ã¨ãŒã§ããªã„ã€‚ãã‚‚ãã‚‚Edgeç’°å¢ƒã«ã‚ã’ã‚‰ã‚Œã‚‹buildå¾Œã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«mdãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚ã‚‹ã“ã¨ãŒé›£ã—ã„ã€‚  \n- Edgeç’°å¢ƒã§æ¯åº¦SSRã™ã‚‹ã“ã¨ã‚’å£²ã‚Šã«ã—ã¦ãŠã‚Šã€ã‚¢ãƒ³ãƒSSGã¨ã„ã†å§¿å‹¢ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãŸã‚ã€SSRã™ã‚‹ã”ã¨ã« notion api ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚  \nnotion api ã¯ 3rpsä»¥ä¸Šãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã¨ãªã‚‹ãŸã‚ã€SSRç’°å¢ƒã§éƒ½åº¦å–å¾—ã¯çµ¶æœ›çš„  \n[https://developers.notion.com/reference/request-limits](https://developers.notion.com/reference/request-limits)  \n\t- ãã“ã§ã‚ã’ã‚‰ã‚Œã‚‹æ–¹æ³•ã¨ã—ã¦ã€ã‚ã‚‰ã‹ã˜ã‚notionã®å†…å®¹ã‚’repositoryã«è‡ªå‹•ã§ä¿å­˜ã—ã¦ãŠãæ–¹æ³•ã§ã™ãŒã€ã“ã¡ã‚‰ã¯ node.jsãŒä½¿ãˆãªã„ãŸã‚ã€ä¸å¯èƒ½ã§ã—ãŸã€‚  \n\t- å”¯ä¸€æ®‹ã£ã¦ã„ã‚‹æ–¹æ³•ãŒã€notionã®å†…å®¹ã‚’ react ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å«ã¾ãªã„mdxã¨ã—ã¦ä¿å­˜ã™ã‚‹è‡ªå‹•åŒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ã€route/ é…ä¸‹ ã«è‡ªå‹•ã§mdxãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¢—ã‚„ã—ç¶šã‘ã‚‹æ–¹æ³•ã®ã¿ã§ã—ãŸã€‚mdxã®ã¿ã€remixãŒbuildæ™‚ã«æ¢±åŒ…ã™ã‚‹ã“ã¨ã‚’built-inã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€remixã®å¥¨åŠ±æ–¹æ³•ã§ã‚ã‚‹ã¨è¨€ãˆãã†ã§ã™ã€‚  \n\t[https://remix.run/docs/en/main/guides/mdx](https://remix.run/docs/en/main/guides/mdx)  \n\t- ã—ã‹ã—ã€mdxã§ä½œã‚‹æ–¹æ³•ã‚’æ¡ç”¨ã™ã‚‹å ´åˆã€ãƒ–ãƒ­ã‚°ä¸€è¦§ãƒšãƒ¼ã‚¸ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ãŒé›£ã—ã„ãã†ã€‚  \n\t`window.__remixManifest.routes` ã‚’è¦‹ã‚Œã°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã‹ã‚‰å…¨ã¦ã®routeã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹ãŒã€ssræ™‚ç‚¹ã§å‹•çš„ã«å–å¾—ã™ã‚‹æ–¹æ³•ã¯è‡ªåˆ†ã®è¦³æ¸¬ç¯„å›²å†…ã§ã¯ãªã•ãã†ã€‚åˆ¥é€”`blogList.server.ts`ç­‰ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦è¨˜äº‹ä¸€è¦§ã‚’ç®¡ç†ã—ã¦ã„ã‚‹ãƒ–ãƒ­ã‚°å¤šãã†ã ãŒã€ã“ã‚Œã¯ã‚„ã‚ŠãŸããªã„ã€‚  \n  \n## ãŠã‚ã‚Šã«  \n  \n  \nä»Šå›ã®è¦ä»¶ã®å ´åˆã€è«¦ã‚ã¦Next.jsã§ã®æ§‹ç¯‰ã«åˆ‡ã‚Šæ›¿ãˆã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚  \nnotion api ã‚’ç”¨ã„ã¦ç„¡æ–™ã§ãƒ–ãƒ­ã‚°ã‚’æ§‹ç¯‰ã™ã‚‹å ´åˆã€ä»¥ä¸‹ã®æµã‚ŒãŒè‰¯ã•ãã†ãªã®ã§è©¦ã—ã¦ã¿ã¾ã™ã€‚  \n  \n- github action ã§ å®šæœŸçš„ã«notion ã‚’ mdã¨ã—ã¦repositoryã«ä¿å­˜  \n- Next.jsã®SSGã§[contentlayer](https://contentlayer.dev/)ã‚’ç”¨ã„ã¦è¨˜äº‹ä¸€è¦§ã‚’æ“ä½œ  \n  \nã‚ãã¾ã§è‡ªåˆ†ãŒremixã®ç‰¹å¾´ã‚’çŸ¥ã‚‰ãšã«ã¨ã‚Šã‚ãˆãšä½¿ã£ã¦ã¿ãŸã„ã¨å…ˆèµ°ã£ãŸçµæœã§ã‚ã‚Šã€remixã¯ç´ æ™´ã‚‰ã—ã„æŠ€è¡“ã ã¨æ€ã£ã¦ã„ã¾ã™ã€‚ãŸã ã€è‡ªåˆ†ã«ãã‚Œã‚’æ‰±ã†æº–å‚™ã¨æŠ€è¡“åŠ›ãŒãªã‹ã£ãŸâ€¦  \n  \n  \n[Progressive Enhancement](https://remix.run/docs/en/main/discussion/progressive-enhancement)ç­‰ã€Next.jsã®App routerã«å¤šã„ã«å½±éŸ¿ã‚’ä¸ãˆã¦ãŠã‚Šã€è€ƒãˆæ–¹ã‚„å“²å­¦ã¯ä»Šã§æœ¬å½“ã«ç´ æ•µã ãªã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚  \n  \n","date":"2024-08-31T00:00:00.000Z"},{"slug":"slides-browsing","title":"ã‚¹ãƒ©ã‚¤ãƒ‰å¾˜å¾Šã®ã™ã™ã‚","tags":["poem"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \nå€‹äººçš„ã«æ–°ã—ã„æŠ€è¡“ã‚’ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã™ã‚‹éš›ã€ã¾ãšæœ€åˆã«æ—¢å­˜ã®å‹‰å¼·ä¼šãªã©ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ã‚¹ãƒ©ã‚¤ãƒ‰å…±æœ‰ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰æ¢ã—ã¦å…¨ä½“ã‚’æŠŠæ¡ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚ã“ã¡ã‚‰ã®æ–¹æ³•ãŒæ„å¤–ã¨ãŠå‹§ã‚ãªã®ã§ã€ã‚¹ãƒ©ã‚¤ãƒ‰å¾˜å¾Šã‚’å‹§ã‚ã‚‹ã ã‘ã®è¨˜äº‹ã‚’æ›¸ã„ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚  \n  \n  \n## ã‚¹ãƒ©ã‚¤ãƒ‰å¾˜å¾Šã®ãƒ¡ãƒªãƒƒãƒˆ  \n  \n- æ¦‚å¿µãƒ™ãƒ¼ã‚¹ã§ã‚ã‹ã‚Šã‚„ã™ãã¾ã¨ã¾ã£ã¦ãŠã‚Šã€ã™ãã«å…¨ä½“åƒã‚’æ´ã‚ã‚‹ã‚¹ãƒ©ã‚¤ãƒ‰ãŒå­˜åœ¨ã™ã‚‹  \n- ã‚¹ãƒ©ã‚¤ãƒ‰ã‹ã‚‰å‹‰å¼·ä¼šã®youtubeã«é£›ã¹ã‚‹ã“ã¨ãŒã§ãã‚‹ã“ã¨ã‚‚ã€‚å‹‰å¼·ä¼šã®å­˜åœ¨ã‚’çŸ¥ã‚‹ãã£ã‹ã‘ã«ã‚‚ã‚¹ãªã‚‹  \n- ã™ã§ã«ã‚ˆãä½¿ã†æŠ€è¡“ã§ã‚ã£ã¦ã‚‚ã€ã‚¹ãƒ©ã‚¤ãƒ‰å¾˜å¾Šã—ã¦ã„ã‚‹ã¨æ–°ã—ã„ä½¿ã„æ–¹ã«å‡ºä¼šã£ã¦è‡ªãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®æ”¹å–„ã®ãã£ã‹ã‘ã«ãªã‚‹ã€‚ï¼ˆã‚»ãƒ¬ãƒ³ãƒ‡ã‚£ãƒ”ãƒ†ã‚£çš„ãªï¼Ÿï¼‰  \n  \n## ã‚¹ãƒ©ã‚¤ãƒ‰å…±æœ‰ã‚µãƒ¼ãƒ“ã‚¹3é¸  \n  \n  \n### slideshare  \n  \n  \n<Bookmark href=\"https://www.slideshare.net/\" />\n  \n  \nJavaã§æ¤œç´¢ã—ãŸéš›ã®ä¾‹:  \n[https://www.slideshare.net/search?searchfrom=header&q=java&language=ja&sort=RECENT](https://www.slideshare.net/search?searchfrom=header&q=java&language=ja&sort=RECENT)  \n  \n  \nå…¨åˆ†é‡ã®ã‚¹ãƒ©ã‚¤ãƒ‰ãŒã‚ã‚‹ã®ã§ã€æŠ€è¡“ã®ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’æ¢ãã†ã¨ã™ã‚‹ã¨ãƒã‚¤ã‚ºãŒå¤šã‚  \n  \n  \n### **Speaker Deck**  \n  \n  \n<Bookmark href=\"https://speakerdeck.com/\" />\n  \n  \nJavaã§æ¤œç´¢ã—ãŸéš›ã®ä¾‹:  \n[https://speakerdeck.com/search?page=1&q=java&lang=ja](https://speakerdeck.com/search?page=1&q=java&lang=ja)  \n  \n  \næ´—ç·´ã•ã‚ŒãŸå†…å®¹ã®ã‚¹ãƒ©ã‚¤ãƒ‰ãŒå¤šã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã€æœ€ã‚‚å¾˜å¾Šã—ã¦ã„ã¦æ¥½ã—ã„ã€‚  \n  \n  \n### **Docswell**  \n  \n  \n<Bookmark href=\"https://www.docswell.com/\" />\n  \n  \næ—¥æœ¬ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å‘ã‘ã«é–‹ç™ºã•ã‚Œã¦ãŠã‚Šã€å€‹äººçš„ã«ã‚‚æœ€ã‚‚UXãŒè‰¯ã„ã¨æ„Ÿã˜ã¦ã„ã‚‹ã€‚ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ãªå†…å®¹ã‹ã‚‰æŠ€è¡“ä»•æ§˜ã®è©³ç´°è§£èª¬ã¾ã§å­˜åœ¨ã™ã‚‹ã€‚  \n  \n  \nJavaã§ã‚¿ã‚°æ¤œç´¢ã—ãŸéš›ã®ä¾‹:  \n[https://www.docswell.com/tag/Java](https://www.docswell.com/tag/Java)  \n  \n  \nãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‹¬è‡ªã§ã¤ã‘ãŸã‚¿ã‚°ã§ã‚½ãƒ¼ãƒˆã§ãã‚‹ã®ãŒè‰¯ã„æ„Ÿã˜ã€‚  \n  \n  \n## javaå­¦ç¿’ã§èª­ã‚“ã§ã‚ˆã‹ã£ãŸã‚¹ãƒ©ã‚¤ãƒ‰ãŸã¡  \n  \n  \nãã‚Šæ–‡æ³•ãŒã‚ã‹ã‚‹ãƒ¬ãƒ™ãƒ«ã®javaç†è§£åº¦ã ã£ãŸè‡ªåˆ†ãŒã€java21ã®ç‰¹å¾´ã‚’ãµã‚“ã ã‚“ã«åˆ©ç”¨ã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¸ãƒ§ã‚¤ãƒ³ã™ã‚‹éš›ã«ã¾ãšå‚è€ƒã«ã•ã›ã¦ã‚‚ã‚‰ã£ãŸã‚¹ãƒ©ã‚¤ãƒ‰ãŸã¡ã‚’åˆ—æŒ™ã—ã¾ã™ã€‚  \n  \n- [**Java 21ã®æ¦‚è¦**](https://speakerdeck.com/kishida/outline-of-java-21)  \n- [**Java21ã¨Kotlinã®ä»£æ•°çš„ãƒ†ã‚™ãƒ¼ã‚¿å‹ & ãƒã‚šã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã®ç´¹ä»‹ã¨æœ¬å½“ã«å¬‰ã—ã„ä½¿ã„æ–¹**](https://speakerdeck.com/yuitosato/algebraic-data-type-in-java-and-kotlin-happy-use-of-pattern-match)  \n- [**Javaã®ç¾çŠ¶2024å¤**](https://speakerdeck.com/kishida/java-current-status-2024-summer)  \n- [**Springã®ã“ã‚Œã¾ã¦ã‚™ã¨ã“ã‚Œã‹ã‚‰ #javasumi23**](https://www.docswell.com/s/MasatoshiTada/ZVV7NV-spring-current-and-future)  \n\t- â€» ã“ã¡ã‚‰ã®ã‚¹ãƒ©ã‚¤ãƒ‰å†…ã§ã‚‚ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ä»¥ä¸‹å‹•ç”»ã¯ã€ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ¡ãƒ¼ã‚¸ãªã© Spring Boot 3 ã®æ©Ÿèƒ½ã‚’ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã—ãŸã„äººã«ã¨ã£ã¦æ„Ÿå‹•çš„ã«ã‚ã‹ã‚Šã‚„ã™ã‹ã£ãŸã§ã™ã€‚  \n\t[**B 1500 æ§™ä¿Šæ˜ 5å¹´ã¶ã‚Šã®ãƒ¡ã‚¸ãƒ£ãƒ¼ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ! Spring Framework 6 Spring Boot 3**](https://www.youtube.com/watch?v=tnq4NBrlhHY)  \n- [**ä»Šã“ãçŸ¥ã‚ŠãŸã„Spring DI x AOP #jsug**](https://www.docswell.com/s/MasatoshiTada/Z818E5-spring-di-aop-for-every-developers)  \n  \næœ€å¾Œã«Twitterã«å‹‰å¼·ä¼šã‚¹ãƒ©ã‚¤ãƒ‰ã‚’botåŒ–ã—ã¦ãã‚Œã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚‚ç´¹ä»‹ã—ã¦ãŠãã¾ã™ã€‚  \n  \n  \n[https://x.com/tech_slideshare](https://x.com/tech_slideshare)  \n  \n","date":"2024-11-04T00:00:00.000Z"},{"slug":"standalone-apache-solr-docker","title":"standaloneãƒ¢ãƒ¼ãƒ‰ã®Apache Solrã‚’Dockerã§å‹•ã‹ã—ã¦ã¿ã‚‹","tags":["tech","solr"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \n# standaloneãƒ¢ãƒ¼ãƒ‰ã®**Apache Solrã‚’Dockerã§å‹•ã‹ã—ã¦ã¿ã‚‹**  \n  \n  \nApache Solrã¯å…¨æ–‡æ¤œç´¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒª Apache Licene(ãƒ«ã‚·ãƒ¼ãƒ³)ã‚’ç”¨ã„ãŸæ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã‚µãƒ¼ãƒãƒ¼ã§ã™ã€‚  \n  \n  \nä»¥ä¸‹ã‚’å‚è€ƒã«dockerã‚’ç”¨ã„ãŸstandaloneãƒ¢ãƒ¼ãƒ‰ã‚’å‹•ã‹ã—ã¦ã¿ãŸã®ã§ãã®è¨˜éŒ²ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚  \n  \n  \n<Bookmark href=\"https://solr.apache.org/guide/solr/latest/deployment-guide/solr-in-docker.html\" />\n  \n  \nåˆ©ç”¨ã—ãŸdocker-compose.yaml  \n  \n  \n```yaml  \nversion: '3'  \nservices:  \n  solr:  \n    image: solr  \n    ports:  \n     - \"8983:8983\"  \n    volumes:  \n      - data:/var/solr  \n    command:  \n      - solr-precreate  \n      - gettingstarted  \nvolumes:  \n  data:  \n```  \n  \n  \nèµ·å‹•ã‚³ãƒãƒ³ãƒ‰  \n  \n  \n```shell  \ndocker-compose up --build  \n```  \n  \n  \nèµ·å‹•ã™ã‚‹ã¨ä»¥ä¸‹ã‹ã‚‰solrã®ç®¡ç†ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚  \n  \n  \n[http://localhost:8983/solr/#/](http://localhost:8983/solr/#/) \n  \n  \nã‚³ãƒ³ãƒ†ãƒŠã«å…¥ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ[å‚è€ƒæ›¸ç±](https://gihyo.jp/book/2017/978-4-7741-8930-7)ã«ã‚ã‚‹techproductsã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã™ã‚‹æ–¹æ³•ã¯ãªã•ãã†ï¼‰  \n  \n  \n```shell  \ndocker exec -it solr-solr-1(ãã‚Œãã‚Œã‚³ãƒ³ãƒ†ãƒŠå) bash  \n# tutorialç”¨ã«ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª  \nsolr@09e993203df9:/opt/solr-9.7.0$ ls example/exampledocs/  \nbooks.csv            ipod_video.xml     monitor.xml       sd500.xml         vidcard.xml  \nbooks.json           manufacturers.xml  more_books.jsonl  solr-word.pdf  \ngb18030-example.xml  mem.xml            mp500.xml         solr.xml  \nhd.xml               money.xml          post.jar          test_utf8.sh  \nipod_other.xml       monitor2.xml       sample.html       utf8-example.xml  \n  \n# booksç”¨ã®coreã®ä½œæˆ  \nsolr@09e993203df9:/opt/solr-9.7.0$ bin/solr create -c books  \n# books.jsonã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹  \nsolr@09e993203df9:/opt/solr-9.7.0$ bin/solr post -c books example/exampledocs/books.json  \n```  \n  \n  \nã¾ãŸã€ Solritasã®ç”»é¢ã¯ V9ã§ã¯å‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚  \n  \n  \n> The VelocityResponseWriter and associated /browse UI is deprecated and will be removed in 9.0.    \n> The functionality has been replaced by a 3rd party plugin available atÂ [https://github.com/erikhatcher/solritas](https://github.com/erikhatcher/solritas).  \n  \n  \n[https://solr.apache.org/guide/8_9/velocity-search-ui.html](https://solr.apache.org/guide/8_9/velocity-search-ui.html)  \n  \n  \nã‚µã‚¤ãƒ‰ãƒãƒ¼ã®core selectorã‹ã‚‰booksã‚’é¸æŠã—ã€queryã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«æ¤œç´¢ãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚  \n  \n![alt text](images/standalone-apache-solr-docker/solr-dashboard.png)  \n  \n# Solrã‚’æ‰±ã†éš›ã«å½¹ç«‹ã¡ãã†ãªãƒ¡ãƒ¢  \n  \n  \n## ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‚µãƒ¼ãƒãƒãƒ³ãƒ‰ãƒ©ãƒ¼  \n  \n  \nSolrãŒæä¾›ã™ã‚‹æ¤œç´¢æ©Ÿèƒ½ã¯ã€ã€Œã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€ã¨ã€Œã‚µãƒ¼ãƒãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã€ã«ã‚ˆã£ã¦å®Ÿç¾ã•ã‚Œã¦ã„ã‚‹ã€‚  \n  \n  \nã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®æ¤œç´¢ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã‚µãƒ¼ãƒãƒãƒ³ãƒ‰ãƒ©ãŒå‡¦ç†ã™ã‚‹ã€‚**ã‚µãƒ¼ãƒãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã«ã¯è¤‡æ•°ã®ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã¦ãŠã‚Šã€ã“ã‚Œã‚‰ã®ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒäº’ã„ã«ç‹¬ç«‹ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œã—**ã€æœ€çµ‚çš„ã«å‡¦ç†çµæœã‚’å‡ºåŠ›ã™ã‚‹ã€‚ï¼ˆã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç¨®é¡ã«ã‚ˆã£ã¦ã¯ä¾å­˜é–¢ä¿‚ãŒã‚ã‚Šã€å®Œå…¨ã«ç‹¬ç«‹ã—ã¦ã„ãªã„å ´åˆã‚‚ã‚ã‚‹ã€‚ï¼‰  \n  \n  \n**SolrãŒæä¾›ã™ã‚‹ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æŠœç²‹**  \n  \n  \n| ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå | ã‚¯ãƒ©ã‚¹å                    | æ¦‚è¦                         |  \n| ----------- | ----------------------- | -------------------------- |  \n| query       | solr.QueryComponent     | æ¤œç´¢çµæœã‚’è¿”ã™                    |  \n| facet       | solr.FacetComponent     | ãƒ•ã‚¡ã‚»ãƒƒãƒˆæƒ…å ±ã‚’è¿”ã™                 |  \n| highlight   | solr.HighlightComponent | ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’è¿”ã™              |  \n| suggest     | solr.SuggestComponent   | æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ã‚µã‚¸ã‚§ã‚¹ãƒãƒ§ãƒ³ï¼ˆå…¥åŠ›è£œå®Œï¼‰ã‚’å®Ÿç¾ã™ã‚‹ |  \n| â€¦           |                         |                            |  \n  \n  \nã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚µãƒ¼ãƒãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã«ç™»éŒ²ã™ã‚‹ã«ã¯ã€solrconfig.xmlã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒ³ãƒ‰ãƒ©å®šç¾©å†…ã«ã‚ã‚‹first-components ã¾ãŸã¯ last-components ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåã‚’åˆ—æŒ™ã™ã‚‹  \n  \n  \n```xml  \n<requestHandler name=\"/ã‚µãƒ¼ãƒãƒãƒ³ãƒ‰ãƒ©å\" class=\"solr.SearchHandler\">  \n  <arr name=\"first-components\">  \n    <str>ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå</str>  \n    <str>ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå</str>  \n  </arr>  \n  <arr name=\"last-components\">  \n    <str>ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå</str>  \n    <str>ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå</str>  \n  </arr>  \n</requestHandler>  \n```  \n  \n  \nfisrt-componentsã«ç™»éŒ²ã•ã‚ŒãŸã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å‰ã«ç™»éŒ²ã•ã‚Œã€last-componentsã¯å¾Œã«ç™»éŒ²ã•ã‚Œã‚‹ã€‚  \n  \n  \nâ€» query, facet, highlight, ç­‰ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€æ˜ç¤ºçš„ã«solrconfig.xmlã«ã¦ç™»éŒ²ã™ã‚‹å¿…è¦ãŒãªã„ã€‚  \n  \n  \n## SolrCloudã«ã‚ˆã‚‹ã‚¯ãƒ©ã‚¹ã‚¿é‹ç”¨  \n  \n  \nSolrã§ã¯ã€ä¸Šã§ç´¹ä»‹ã—ãŸstandalneãƒ¢ãƒ¼ãƒ‰ã§ã¯ãªãã€SolrCloudãƒ¢ãƒ¼ãƒ‰ã§å¤§è¦æ¨¡ãªæ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³æ§‹ç¯‰ã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹ã€‚  \n  \n  \nSolrCloudã¯ZooKeeperã‚’åˆ©ç”¨ã—ã¦ã€ãƒãƒ¼ãƒ‰ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­å¤®é›†ä¸­ç®¡ç†ã€åˆ†æ•£ã‚¤ãƒ³ãƒ‡ã‚¯ã‚·ãƒ³ã‚°ã€ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€è‡ªå‹•ãƒ•ã‚§ãƒ¼ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã€ãƒªãƒ¼ãƒ€ãƒ¼ãƒãƒ¼ãƒ‰ï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰ï¼‰ã®è‡ªå‹•é¸å‡ºãªã©ã€ã€Œå˜ä¸€éšœå®³ç‚¹ï¼ˆSingle Point Of Failure : SPOFï¼‰ã€ã‚’æ¥µåŠ›ãªãã™ãŸã‚ã®ä»•çµ„ã¿ãŒå–ã‚Šè¾¼ã¾ã‚Œã¦ã„ã‚‹ã€‚  \n  \n  \n### åˆ†æ•£ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹  \n  \n  \nSolrã§ã¯å¤§é‡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¤‡æ•°ã®ãƒãƒ¼ãƒ‰ã§åˆ†ã‘ã¦æ‰±ã†ã“ã¨ãŒå¯èƒ½ã€‚1ãƒãƒ¼ãƒ‰ã‚ãŸã‚Šã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’å°ã•ãæŠ‘ãˆã¤ã¤ã€ç†è«–çš„ã«ã¯å·¨å¤§ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ§‹ç¯‰ã§ãã‚‹ã€‚ãã®è¤‡æ•°ã®ãƒãƒ¼ãƒ‰ã«åˆ†æ•£é…ç½®ã•ã‚ŒãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä¸€ã¤ã‚’ã‚·ãƒ£ãƒ¼ãƒ‰ï¼ˆShardï¼‰ã¨è¨€ã†ã€‚  \n  \n  \nè¤‡æ•°ãƒãƒ¼ãƒ‰ã§ã‚¤ãƒ³ãƒ‡ã‚¯ã‚·ãƒ³ã‚°ã‚’ä¸¦åˆ—å‡¦ç†ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€å˜ä½æ™‚é–“ã‚ãŸã‚Šã®ã‚¤ãƒ³ãƒ‡ã‚¯ã‚·ãƒ³ã‚°ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ï¼ˆã‚¤ãƒ³ãƒ‡ã‚¯ã‚·ãƒ³ã‚°ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã¯ Documents Per Second :  DPSã¨ã„ã†ã€‚ï¼‰  \n  \n  \n### åˆ†æ•£æ¤œç´¢  \n  \n  \nåˆ†æ•£ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ãŸSolrã§ã¯æ¤œç´¢ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®éš›ã«ã™ã¹ã¦ã®ã‚·ãƒ£ãƒ¼ãƒ‰ã«åŒã˜æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’ç™ºè¡Œã—ã€ã™ã¹ã¦ã®ã‚·ãƒ£ãƒ¼ãƒ‰ã®æ¤œç´¢çµæœã‚’ãƒãƒ¼ã‚¸ã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸æ¤œç´¢çµæœã¨ã—ã¦è¿”å´ã™ã‚‹åˆ†æ•£æ¤œç´¢ãŒå¯èƒ½ã€‚  \n  \n  \nè¤‡æ•°ã®ãƒãƒ¼ãƒ‰ã§å°ã•ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä¸¦åˆ—ã«æ¤œç´¢ã™ã‚‹ãŸã‚ã€å¤§è¦æ¨¡ã®å¤§ããªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä¸€ã¤ã‚’æ¤œç´¢ã™ã‚‹å ´åˆã«æ¯”ã¹ã¦å‡¦ç†æ™‚é–“ãŒçŸ­ããªã‚‹ã€‚ï¼ˆå˜ä¸€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ã‚‰ã®æ¤œç´¢ã«å¯¾ã—ã¦ã€åˆ†æ•£æ¤œç´¢ã§ã¯ãƒãƒ¼ã‚¸å‡¦ç†ã¯åˆ¥é€”å¿…è¦ã«ãªã‚‹ãŒã€å¤§ããªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å¯¾ã™ã‚‹æ¤œç´¢ã‚³ã‚¹ãƒˆã«æ¯”ã¹ã‚‹ã¨ãƒãƒ¼ã‚¸å‡¦ç†ã¯è»½ã„å‡¦ç†ï¼‰  \n  \n  \n### ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³  \n  \n  \nSolrã§ã¯å¤§é‡ã®æ¤œç´¢ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚„ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢éšœå®³ãªã©ã«ã‚ˆã‚Šãƒãƒ¼ãƒ‰ãŒãƒ€ã‚¦ãƒ³ã—ãŸå ´åˆã«å‚™ãˆã¦ç”¨æ„ã™ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒ¬ãƒ—ãƒªã‚«ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚  \n  \n  \nãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯è² è·åˆ†æ•£ã¨ã‚¯ãƒ©ã‚¹ã‚¿å…¨ä½“ã®æ¤œç´¢ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆå‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ï¼ˆæ¤œç´¢ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã¯Queries Per Second : QPS ã¨ã„ã†ã€‚ï¼‰  \n  \n  \n## å‚è€ƒæ–‡çŒ®  \n  \n  \n<Bookmark href=\"https://gihyo.jp/book/2017/978-4-7741-8930-7\" />\n  \n  \nâš ï¸æ³¨æ„  \n  \n  \n2024å¹´10æœˆç¾åœ¨ã¯ã§ Apache Solr 9.7.0  ã¾ã§å‡ºã¦ã„ã¾ã™ãŒã€æœ¬æ›¸ã¯2017å¹´5æœˆå‡ºç‰ˆã§ Apache Solar 6.3.0 ã¾ã§ã®æƒ…å ±ã—ã‹å«ã¿ã¾ã›ã‚“ã€‚é©å®œèª­ã¿æ›¿ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  \n  \n","date":"2024-10-15T00:00:00.000Z"},{"slug":"test-style","title":"ãƒ–ãƒ­ã‚°è¡¨ç¤ºãƒ†ã‚¹ãƒˆç”¨","tags":["tech","poem"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \n# H1 heading  \n  \n  \n## H2 heading  \n  \n  \n### H3 heading  \n  \n- list1  \n- list2  \n- list3  \n1. number1  \n2. number2  \n3. number3  \n- ãƒã‚¹ãƒˆ1  \n\t- ãƒã‚¹ãƒˆ2  \n\t\t- ãƒã‚¹ãƒˆ3  \n  \n> this is quote message  \n  \n  \n```text  \nconst a = \"aaa\"  \nconst b = \"bbb\"  \nconst list = [a, b]  \n```  \n  \n  \nã“ã‚Œã¯**å¤ªæ–‡å­—**ã§ã™  \n  \n  \nã“ã‚Œã¯`ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰`ã§ã™  \n  \n  \nã“ã‚Œã¯_ã‚¤ã‚¿ãƒªãƒƒã‚¯_ã§ã™  \n  \n  \nã“ã‚Œã¯<u>ã‚¢ãƒ³ãƒ€ãƒ¼ãƒ©ã‚¤ãƒ³</u>ã§ã™  \n  \n  \nã“ã‚Œã¯<u>å–ã‚Šæ¶ˆã—ç·š</u>ã§ã™  \n  \n- [ ] TODO1  \n- [ ] TODO2  \n- [x] TODO3  \n  \nä»¥ä¸‹ã¯ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯  \n    \n<Bookmark href=\"https://zenn.dev/mizchi/articles/remix-cloudflare-pages-supabase\"/>\n  \nä»¥ä¸‹ã¯ãƒªãƒ³ã‚¯\n  \n[https://zenn.dev/mizchi/articles/remix-cloudflare-pages-supabase](https://zenn.dev/mizchi/articles/remix-cloudflare-pages-supabase)  \n  \n  \nä»¥ä¸‹ã¯divider  \n  \n---  \n  \n> ğŸ’¡ ã“ã‚Œã¯calloutã§ã™  \n  \nTwitter Embedãƒ†ã‚¹ãƒˆ  \n  \n<TweetEmbed url=\"https://twitter.com/elonmusk/status/1834213015857889706\" />\n  \n  \nYouTube Embedãƒ†ã‚¹ãƒˆ  \n  \n<YouTubeEmbed url=\"https://www.youtube.com/watch?v=CmDv7ww6ikU\" />  \n  \næœ¬ãƒ–ãƒ­ã‚°ã®Bookmark  \noepngraph-imageã®ãƒ†ã‚¹ãƒˆã‚‚å«ã‚€  \n  \n  \n<Bookmark href=\"https://sokes-nook.net/blog/next-web-push\" siteUrl=\"https://sokes-nook.net\" />\n\n  \n\nä»¥ä¸‹ã¯pngç”»åƒ\n![alt text](images/test-style/onepiece01_luffy.png)\n\nä»¥ä¸‹ã¯jpgç”»åƒ\n![alt text](images/test-style/onepiece01_luffy.jpg)\n\nä»¥ä¸‹ã¯gifç”»åƒ\n![alt text](images/test-style/dog-7011_256.gif)\n\nä»¥ä¸‹ã¯svgç”»åƒ\n![alt text](images/test-style/SVGã‚¢ã‚¤ã‚³ãƒ³.svg)","date":"2024-08-13T15:00:00.000Z"},{"slug":"udemy-crafting-shell","title":"Pythonã«ã‚ˆã‚‹è‡ªä½œã‚·ã‚§ãƒ«è¬›åº§ã®æ„Ÿæƒ³","tags":["tech","udemy","shell"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \n## ã¯ã˜ã‚ã«  \n  \n  \nä»¥ä¸‹è¬›åº§ã‚’å—è¬›ã—ãŸã®ã§ãã®å‚™å¿˜éŒ²ã®ãƒ¡ãƒ¢çš„ãªè¨˜äº‹ã§ã™ã€‚ã‚ã¾ã‚Šèª­ã‚€ä¾¡å€¤ã¯ãªã„ã¨æ€ã„ã¾ã™  \n  \n  \n[**è‡ªä½œã‚·ã‚§ãƒ«ã§å­¦ã¶Linuxã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°â€•Pythonã§150è¡Œã®ã€Œã‚·ã‚§ãƒ«ã€ã‚’å®Ÿè£…ã—ã¦Linuxã®ã—ãã¿ã‚’å­¦ã¼ã†**](https://www.udemy.com/course/crafting-shell/)  \n  \n  \n> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€Œã‚·ã‚§ãƒ«ã€ã‚’è‡ªä½œã—ãªãŒã‚‰ã€Linux ã®ã—ãã¿ã‚„ OS ã«è¿‘ã„é ˜åŸŸã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’å­¦ã¼ã†ï¼ã€Œã‚·ã‚§ãƒ«ã£ã¦ä½•ï¼Ÿã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã£ã¦ä½•ï¼Ÿæ¨™æº–å…¥å‡ºåŠ›ã£ã¦ä½•ï¼Ÿã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã£ã¦ä½•ï¼Ÿã€ã¨ã„ã£ãŸç–‘å•ã‚’ã‚·ã‚§ãƒ«ã®å®Ÿè£…ãƒ¬ãƒ™ãƒ«ã§è§£æ¶ˆã—ã‚ˆã†ï¼  \n  \n  \n<Bookmark href=\"https://www.udemy.com/course/crafting-shell\" />\n  \n  \n## è¬›åº§ã®æ„Ÿæƒ³  \n  \n  \nå®Ÿéš›ã«ä½œã£ã¦ã¿ã‚‹ã¨ã¨ã¦ã‚‚ç°¡å˜ã«ã‚·ã‚§ãƒ«ãŒå‡ºæ¥ä¸ŠãŒã£ã¦ã³ã£ãã‚Šã—ãŸã€‚  \n  \n  \nã€Œ0, 1, 2ã«ãã‚Œãã‚Œæ¨™æº–å…¥åŠ›ã€æ¨™æº–å‡ºåŠ›ã€æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ãŒãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã¨ã—ã¦å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã€ãã‚‰ã„ã®è¨˜æ†¶ã¯ã‚ã‚Šã¾ã—ãŸãŒã€å®Ÿéš›ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚„ãƒã‚¤ãƒ—ã®ç°¡æ˜“çš„ãªå®Ÿè£…ã‚’ã“ãªã†ã“ã¨ãã®æœ¬è³ªã®ç†è§£ã«è¿«ã‚ŒãŸã®ãŒè‰¯ã‹ã£ãŸã€‚  \n  \n  \nã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’è¡Œã†éš›ã«ç›´æ¥å½¹ã«ç«‹ã¤ã“ã¨ã¯å°‘ãªã„ã¨æ€ã†ãŒã€çŸ¥ã£ã¦ãŠã„ã¦å¾—ã—ã‹ãªã„æƒ…å ±ã°ã‹ã‚Šã ã£ãŸã€‚  \n  \n  \n---  \n  \n  \n**ä»¥ä¸‹ã€è¬›åº§å—è¬›ä¸­ã®ãƒ¡ãƒ¢**  \n  \n  \n## ãã‚‚ãã‚‚ã‚·ã‚§ãƒ«ã¨ã¯  \n  \n  \nã‚·ã‚§ãƒ«ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã—ãŸã‚³ãƒãƒ³ãƒ‰ã‚’èª­ã¿å–ã‚Šã€ãƒ—ãƒ­ã‚¬ãƒ©ãƒ ã‚’å®Ÿè¡Œã™ã‚‹ã€ç‰¹æ®Šãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚  \n  \n  \nã‚ˆã£ã¦ã‚·ã‚§ãƒ«ã®ä¸­å¿ƒçš„ãªå‡¦ç†ã¯ä»¥ä¸‹ã®äºŒã¤ã«åˆ†é¡ã§ãã‚‹  \n  \n- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã‚’èª­ã¿è¾¼ã‚“ã§è§£æã™ã‚‹  \n- æŒ‡å®šã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰ã‚’å®Ÿè¡Œã™ã‚‹  \n  \nã‚«ãƒ¼ãƒãƒ«ã®æ©Ÿèƒ½  \n  \n- ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†  \n\t- OSãŒãƒ—ãƒ­ã‚»ã‚¹ã‚’é †ç•ªã«å‰²ã‚Šå½“ã¦ã¦ã€è¤‡æ•°ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒåŒæ™‚ã«å‹•ã„ã¦ã„ã‚‹ã‹ã®ã‚ˆã†ã«è¦‹ã›ã‚‹ï¼ˆã‚³ã‚¢ãŒä¸€ã¤ãªã‚‰åŒæ™‚ã«1ã¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã—ã‹å‹•ã‹ã›ãªã„ï¼‰  \n\t- initãƒ—ãƒ­ã‚»ã‚¹ â†’ å…¨ã¦ã®ãƒ—ãƒ­ã‚»ã‚¹ã®è¦ªã¨ãªã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã€‚systemd ãŒã‚ˆãinitãƒ—ãƒ­ã‚»ã‚¹ã¨ç”¨ã„ã‚‰ã‚Œã‚‹ï¼ˆdockerã¯ä¸€ç•ªè¦ªãƒ—ãƒ­ã‚»ã‚¹ãŒinitãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ãªã„ã®ã§æ³¨æ„ï¼‰  \n\t- initãƒ—ãƒ­ã‚»ã‚¹ãŒ sshdã‚’èµ·å‹•ã—ã¦ãŠã„ã¦ãã‚Œã‚‹ã®ã§ã€Bashãªã©ã®ã‚·ã‚§ãƒ«ãŒèµ·å‹•ã§ãã‚‹  \n- ãƒ¡ãƒ¢ãƒªç®¡ç†  \n- ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ   \n- etc..  \n  \nâ‡’ ã‚·ã‚§ãƒ«ã¯ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½ãŒã‚ã‚‹ãŒã€ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ–°ã—ãç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã¯ã‚«ãƒ¼ãƒãƒ«ã ã‘ãªã®ã§ã€**ã‚·ã‚§ãƒ«ã¯ãƒ—ãƒ­ã‚»ã‚¹ã®å®Ÿè¡Œã‚’ã‚«ãƒ¼ãƒãƒ«ã«ä¾é ¼ã™ã‚‹ã“ã¨ã«ãªã‚‹ã¨ã„ã†ã“ã¨**ã€‚  \nã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã®å®Ÿè¡Œã‚„ã€ãã®ä»–ã‚«ãƒ¼ãƒãƒ«ã®å‡¦ç†ã‚’å‘¼ã³å‡ºã™å‡¦ç†ã‚’ã€Œ**ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«**ã€ã¨ã„ã†ã€‚  \n  \n  \nPythonã§ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã™ã‚‹å ´åˆã¯ã€`fork`,  `exec` ã¨ã„ã†2ã¤ã®ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã«å¯¾å¿œã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹  \n  \n  \nã‚·ã‚§ãƒ«ã®ã‚³ãƒãƒ³ãƒ‰ã®ç¨®é¡  \n  \n- å†…éƒ¨ã‚³ãƒãƒ³ãƒ‰ â†’ echo, cd, pwdãªã©ã‚·ã‚§ãƒ«å†…éƒ¨ã§å®Ÿè£…ã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã€‚typeã‚³ãƒãƒ³ãƒ‰ã§ãã®ã‚³ãƒãƒ³ãƒ‰ãŒå†…éƒ¨ã‹å¤–éƒ¨ã‹ã‚’åŒºåˆ¥ã§ãã‚‹  \n  \n```typescript  \nvscode âœ /workspaces/udemy-crafting-shell $ type echo  \necho is a shell builtin  \n```  \n  \n- å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ â†’ å®Ÿè¡Œã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«åã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å ´æ‰€ã¯PATHã§æŒ‡å®šã™ã‚‹ï¼ˆãƒ•ã‚©ãƒ«ãƒ€ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆã€ãã®ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹å®Ÿè¡Œå¯èƒ½ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå…¨ã¦å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã¨ãªã‚‹ï¼‰ã€‚ã‚·ã‚§ãƒ«ã¯ã‚³ãƒãƒ³ãƒ‰ãŒå†…éƒ¨ã‚³ãƒãƒ³ãƒ‰ã§ãªã„å ´åˆã€PATHä¸€è¦§ã‹ã‚‰è©²å½“ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒãªã„ã‹ã‚’æ¢ã™ã€‚cat, lsãªã©ã¯å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰  \n  \n```typescript  \nvscode âœ /workspaces/udemy-crafting-shell $ type cat  \ncat is /usr/bin/cat  \n```  \n  \n  \n## linixã‚·ã‚°ãƒŠãƒ«  \n  \n  \nã‚ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰åˆ¥ã®ãƒ—ãƒ­ã‚»ã‚¹ã«é€šä¿¡ã™ã‚‹æ–¹æ³•ã®ä¸€ç¨®ã€‚  \n  \n- SIGINT  \nã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ Ctrl + C ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ãƒ—ãƒ­ã‚»ã‚¹ã«SIGINTãŒé€ä¿¡ã•ã‚Œã‚‹ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æŒ™å‹•ã¨ã—ã¦ã€SIGINTã‚’å—ä¿¡ã™ã‚‹ã¨ãƒ—ãƒ­ã‚»ã‚¹ã®å®Ÿè¡ŒãŒçµ‚äº†ã™ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã‚‹ã€‚  \n- SIGTERM  \n- SIGKILL  \nã‚«ãƒ¼ãƒãƒ«ãŒå¼·åˆ¶çš„ã«ãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã™ã‚‹ã‚·ã‚°ãƒŠãƒ«ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã¯SIGKILLãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’ä½œæˆã§ããªã„ãŸã‚ã€å¿…ãšãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚·ã‚°ãƒŠãƒ«ã€‚  \n**kill ã‚³ãƒãƒ³ãƒ‰ã¯ã“ã®SIGKILLã‚’ãƒ—ãƒ­ã‚»ã‚¹ã«é€ä¿¡ã—ã¦ã„ã‚‹**  \n- etcâ€¦  \n  \nã‚·ã‚°ãƒŠãƒ«ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æŒ™å‹•ã‚’ä¿®æ­£ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚  \n  \n  \n  \n## ã‚·ã‚§ãƒãƒ³(shebang)  \n  \n  \nLinuxãªã©ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè£…ã™ã‚‹éš›ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®1è¡Œç›®ã« `#!<ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã®ãƒ‘ã‚¹>` ã¨æ›¸ã‹ã‚Œã¦ã„ã‚‹éƒ¨åˆ†ã€‚  \n  \n- #!/bin/bash  \n- #!/usr/bin/env python3  \n- â€¦  \n  \n**Linuxã«ãŠã‘ã‚‹ã‚·ã‚§ãƒãƒ³ã®è§£é‡ˆ**  \n  \n  \nãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã‚³ãƒãƒ³ãƒ‰ã¯æœ€çµ‚çš„ã«execveã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã«æ¸¡ã•ã‚Œã‚‹  \n`execve(â€./script.shâ€, [â€./script.shâ€], â€¦.])`   \n  \n  \nã‚·ã‚§ãƒãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨ã€execveã§ã¯ãªãã€ã‚·ã‚§ãƒãƒ³ã«æŒ‡å®šã•ã‚ŒãŸã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã«ã‚³ãƒãƒ³ãƒ‰ãŒæ¸¡ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹  \n`/bin/bash script.sh`   \n  \n  \n## æ¨™æº–å…¥å‡ºåŠ›ã¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã€ãƒ‘ã‚¤ãƒ—  \n  \n  \nãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚„ãƒ‘ã‚¤ãƒ—ã®æ©Ÿèƒ½ã‚’ä½¿ã†ã“ã¨ã§ã€æ¨™æº–å…¥åŠ›ã€æ¨™æº–å‡ºåŠ›ã€æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚  \n  \n  \nãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰è¦‹ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€0, 1, 2, 3, 4 ã¨ã„ã£ãŸæ•°å­—ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã‚‹ï¼ˆãƒ—ãƒ­ã‚»ã‚¹å†…ã§openã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã«æ•°å­—ãŒæ‰•ã„å‡ºã•ã‚Œã‚‹ï¼‰ã“ã®æ•°å­—ã‚’**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿**ã¨ã„ã†ã€‚  \nãƒ—ãƒ­ã‚»ã‚¹ãŒopenã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `ls -l proc/{PID}/fd` ã‚’ã¿ã‚‹ã¨ç¢ºèªã§ãã‚‹ã€‚ `$$` ã«ã¯ç¾åœ¨ã®PIDãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ `ls -l proc/{PID}/fd` ã¨ã™ã‚‹ã¨ç¾åœ¨ã®ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã‚’ç¢ºèªã§ãã‚‹ã€‚  \n  \n  \n**æ¨™æº–å…¥åŠ›ã€æ¨™æº–å‡ºåŠ›ã€æ¨™æº–ã‚¨ãƒ©ãƒ¼ã¯ãã‚Œãã‚Œã€0, 1, 2ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã®ã“ã¨ã€‚**  \n  \n  \n### ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ  \n  \n  \næ¨™æº–å‡ºåŠ›ã®åˆ‡ã‚Šæ›¿ãˆ: `>`  \n  \n  \n```typescript  \n$ pwd > pwd.output  \n```  \n  \n  \næ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã®åˆ‡ã‚Šæ›¿ãˆ `2>`:   \n  \n  \n```typescript  \n$ cat nofile.txt 2> error.output  \n```  \n  \n  \n### ãƒ‘ã‚¤ãƒ—  \n  \n  \nå‰ã®ã‚³ãƒãƒ³ãƒ‰ã®æ¨™æº–å‡ºåŠ›ã‚’ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã®æ¨™æº–å…¥åŠ›ã«å—ã‘æµã™ã“ã¨ãŒã§ãã‚‹  \n  \n  \n```typescript  \ncat /etc/os-release | grep VERSION  \n```  \n  \n  \n### /dev/pts/0 ã¨ã†ã„ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãªã‚“ãªã®ã‹ï¼Ÿ  \n  \n  \nå‰æã¨ã—ã¦ã€ä»¥ä¸‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ç‰¹æ®Šãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹  \n  \n  \n| ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | é…ç½®ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«    |  \n| ------ | ------------ |  \n| /dev   | ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«     |  \n| /proc  | ã‚«ãƒ¼ãƒãƒ«ã‚„ãƒ—ãƒ­ã‚»ã‚¹ã®æƒ…å ± |  \n| /sys   | ã‚«ãƒ¼ãƒãƒ«ã‚„ãƒ‡ãƒã‚¤ã‚¹ã®æƒ…å ± |  \n  \n  \nâ€» ã“ã‚Œã‚‰ã®æƒ…å ±ã¯ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä¸Šã«æ›¸ãè¾¼ã¾ã‚Œã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚OSã®ã‚«ãƒ¼ãƒãƒ«å†…ã®ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¸Šã®æƒ…å ±ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ã‚ˆã†ãªæ‰±ã„ã«ã—ã¦ã„ã‚‹ã ã‘ã€‚**â€Everything is a fileâ€ ã¨ã„ã†Linuxã®å“²å­¦ã®ä¸€ã¤ã€‚Linuxã«ãŠã„ã¦ã€ã€Œãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿æ›¸ãã§ãã‚‹ã‚‚ã®ã€ãã‚‰ã„æŠ½è±¡çš„ãªå­˜åœ¨ã§ã‚ã‚‹ã€‚**  \n  \n  \n## ã‚·ã‚§ãƒ«ã¨ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®é•ã„  \n  \n  \næœ¬æ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«æ¥ç¶šã—ã¦ä½¿ã†ã€ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã¨ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒãã£ã¤ã„ãŸãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®ã“ã¨ã‚’æŒ‡ã—ã¦ã„ãŸï¼ˆã“ã®ç”»é¢ã¯ã„ã¤ã‚‚è¦‹ã¦ã‚‹ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®é»’ã„ç”»é¢ã®ã¿ã¨ã„ã†ã“ã¨ï¼‰ã€‚  \nç¾åœ¨ã§ã¯ã“ã®ç‰©ç†çš„ãªã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ä½¿ã‚ã‚Œã‚‹ã“ã¨ã¯ãªãã€ã‚½ãƒ•ãƒˆã¨ã—ã¦å…¥ã£ã¦ã„ã‚‹ã€Œã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã€ã¨ã„ã†ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã¨å‘¼ã‚“ã§ã„ã‚‹ã¨ã„ã†ã“ã¨ã€‚  \n  \n  \nã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã¯èµ·å‹•ã™ã‚‹ã¨ /dev/pts/0 ã«æ¥ç¶šã•ã‚Œã€ã“ã® /dev/pts/0 ã‚’ä»‹ã—ã¦ã‚·ã‚§ãƒ«ã‚’æ‰±ã£ã¦ã„ã‚‹ã€‚  \n  \n  \nã‚ˆã£ã¦ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã¯å…¥åŠ›è£…ç½®ã§ã€å®Ÿéš›ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã®ã¯ã‚·ã‚§ãƒ«ã¨ã„ã†æ•´ç†ãŒã§ããã†ã€‚  \n  \n  \nã“ã®é•ã„ã‚’æ„è­˜ã™ã‚‹ã¨ã€clearã‚³ãƒãƒ³ãƒ‰ã®åŸç†ã‚’ç†è§£ã§ãã‚‹ã€‚  \n  \n","date":"2024-09-03T15:00:00.000Z"},{"slug":"unified-notion-bookmark","title":"unifiedã‚’ç†è§£ã—ã¦notion-to-mdã®Bookmarkã‚’ASTä¸Šã‹ã‚‰æ‰±ã†","tags":["tech","markdown","unified"],"content":"\n  \n## ã¯ã˜ã‚ã«  \n  \næœ¬ãƒ–ãƒ­ã‚°ã¯2024/09/14ç¾åœ¨ã§ã¯ã€Next.js, contentlayer, markdownã‚’ç”¨ã„ã¦æ§‹ç¯‰ã—ã¦ã„ã¾ã™ã€‚\nè¨˜äº‹ã¯notionã§æ›¸ã„ãŸã‚‚ã®ã‚’notion apiã‚’å®šæœŸå®Ÿè¡Œã§å©ãã“ã¨ã§markdownã¨ã—ã¦å–å¾—ã—ä¿å­˜ã—ã¦ã„ã¾ã™ã€‚  \n  \nnotion apiã‹ã‚‰ãƒšãƒ¼ã‚¸å†…å®¹ã‚’å–å¾—ã—Markdownã«å¤‰æ›ã™ã‚‹å‡¦ç†ã¯ [notion-to-md](https://github.com/souvikinator/notion-to-md) ã‚’ç”¨ã„ã¦è¡Œãªã£ã¦ã„ã¾ã™ã€‚  \n\nã“ã¡ã‚‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ã€notionã®Bookmarkã‚’ä»¥ä¸‹ã®ã‚ˆã†ãªmdã«å¤‰æ›ã—ã¾ã™ã€‚  \n  \n```markdown  \n[bookmark](https://zenn.dev/januswel/articles/e4f979b875298e372070)   \n```  \n\nãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®markdownãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã€ãƒªãƒ³ã‚¯ãƒ†ã‚­ã‚¹ãƒˆãŒâ€bookmarkâ€ã®ãƒªãƒ³ã‚¯ã¨ã—ã¦è§£é‡ˆã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚  \n\nã“ã¡ã‚‰ã®bookmarkã‚’ç‹¬è‡ªã«è§£é‡ˆã—ã¦ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹ unifiedãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œæˆã—ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚  \n\n\n## unifiedã«ã¤ã„ã¦\nmarkdownã‚’è‡ªåˆ†ã®æ€ã£ãŸé€šã‚Šã«æç”»ã—ã‚ˆã†ã¨ã—ãŸå ´åˆã€[unified](https://github.com/unifiedjs/unified)ã¨ã„ã†ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒä¸å¯é¿ã§ã—ãŸã€‚  \n  \nunified ã§ã¯ mdastï¼ˆMarkdown ã® ASTï¼‰ã‚’æ§‹ç¯‰ã—ã€hast ï¼ˆHTML ã® ASTï¼‰ã«å¤‰æ›ã—ã¦ã€htmlã‚’å‡ºåŠ›ã™ã‚‹ã¨ã„ã†æ‰‹é †ã§å‹•ã„ã¦ãŠã‚Šã€ASTã®æ‰±ã„ã‚’æŠŠæ¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚  \n  \nunifiedã®ç†è§£ã«ã¤ã„ã¦ã¯ [@janus_wel](https://x.com/janus_wel)ã•ã‚“ã®zennã«ãŠã‘ã‚‹ä»¥ä¸‹é€£è¼‰ãŒã¨ã¦ã‚‚å‚è€ƒã«ãªã‚Šã¾ã—ãŸã€‚  \n  \n- [**unified ã‚’ä½¿ã†å‰æº–å‚™**](https://zenn.dev/januswel/articles/e4f979b875298e372070)  \n- [**unified ã«ãŠã‘ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¾ã¨ã‚**](https://zenn.dev/januswel/articles/44801708e8c7fdd358e6)  \n- [**unified ã‚’ä½¿ã£ã¦ Markdown ã‚’æ‹¡å¼µã™ã‚‹**](https://zenn.dev/januswel/articles/745787422d425b01e0c1)  \n- [**unified ã‚’ä½¿ã£ã¦ã‚ªãƒ¬ã‚ªãƒ¬ Markdown ã‚’ ReactElement ã«å¤‰æ›ã™ã‚‹**](https://zenn.dev/januswel/articles/c0e663c88b562bfde8ff)  \n  \nã“ã¡ã‚‰ã§è§£èª¬ã•ã‚Œã¦ã„ã‚‹å†…å®¹ã¯å‰æã¨ã—ã¦æœ¬ç·¨ãŒæ§‹æˆã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€å‰ã‚‚ã£ã¦ã®ä¸€èª­ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚  \n  \nã¾ãŸã€qiitaã®ä»¥ä¸‹è¨˜äº‹ã‚‚ã‚ã‹ã‚Šã‚„ã™ã‹ã£ãŸã®ã§ãŠå‹§ã‚ã§ã™ã€‚  \n  \n[**Next.js ã®ãŸã‚ã® Remark / Rehype å…¥é–€**](https://qiita.com/sankentou/items/f8eadb5722f3b39bbbf8)  \n  \n## å®Ÿè£…  \n  \n  \n```typescript  \nimport { unified } from \"unified\";  \nimport remarkParse from \"remark-parse\";  \nimport remark2rehype from \"remark-rehype\";  \nimport rehypeStringify from \"rehype-stringify\";  \nimport { Node, Parent } from \"unist\";  \nimport { VFileCompatible } from \"vfile\";  \nimport { visit } from \"unist-util-visit\";  \nimport { Paragraph } from \"mdast\";  \nimport { Handler } from \"mdast-util-to-hast\";  \n  \nconst testMdString = `  \n# test markdown  \n  \nä»¥ä¸‹ã¯notionã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯    \n  \n[bookmark](https://zenn.dev/mizchi/articles/remix-cloudflare-pages-supabase)    \n    \n`;  \n  \nfunction isObject(target: unknown): target is { [key: string]: unknown } {  \n  return typeof target === \"object\" && target !== null;  \n}  \n  \n// https://github.com/syntax-tree/unist#parent  \nfunction isParent(node: unknown): node is Parent {  \n  return isObject(node) && Array.isArray(node.children);  \n}  \n  \nconst notionBookmarkPlugin = () => {  \n  return (tree: Node, _file: VFileCompatible) => {  \n    visit(  \n      tree,  \n      \"paragraph\",  \n      (node: Paragraph, index: number, parent: Parent | undefined) => {  \n        if (!isParent(parent)) {  \n          return;  \n        }  \n  \n        if (node.children[0].type === \"link\") {  \n          const linkNode = node.children[0];  \n          if (linkNode.children[0].type === \"text\") {  \n            const textNode = linkNode.children[0];  \n            if (textNode.value === \"bookmark\") {  \n              // my-bookmarkã¨ã„ã†æ–°ãŸãªtypeã®nodeã‚’ä½œæˆã™ã‚‹  \n              parent.children[index] = {  \n                type: \"my-bookmark\",  \n                //@ts-ignore  \n                children: [{ type: \"text\", value: linkNode.url }],  \n                data: { linkUrl: linkNode.url },  \n              };  \n            }  \n          }  \n        }  \n      }  \n    );  \n  };  \n};  \n  \n// @ts-ignore  \n// my-bookmark typeã®nodeã‚’htmlã¸å¤‰æ›ã™ã‚‹éš›ã®handler  \nconst myBookmarkHandler: Handler = (state, node, parent) => {  \n  return {  \n    type: \"element\",  \n    tagName: \"a\",  \n    properties: {  \n      className: \"\",  \n      href: node.data.linkUrl,  \n      target: \"_blank\",  \n      rel: \"noreferrer\",  \n    },  \n    children: [  \n      {  \n        type: \"element\",  \n        tagName: \"div\",  \n        properties: {  \n          className: \"\",  \n        },  \n        children: [  \n          {  \n            type: \"element\",  \n            tagName: \"div\",  \n            properties: { className: \"\" },  \n            children: [  \n              {  \n                type: \"text\",  \n                value: \"BookMarkæ™‚ã®å†…å®¹\",  \n              },  \n            ],  \n          },  \n        ],  \n      },  \n    ],  \n  };  \n};  \n  \nconst processor = unified()  \n  .use(remarkParse) // parse: markdown to mdast  \n  .use(notionBookmarkPlugin)  \n  // @ts-ignore  \n  .use(remark2rehype, {  \n    handlers: {  \n      \"my-bookmark\": myBookmarkHandler,  \n    },  \n  }) // mdast to hast  \n  .use(rehypeStringify); // compile: hast to html  \n  \nconst Unified: React.FC = async () => {  \n  const htmlString = processor.processSync(testMdString).toString();  \n  return (  \n    <div className=\"prose\" dangerouslySetInnerHTML={{ __html: htmlString }} />  \n  );  \n};  \n  \nexport default Unified;  \n  \n```  \n  \n  \n## æ„Ÿæƒ³  \n  \n  \næ­£ç›´ã€`[bookmark]` ã§å§‹ã¾ã‚‹mdãƒªãƒ³ã‚¯ã‚’ifæ–‡ã§æ¡ä»¶åˆ†å²ã™ã‚‹ã ã‘ã§è‰¯ã‹ã£ãŸã®ã§ã™ãŒã€unifiedãŒé¢ç™½ãã†ã ã£ãŸã®ã§è©¦ã—ã¦ã¿ãŸæ„Ÿã˜ã§ã™ã€‚å®Ÿå‹™ã ã£ãŸã‚‰ifæ–‡ã§æ›¸ã‘ã£ã¦æ€’ã‚‰ã‚Œãã†ã€‚  \n  \n  \nä»¥ä¸‹å‹•ç”»ã‚’å‚è€ƒã«ã™ã‚‹ã¨ã€asyncã®remarkPluginä½œæˆã‚‚ã§ããã†ï¼Ÿï¼ˆæœªæ¤œè¨¼ï¼‰  \nasyncãŒä½¿ãˆã‚‹ã¨pluginã®è‡ªç”±åº¦ãŒã•ã‚‰ã«ä¸ŠãŒã‚‹ã®ã§æ°—ã«ãªã‚‹æ–¹ã¯ãœã²ã€‚  \n  \n<YouTubeEmbed url=\"https://www.youtube.com/watch?v=NmXw8yMTjys&t=978s&ab_channel=KentC.Dodds\" />\n  \n  \n## ä½™è«‡  \n  \n  \nã»ã¨ã‚“ã©ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®å‡¦ç†ç³»ã§ã‚‚ASTã‚’åˆ©ç”¨ã•ã‚Œã¦ãŠã‚Šã€ASTã«ã¤ã„ã¦ã®ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã‚’ãªãã—ã¦ãŠãã¨ã€è¨€èªã‚’æ·±ãç†è§£ã—ãŸããªã£ãŸã¨ãã‚„è¨€èªãƒ¬ãƒ™ãƒ«ã§ã®ãƒ‡ãƒãƒƒã‚°ã®éš›ã«å½¹ç«‹ã¡ãã†ã ãªãƒ¼ã¨æ„Ÿã˜ã¾ã—ãŸã€‚  \n  \n  \n```text  \nè¨€èªå‡¦ç†ç³»ã¯ã€å¤§ããåˆ†ã‘ã¦ã€æ¬¡ã®ã‚ˆã†ãªéƒ¨åˆ†ã‹ã‚‰ãªã‚‹ã€‚  \n  \n1. å­—å¥è§£æ(lexical analysis): æ–‡å­—åˆ—ã‚’è¨€èªã®è¦ç´ ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ã€tokenï¼‰ã®åˆ—ã«åˆ†è§£ã™ã‚‹ã€‚  \n2. æ§‹æ–‡è§£æ(syntax analysis): tokenåˆ—ã‚’æ„å‘³ã‚’åæ˜ ã—ãŸæ§‹é€ ã«å¤‰æ›ã€‚ã“ ã®æ§‹é€ ã¯ã€ã—ã°ã—ã°ã€æœ¨æ§‹é€ ã§è¡¨ç¾ã•ã‚Œã‚‹ã®ã§ã€æŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆabstract syntax treeï¼‰ã¨å‘¼ã°ã‚Œã‚‹ã€‚ã“ã“ã¾ã§ã®è¨€èªã‚’èªè­˜ã™ã‚‹éƒ¨åˆ†ã‚’è¨€èªã®parserã¨ å‘¼ã¶ã€‚  \n3. æ„å‘³è§£æ(semantics analysis): æ§‹æ–‡æœ¨ã®æ„å‘³ã‚’è§£æã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ—ãƒª ã‚¿ãƒ¼ã§ã¯ã€ã“ã“ã§æ„å‘³ã‚’è§£æã—ã€ãã‚Œã«å¯¾å¿œã—ãŸå‹•ä½œã‚’è¡Œã†ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã§ã¯ã€ ã“ã®æ®µéšã§å†…éƒ¨çš„ãªã‚³ãƒ¼ãƒ‰ã€ä¸­é–“ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã™ã‚‹ã€‚  \n4. æœ€é©åŒ–(code optimization): ä¸­é–“ã‚³ãƒ¼ãƒ‰ã‚’å¤‰å½¢ã—ã¦ã€åŠ¹ç‡ã®ã‚ˆã„ãƒ—ãƒ­ã‚° ãƒ©ãƒ ã«å¤‰æ›ã™ã‚‹ã€‚  \n5. ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ(code generation): å†…éƒ¨ã‚³ãƒ¼ãƒ‰ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã® è¨€èªã«å¤‰æ›ã—ã€å‡ºåŠ›ã™ã‚‹ã€‚ä¾‹ãˆã°ã€ã“ã“ã§ã€ä¸­é–“ã‚³ãƒ¼ãƒ‰ã‚ˆã‚Šã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®è¨ˆç®— æ©Ÿã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã«å¤‰æ›ã™ã‚‹ã€‚  \n```  \n  \n  \nå‚è€ƒ: [https://www.hpcs.cs.tsukuba.ac.jp/~msato/lecture-note/comp-lecture/note1.html](https://www.hpcs.cs.tsukuba.ac.jp/~msato/lecture-note/comp-lecture/note1.html)  \n  \n  \nAST Explorerï¼ˆ[https://astexplorer.net/](https://astexplorer.net/) ï¼‰ã§ã¯ã€ã•ã¾ã–ã¾ãªè¨€èªãŒã©ã®ã‚ˆã†ã«ASTã«ãªã‚‹ã‹ã‚’çœºã‚ã‚‹ã“ã¨ãŒã§ãã¦é¢ç™½ã„ã§ã™ã€‚  \n  \n\nä»¥ä¸‹ã¯markdownã‚’Parser: [remark](https://remark.js.org/) ã§ãƒ‘ãƒ¼ã‚¹ã—ã¦ç”Ÿæˆã•ã‚ŒãŸASTã®ä¾‹ã§ã™ã€‚  \n  \n![alt text](images/unified-notion-bookmark/astexplorer.png)    ","date":"2024-09-14T00:00:00.000Z"},{"slug":"uv-with-vscode","title":"Pythonãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«uvã‚’å°å…¥ with VSCode","tags":["tech","python","uv","VSCode"],"content":"import { Bookmark } from \"../../components/Bookmark\";\n  \nå··ã§è©±é¡Œã®[uv](https://docs.astral.sh/uv/)ã‚’ç”¨ã„ã¦VSCodeã®é–‹ç™ºç’°å¢ƒã‚’æ§‹ç¯‰ã—ãŸè¨˜éŒ²ã§ã™ã€‚  \n  \n  \nuv ã§ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸå¾Œã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿äºˆæ¸¬ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å‚ç…§ãŒå¯èƒ½ãªç’°å¢ƒã‚’ä½œæˆã™ã‚‹ãŸã‚ã®æ‰‹é †ãŒå°‘ãªã‹ã£ãŸã®ã§è¨˜äº‹ã«ã—ã¾ã—ãŸã€‚  \n  \n  \n## uvã¨ã¯  \nRust ã§æ›¸ã‹ã‚ŒãŸéå¸¸ã«é«˜é€Ÿãª Python ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŠã‚ˆã³ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§ã™ã€‚  \n  \n<Bookmark href=\"https://docs.astral.sh/uv/\" />\n  \n  \nå…¬å¼Docä»¥å¤–ã«ã‚‚uvã«ã¤ã„ã¦ã¯è©±é¡Œã«ãªã£ã¦ã„ãŸä»¥ä¸‹ã®è¨˜äº‹ç¾¤ã‚’å‚ç…§ã™ã‚‹ã¨è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚  \n  \n  \n<Bookmark href=\"https://roboin.io/article/2024/02/19/rust-based-python-package-manager-uv/\" />\n  \n  \n<Bookmark href=\"https://gihyo.jp/article/2024/03/monthly-python-2403\" />\n  \n  \n<Bookmark href=\"https://qiita.com/kissy24/items/0c091bb5f12d697131ae\" />\n  \n  \n## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®uvã®å°å…¥  \n\n```shell  \nâ¯ cd path/to/your/project  \nâ¯ uv init  \nInitialized project `your-project-name`  \n// .venvã®ç”Ÿæˆã™ã‚‹ãŸã‚ã€syncã‚’å®Ÿè¡Œã™ã‚‹  \nâ¯ uv sync  \nCreating virtual environment at: .venv  \nâ¯ tree -L 1 -a  \n.  \nâ”œâ”€â”€ .env  \nâ”œâ”€â”€ .gitignore  \nâ”œâ”€â”€ .python-version  \nâ”œâ”€â”€ .venv  \nâ”œâ”€â”€ README.md  \nâ”œâ”€â”€ hello.py  \nâ”œâ”€â”€ pyproject.toml  \nâ””â”€â”€ uv.lock  \n  \n  \n// ä»»æ„ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã™ã‚‹  \nâ¯ uv add apache-airflow  \n```  \n  \n## VSCodeä¸Šã§uvç’°å¢ƒã‚’æŒ‡å®šã™ã‚‹  \n  \n  \nVSCodeã®ç”»é¢ã®å·¦ä¸‹ã«ã‚ã‚‹Pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ã™æ•°å­—ã®éƒ¨åˆ†ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ãƒ¼ã®ãƒ‘ã‚¹ã‚’é¸æŠã€ã‚’é¸æŠã€‚  \n  \n![alt text](images/uv-with-vscode/vscode-py-version.png)    \n  \nuvã«ã‚ˆã£ã¦ä½œæˆã•ã‚‰ãŸpythonãƒã‚¤ãƒŠãƒªã®ãƒ‘ã‚¹ï¼ˆyour/path/to/airflow/.venv/bin/python3ï¼‰ã‚’å…¥åŠ›  \n  \n![alt text](images/uv-with-vscode/interpreter-path.png)  \n  \nä¸Šè¨˜æ“ä½œã‚’å®Ÿæ–½ã™ã‚‹ã¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§uvã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ãŒæœ‰åŠ¹ã«ãªã‚Šã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒé©åˆ‡ã«importã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚  \n  \n  \nç”»åƒã®ã‚ˆã†ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è£œå®Œã‚„command+ã‚¯ãƒªãƒƒã‚¯ã«ã‚ˆã‚‹ã‚½ãƒ¼ã‚¹å‚ç…§æ©Ÿèƒ½ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹ã¨æ€ã„ã¾ã™ã€‚  \n  \n![alt text](images/uv-with-vscode/vscode-code-completion.png)\n\n  \næœ¬æ ¼çš„ã«ã‚„ã‚ŠãŸã„å ´åˆã€ä»¥ä¸‹ã®devcontainerã‚’ç”¨ã„ãŸç’°å¢ƒæ§‹ç¯‰ã‚’ã™ã‚‹ã®ãŒè‰¯ã•ãã†ã€‚  \n  \n    \n<Bookmark href=\"https://zenn.dev/dena/articles/python_env_with_uv\" />\n  \n  \n## ã€ãŠã¾ã‘ ã€‘ruffã‚’å°å…¥ã—ã¦ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹  \n  \n  \nuvã®é–‹ç™ºå…ƒã¨åŒã˜ Astral ç¤¾ãŒé–‹ç™ºã—ã¦ã„ã‚‹ Python ç”¨ã® Formatter, LinterÂ ã§ã‚ã‚‹[ ruff](https://github.com/astral-sh/ruff/tree/main)ã‚’å°å…¥ã—ã¦åˆ©ç”¨ã—ã¦ã¿ã¾ã™ã€‚  \n  \n  \n```shell  \nâ¯ uv add --dev ruff  \n# é…ä¸‹ã«ã‚ã‚‹pythonãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹  \nâ¯ ruff format .  \n```  \n  \n  \nuv addã®éš›ã«`--dev` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã“ã¨ã§development dependency groupã«ä¾å­˜é–¢ä¿‚ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  \n  \n  \nè‡ªåˆ†ã®ç’°å¢ƒã§ã¯ [lefthook](https://github.com/evilmartians/lefthook)ã®pre-commitã®ãƒ•ãƒƒã‚¯ã«ruffã‚’è¿½åŠ ã—ã¦ã‚³ãƒŸãƒƒãƒˆå‰ã«ã‚³ãƒ¼ãƒ‰ã‚’æ•´å½¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«é©ç”¨ã—ã¦ã„ã¾ã™ã€‚  \n  \n","date":"2024-12-26T00:00:00.000Z"}]